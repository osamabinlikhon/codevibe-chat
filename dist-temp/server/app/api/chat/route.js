(()=>{var e={};e.id=744,e.ids=[744],e.modules={2199:e=>{function t(e){return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=2199,e.exports=t},556:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=556,e.exports=t},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6035:(e,t,n)=>{"use strict";let r,a,i,s,o,l,u,c,d,p;n.r(t),n.d(t,{originalPathname:()=>dD,patchFetch:()=>dM,requestAsyncStorage:()=>dO,routeModule:()=>dR,serverHooks:()=>dP,staticGenerationAsyncStorage:()=>dC});var m,h,f,g,y,b,v,w,_,E,T,A,I,x,S,N,k,R,O,C,P,D,M,j,F,V,U,L,$,B,Z,G,W,K,Y,X,J,z,q,H,Q,ee,et,en,er,ea,ei,es,eo,el,eu,ec,ed,ep,em,eh,ef,eg,ey={};n.r(ey),n.d(ey,{POST:()=>dk});var eb=n(3278),ev=n(5002),ew=n(4877),e_="vercel.ai.error",eE=Symbol.for(e_),eT=class e extends Error{constructor({name:e,message:t,cause:n}){super(t),this[m]=!0,this.name=e,this.cause=n}static isInstance(t){return e.hasMarker(t,e_)}static hasMarker(e,t){let n=Symbol.for(t);return null!=e&&"object"==typeof e&&n in e&&"boolean"==typeof e[n]&&!0===e[n]}};m=eE;var eA=eT,eI="AI_APICallError",ex=`vercel.ai.error.${eI}`,eS=Symbol.for(ex),eN=class extends eA{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:a,responseBody:i,cause:s,isRetryable:o=null!=r&&(408===r||409===r||429===r||r>=500),data:l}){super({name:eI,message:e,cause:s}),this[h]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=a,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return eA.hasMarker(e,ex)}};h=eS;var ek="AI_EmptyResponseBodyError",eR=`vercel.ai.error.${ek}`,eO=Symbol.for(eR),eC=class extends eA{constructor({message:e="Empty response body"}={}){super({name:ek,message:e}),this[f]=!0}static isInstance(e){return eA.hasMarker(e,eR)}};function eP(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}f=eO;var eD="AI_InvalidArgumentError",eM=`vercel.ai.error.${eD}`,ej=Symbol.for(eM),eF=class extends eA{constructor({message:e,cause:t,argument:n}){super({name:eD,message:e,cause:t}),this[g]=!0,this.argument=n}static isInstance(e){return eA.hasMarker(e,eM)}};g=ej;var eV="AI_InvalidPromptError",eU=`vercel.ai.error.${eV}`,eL=Symbol.for(eU),e$=class extends eA{constructor({prompt:e,message:t,cause:n}){super({name:eV,message:`Invalid prompt: ${t}`,cause:n}),this[y]=!0,this.prompt=e}static isInstance(e){return eA.hasMarker(e,eU)}};y=eL;var eB="AI_InvalidResponseDataError",eZ=`vercel.ai.error.${eB}`,eG=Symbol.for(eZ),eW=class extends eA{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:eB,message:t}),this[b]=!0,this.data=e}static isInstance(e){return eA.hasMarker(e,eZ)}};b=eG;var eK="AI_JSONParseError",eY=`vercel.ai.error.${eK}`,eX=Symbol.for(eY),eJ=class extends eA{constructor({text:e,cause:t}){super({name:eK,message:`JSON parsing failed: Text: ${e}.
Error message: ${eP(t)}`,cause:t}),this[v]=!0,this.text=e}static isInstance(e){return eA.hasMarker(e,eY)}};v=eX;var ez="AI_LoadAPIKeyError",eq=`vercel.ai.error.${ez}`,eH=Symbol.for(eq),eQ=class extends eA{constructor({message:e}){super({name:ez,message:e}),this[w]=!0}static isInstance(e){return eA.hasMarker(e,eq)}};w=eH,Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var e0="AI_NoSuchModelError",e1=`vercel.ai.error.${e0}`,e2=Symbol.for(e1),e3=class extends eA{constructor({errorName:e=e0,modelId:t,modelType:n,message:r=`No such ${n}: ${t}`}){super({name:e,message:r}),this[_]=!0,this.modelId=t,this.modelType=n}static isInstance(e){return eA.hasMarker(e,e1)}};_=e2;var e9="AI_TooManyEmbeddingValuesForCallError",e4=`vercel.ai.error.${e9}`,e5=Symbol.for(e4),e6=class extends eA{constructor(e){super({name:e9,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[E]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return eA.hasMarker(e,e4)}};E=e5;var e8="AI_TypeValidationError",e7=`vercel.ai.error.${e8}`,te=Symbol.for(e7),tt=class e extends eA{constructor({value:e,cause:t}){super({name:e8,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${eP(t)}`,cause:t}),this[T]=!0,this.value=e}static isInstance(e){return eA.hasMarker(e,e7)}static wrap({value:t,cause:n}){return e.isInstance(n)&&n.value===t?n:new e({value:t,cause:n})}};T=te;var tn="AI_UnsupportedFunctionalityError",tr=`vercel.ai.error.${tn}`,ta=Symbol.for(tr),ti=class extends eA{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:tn,message:t}),this[A]=!0,this.functionality=e}static isInstance(e){return eA.hasMarker(e,tr)}};function ts(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(ts):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&ts(t)))}A=ta;let to=(e,t=21)=>(n=t)=>{let r="",a=0|n;for(;a--;)r+=e[Math.random()*e.length|0];return r};var tl=n(9145);function tu(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}async function tc(e){return null==e?Promise.resolve():new Promise(t=>setTimeout(t,e))}function td(e){let t={};return e.headers.forEach((e,n)=>{t[n]=e}),t}var tp=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{let a=to(n,t);if(null==e)return a;if(n.includes(r))throw new eF({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return t=>`${e}${r}${a(t)}`},tm=tp();function th(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}var tf=Symbol.for("vercel.ai.validator");function tg({value:e,schema:t}){let n="object"==typeof t&&null!==t&&tf in t&&!0===t[tf]&&"validate"in t?t:{[tf]:!0,validate:e=>{let n=t.safeParse(e);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}};try{if(null==n.validate)return{success:!0,value:e};let t=n.validate(e);if(t.success)return t;return{success:!1,error:tt.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:tt.wrap({value:e,cause:t})}}}function ty({text:e,schema:t}){try{let n=tl.parse(e);if(null==t)return{success:!0,value:n,rawValue:n};let r=tg({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(t){return{success:!1,error:eJ.isInstance(t)?t:new eJ({text:e,cause:t})}}}function tb(e){try{return tl.parse(e),!0}catch(e){return!1}}function tv({provider:e,providerOptions:t,schema:n}){if((null==t?void 0:t[e])==null)return;let r=tg({value:t[e],schema:n});if(!r.success)throw new eF({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var tw=()=>globalThis.fetch,t_=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s})=>tT({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s}),tE=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s})=>tT({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:a,abortSignal:i,fetch:s}),tT=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:a,abortSignal:i,fetch:s=tw()})=>{try{let o=await s(e,{method:"POST",headers:Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t)),body:n.content,signal:i}),l=td(o);if(!o.ok){let t;try{t=await a({response:o,url:e,requestBodyValues:n.values})}catch(t){if(th(t)||eN.isInstance(t))throw t;throw new eN({message:"Failed to process error response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw t.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(t){if(t instanceof Error&&(th(t)||eN.isInstance(t)))throw t;throw new eN({message:"Failed to process successful response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(t){if(th(t))throw t;if(t instanceof TypeError&&"fetch failed"===t.message){let r=t.cause;if(null!=r)throw new eN({message:`Cannot connect to API: ${r.message}`,cause:r,url:e,requestBodyValues:n.values,isRetryable:!0})}throw t}},tA=e=>async({response:t})=>{let n=td(t);if(null==t.body)throw new eC({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(function(){let e,t,n,r="",a=[];function i(e,t){if(""===e){s(t);return}if(e.startsWith(":"))return;let n=e.indexOf(":");if(-1===n){o(e,"");return}let r=e.slice(0,n),a=n+1;o(r,a<e.length&&" "===e[a]?e.slice(a+1):e.slice(a))}function s(r){a.length>0&&(r.enqueue({event:e,data:a.join("\n"),id:t,retry:n}),a=[],e=void 0,n=void 0)}function o(r,i){switch(r){case"event":e=i;break;case"data":a.push(i);break;case"id":t=i;break;case"retry":let s=parseInt(i,10);isNaN(s)||(n=s)}}return new TransformStream({transform(e,t){let{lines:n,incompleteLine:a}=function(e,t){let n=[],r=e;for(let e=0;e<t.length;){let a=t[e++];"\n"===a?(n.push(r),r=""):"\r"===a?(n.push(r),r="","\n"===t[e]&&e++):r+=a}return{lines:n,incompleteLine:r}}(r,e);r=a;for(let e=0;e<n.length;e++)i(n[e],t)},flush(e){i(r,e),s(e)}})}()).pipeThrough(new TransformStream({transform({data:t},n){"[DONE]"!==t&&n.enqueue(ty({text:t,schema:e}))}}))}},tI=e=>async({response:t,url:n,requestBodyValues:r})=>{let a=await t.text(),i=ty({text:a,schema:e}),s=td(t);if(!i.success)throw new eN({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:s,responseBody:a,url:n,requestBodyValues:r});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},tx=()=>async({response:e,url:t,requestBodyValues:n})=>{let r=td(e);if(!e.body)throw new eN({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{let t=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(t)}}catch(a){throw new eN({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:a})}},{btoa:tS,atob:tN}=globalThis;function tk(e){let t=tN(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}function tR(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return tS(t)}(function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let n of e)t[n]=n;return t},e.getValidEnumValues=t=>{let n=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),r={};for(let e of n)r[e]=t[e];return e.objectValues(r)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(let n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t})(I||(I={})),(x||(x={})).mergeShapes=(e,t)=>({...e,...t});let tO=I.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),tC=e=>{switch(typeof e){case"undefined":return tO.undefined;case"string":return tO.string;case"number":return Number.isNaN(e)?tO.nan:tO.number;case"boolean":return tO.boolean;case"function":return tO.function;case"bigint":return tO.bigint;case"symbol":return tO.symbol;case"object":if(Array.isArray(e))return tO.array;if(null===e)return tO.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return tO.promise;if("undefined"!=typeof Map&&e instanceof Map)return tO.map;if("undefined"!=typeof Set&&e instanceof Set)return tO.set;if("undefined"!=typeof Date&&e instanceof Date)return tO.date;return tO.object;default:return tO.unknown}},tP=I.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class tD extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(let a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(r);else if("invalid_return_type"===a.code)r(a.returnTypeError);else if("invalid_arguments"===a.code)r(a.argumentsError);else if(0===a.path.length)n._errors.push(t(a));else{let e=n,r=0;for(;r<a.path.length;){let n=a.path[r];r===a.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(a))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof tD))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,I.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},n=[];for(let r of this.issues)if(r.path.length>0){let n=r.path[0];t[n]=t[n]||[],t[n].push(e(r))}else n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}tD.create=e=>new tD(e);let tM=(e,t)=>{let n;switch(e.code){case tP.invalid_type:n=e.received===tO.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case tP.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,I.jsonStringifyReplacer)}`;break;case tP.unrecognized_keys:n=`Unrecognized key(s) in object: ${I.joinValues(e.keys,", ")}`;break;case tP.invalid_union:n="Invalid input";break;case tP.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${I.joinValues(e.options)}`;break;case tP.invalid_enum_value:n=`Invalid enum value. Expected ${I.joinValues(e.options)}, received '${e.received}'`;break;case tP.invalid_arguments:n="Invalid function arguments";break;case tP.invalid_return_type:n="Invalid function return type";break;case tP.invalid_date:n="Invalid date";break;case tP.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:I.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case tP.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case tP.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case tP.custom:n="Invalid input";break;case tP.invalid_intersection_types:n="Intersection results could not be merged";break;case tP.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case tP.not_finite:n="Number must be finite";break;default:n=t.defaultError,I.assertNever(e)}return{message:n}};!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(S||(S={}));let tj=e=>{let{data:t,path:n,errorMaps:r,issueData:a}=e,i=[...n,...a.path||[]],s={...a,path:i};if(void 0!==a.message)return{...a,path:i,message:a.message};let o="";for(let e of r.filter(e=>!!e).slice().reverse())o=e(s,{data:t,defaultError:o}).message;return{...a,path:i,message:o}};function tF(e,t){let n=tj({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,tM,tM==tM?void 0:tM].filter(e=>!!e)});e.common.issues.push(n)}class tV{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let r of t){if("aborted"===r.status)return tU;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let e of t){let t=await e.key,r=await e.value;n.push({key:t,value:r})}return tV.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let r of t){let{key:t,value:a}=r;if("aborted"===t.status||"aborted"===a.status)return tU;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==a.value||r.alwaysSet)&&(n[t.value]=a.value)}return{status:e.value,value:n}}}let tU=Object.freeze({status:"aborted"}),tL=e=>({status:"dirty",value:e}),t$=e=>({status:"valid",value:e}),tB=e=>"aborted"===e.status,tZ=e=>"dirty"===e.status,tG=e=>"valid"===e.status,tW=e=>"undefined"!=typeof Promise&&e instanceof Promise;class tK{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let tY=(e,t)=>{if(tG(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new tD(e.common.issues);return this._error=t,this._error}}};function tX(e){if(!e)return{};let{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:a}:{errorMap:(t,a)=>{let{message:i}=e;return"invalid_enum_value"===t.code?{message:i??a.defaultError}:void 0===a.data?{message:i??r??a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:i??n??a.defaultError}},description:a}}class tJ{get description(){return this._def.description}_getType(e){return tC(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:tC(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new tV,ctx:{common:e.parent.common,data:e.data,parsedType:tC(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(tW(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){let n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tC(e)},r=this._parseSync({data:e,path:n.path,parent:n});return tY(n,r)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tC(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:t});return tG(n)?{value:n.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>tG(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:tC(e)},r=this._parse({data:e,path:n.path,parent:n});return tY(n,await (tW(r)?r:Promise.resolve(r)))}refine(e,t){let n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,r)=>{let a=e(t),i=()=>r.addIssue({code:tP.custom,...n(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then(e=>!!e||(i(),!1)):!!a||(i(),!1)})}refinement(e,t){return this._refinement((n,r)=>!!e(n)||(r.addIssue("function"==typeof t?t(n,r):t),!1))}_refinement(e){return new nC({schema:this,typeName:N.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return nP.create(this,this._def)}nullable(){return nD.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nf.create(this)}promise(){return nO.create(this,this._def)}or(e){return ny.create([this,e],this._def)}and(e){return nw.create(this,e,this._def)}transform(e){return new nC({...tX(this._def),schema:this,typeName:N.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new nM({...tX(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:N.ZodDefault})}brand(){return new nV({typeName:N.ZodBranded,type:this,...tX(this._def)})}catch(e){return new nj({...tX(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:N.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return nU.create(this,e)}readonly(){return nL.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let tz=/^c[^\s-]{8,}$/i,tq=/^[0-9a-z]+$/,tH=/^[0-9A-HJKMNP-TV-Z]{26}$/i,tQ=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,t0=/^[a-z0-9_-]{21}$/i,t1=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,t2=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,t3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,t9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,t4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,t5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,t6=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,t8=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,t7=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ne="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",nt=RegExp(`^${ne}$`);function nn(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}class nr extends tJ{_parse(e){var t,n,a,i;let s;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==tO.string){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.string,received:t.parsedType}),tU}let o=new tV;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(tF(s=this._getOrReturnCtx(e,s),{code:tP.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("max"===l.kind)e.data.length>l.value&&(tF(s=this._getOrReturnCtx(e,s),{code:tP.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("length"===l.kind){let t=e.data.length>l.value,n=e.data.length<l.value;(t||n)&&(s=this._getOrReturnCtx(e,s),t?tF(s,{code:tP.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):n&&tF(s,{code:tP.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),o.dirty())}else if("email"===l.kind)t3.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"email",code:tP.invalid_string,message:l.message}),o.dirty());else if("emoji"===l.kind)r||(r=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),r.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"emoji",code:tP.invalid_string,message:l.message}),o.dirty());else if("uuid"===l.kind)tQ.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"uuid",code:tP.invalid_string,message:l.message}),o.dirty());else if("nanoid"===l.kind)t0.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"nanoid",code:tP.invalid_string,message:l.message}),o.dirty());else if("cuid"===l.kind)tz.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"cuid",code:tP.invalid_string,message:l.message}),o.dirty());else if("cuid2"===l.kind)tq.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"cuid2",code:tP.invalid_string,message:l.message}),o.dirty());else if("ulid"===l.kind)tH.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"ulid",code:tP.invalid_string,message:l.message}),o.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{tF(s=this._getOrReturnCtx(e,s),{validation:"url",code:tP.invalid_string,message:l.message}),o.dirty()}else"regex"===l.kind?(l.regex.lastIndex=0,l.regex.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"regex",code:tP.invalid_string,message:l.message}),o.dirty())):"trim"===l.kind?e.data=e.data.trim():"includes"===l.kind?e.data.includes(l.value,l.position)||(tF(s=this._getOrReturnCtx(e,s),{code:tP.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),o.dirty()):"toLowerCase"===l.kind?e.data=e.data.toLowerCase():"toUpperCase"===l.kind?e.data=e.data.toUpperCase():"startsWith"===l.kind?e.data.startsWith(l.value)||(tF(s=this._getOrReturnCtx(e,s),{code:tP.invalid_string,validation:{startsWith:l.value},message:l.message}),o.dirty()):"endsWith"===l.kind?e.data.endsWith(l.value)||(tF(s=this._getOrReturnCtx(e,s),{code:tP.invalid_string,validation:{endsWith:l.value},message:l.message}),o.dirty()):"datetime"===l.kind?(function(e){let t=`${ne}T${nn(e)}`,n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,RegExp(`^${t}$`)})(l).test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{code:tP.invalid_string,validation:"datetime",message:l.message}),o.dirty()):"date"===l.kind?nt.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{code:tP.invalid_string,validation:"date",message:l.message}),o.dirty()):"time"===l.kind?RegExp(`^${nn(l)}$`).test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{code:tP.invalid_string,validation:"time",message:l.message}),o.dirty()):"duration"===l.kind?t2.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"duration",code:tP.invalid_string,message:l.message}),o.dirty()):"ip"===l.kind?(t=e.data,("v4"===(n=l.version)||!n)&&t9.test(t)||("v6"===n||!n)&&t5.test(t)||(tF(s=this._getOrReturnCtx(e,s),{validation:"ip",code:tP.invalid_string,message:l.message}),o.dirty())):"jwt"===l.kind?!function(e,t){if(!t1.test(e))return!1;try{let[n]=e.split(".");if(!n)return!1;let r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));if("object"!=typeof a||null===a||"typ"in a&&a?.typ!=="JWT"||!a.alg||t&&a.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(tF(s=this._getOrReturnCtx(e,s),{validation:"jwt",code:tP.invalid_string,message:l.message}),o.dirty()):"cidr"===l.kind?(a=e.data,("v4"===(i=l.version)||!i)&&t4.test(a)||("v6"===i||!i)&&t6.test(a)||(tF(s=this._getOrReturnCtx(e,s),{validation:"cidr",code:tP.invalid_string,message:l.message}),o.dirty())):"base64"===l.kind?t8.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"base64",code:tP.invalid_string,message:l.message}),o.dirty()):"base64url"===l.kind?t7.test(e.data)||(tF(s=this._getOrReturnCtx(e,s),{validation:"base64url",code:tP.invalid_string,message:l.message}),o.dirty()):I.assertNever(l);return{status:o.value,value:e.data}}_regex(e,t,n){return this.refinement(t=>e.test(t),{validation:t,code:tP.invalid_string,...S.errToObj(n)})}_addCheck(e){return new nr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...S.errToObj(e)})}url(e){return this._addCheck({kind:"url",...S.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...S.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...S.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...S.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...S.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...S.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...S.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...S.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...S.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...S.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...S.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...S.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...S.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...S.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...S.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...S.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...S.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...S.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...S.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...S.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...S.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...S.errToObj(t)})}nonempty(e){return this.min(1,S.errToObj(e))}trim(){return new nr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new nr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new nr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}nr.create=e=>new nr({checks:[],typeName:N.ZodString,coerce:e?.coerce??!1,...tX(e)});class na extends tJ{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==tO.number){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.number,received:t.parsedType}),tU}let n=new tV;for(let r of this._def.checks)"int"===r.kind?I.isInteger(e.data)||(tF(t=this._getOrReturnCtx(e,t),{code:tP.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty()):"min"===r.kind?(r.inclusive?e.data<r.value:e.data<=r.value)&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):"max"===r.kind?(r.inclusive?e.data>r.value:e.data>=r.value)&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):"multipleOf"===r.kind?0!==function(e,t){let n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r;return Number.parseInt(e.toFixed(a).replace(".",""))%Number.parseInt(t.toFixed(a).replace(".",""))/10**a}(e.data,r.value)&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(tF(t=this._getOrReturnCtx(e,t),{code:tP.not_finite,message:r.message}),n.dirty()):I.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,S.toString(t))}gt(e,t){return this.setLimit("min",e,!1,S.toString(t))}lte(e,t){return this.setLimit("max",e,!0,S.toString(t))}lt(e,t){return this.setLimit("max",e,!1,S.toString(t))}setLimit(e,t,n,r){return new na({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:S.toString(r)}]})}_addCheck(e){return new na({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:S.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:S.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:S.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:S.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:S.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:S.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:S.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:S.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:S.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&I.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}na.create=e=>new na({checks:[],typeName:N.ZodNumber,coerce:e?.coerce||!1,...tX(e)});class ni extends tJ{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==tO.bigint)return this._getInvalidInput(e);let n=new tV;for(let r of this._def.checks)"min"===r.kind?(r.inclusive?e.data<r.value:e.data<=r.value)&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):"max"===r.kind?(r.inclusive?e.data>r.value:e.data>=r.value)&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):I.assertNever(r);return{status:n.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.bigint,received:t.parsedType}),tU}gte(e,t){return this.setLimit("min",e,!0,S.toString(t))}gt(e,t){return this.setLimit("min",e,!1,S.toString(t))}lte(e,t){return this.setLimit("max",e,!0,S.toString(t))}lt(e,t){return this.setLimit("max",e,!1,S.toString(t))}setLimit(e,t,n,r){return new ni({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:S.toString(r)}]})}_addCheck(e){return new ni({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:S.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:S.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:S.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:S.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:S.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}ni.create=e=>new ni({checks:[],typeName:N.ZodBigInt,coerce:e?.coerce??!1,...tX(e)});class ns extends tJ{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==tO.boolean){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.boolean,received:t.parsedType}),tU}return t$(e.data)}}ns.create=e=>new ns({typeName:N.ZodBoolean,coerce:e?.coerce||!1,...tX(e)});class no extends tJ{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==tO.date){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.date,received:t.parsedType}),tU}if(Number.isNaN(e.data.getTime()))return tF(this._getOrReturnCtx(e),{code:tP.invalid_date}),tU;let n=new tV;for(let r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),n.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(tF(t=this._getOrReturnCtx(e,t),{code:tP.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),n.dirty()):I.assertNever(r);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new no({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:S.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:S.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}no.create=e=>new no({checks:[],coerce:e?.coerce||!1,typeName:N.ZodDate,...tX(e)});class nl extends tJ{_parse(e){if(this._getType(e)!==tO.symbol){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.symbol,received:t.parsedType}),tU}return t$(e.data)}}nl.create=e=>new nl({typeName:N.ZodSymbol,...tX(e)});class nu extends tJ{_parse(e){if(this._getType(e)!==tO.undefined){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.undefined,received:t.parsedType}),tU}return t$(e.data)}}nu.create=e=>new nu({typeName:N.ZodUndefined,...tX(e)});class nc extends tJ{_parse(e){if(this._getType(e)!==tO.null){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.null,received:t.parsedType}),tU}return t$(e.data)}}nc.create=e=>new nc({typeName:N.ZodNull,...tX(e)});class nd extends tJ{constructor(){super(...arguments),this._any=!0}_parse(e){return t$(e.data)}}nd.create=e=>new nd({typeName:N.ZodAny,...tX(e)});class np extends tJ{constructor(){super(...arguments),this._unknown=!0}_parse(e){return t$(e.data)}}np.create=e=>new np({typeName:N.ZodUnknown,...tX(e)});class nm extends tJ{_parse(e){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.never,received:t.parsedType}),tU}}nm.create=e=>new nm({typeName:N.ZodNever,...tX(e)});class nh extends tJ{_parse(e){if(this._getType(e)!==tO.undefined){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.void,received:t.parsedType}),tU}return t$(e.data)}}nh.create=e=>new nh({typeName:N.ZodVoid,...tX(e)});class nf extends tJ{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==tO.array)return tF(t,{code:tP.invalid_type,expected:tO.array,received:t.parsedType}),tU;if(null!==r.exactLength){let e=t.data.length>r.exactLength.value,a=t.data.length<r.exactLength.value;(e||a)&&(tF(t,{code:e?tP.too_big:tP.too_small,minimum:a?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(tF(t,{code:tP.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(tF(t,{code:tP.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((e,n)=>r.type._parseAsync(new tK(t,e,t.path,n)))).then(e=>tV.mergeArray(n,e));let a=[...t.data].map((e,n)=>r.type._parseSync(new tK(t,e,t.path,n)));return tV.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new nf({...this._def,minLength:{value:e,message:S.toString(t)}})}max(e,t){return new nf({...this._def,maxLength:{value:e,message:S.toString(t)}})}length(e,t){return new nf({...this._def,exactLength:{value:e,message:S.toString(t)}})}nonempty(e){return this.min(1,e)}}nf.create=(e,t)=>new nf({type:e,minLength:null,maxLength:null,exactLength:null,typeName:N.ZodArray,...tX(t)});class ng extends tJ{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=I.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==tO.object){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.object,received:t.parsedType}),tU}let{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:a}=this._getCached(),i=[];if(!(this._def.catchall instanceof nm&&"strip"===this._def.unknownKeys))for(let e in n.data)a.includes(e)||i.push(e);let s=[];for(let e of a){let t=r[e],a=n.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new tK(n,a,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof nm){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of i)s.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)i.length>0&&(tF(n,{code:tP.unrecognized_keys,keys:i}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of i){let r=n.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new tK(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of s){let n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e}).then(e=>tV.mergeObjectSync(t,e)):tV.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return S.errToObj,new ng({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{let r=this._def.errorMap?.(t,n).message??n.defaultError;return"unrecognized_keys"===t.code?{message:S.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new ng({...this._def,unknownKeys:"strip"})}passthrough(){return new ng({...this._def,unknownKeys:"passthrough"})}extend(e){return new ng({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ng({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:N.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ng({...this._def,catchall:e})}pick(e){let t={};for(let n of I.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new ng({...this._def,shape:()=>t})}omit(e){let t={};for(let n of I.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new ng({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof ng){let n={};for(let r in t.shape){let a=t.shape[r];n[r]=nP.create(e(a))}return new ng({...t._def,shape:()=>n})}return t instanceof nf?new nf({...t._def,type:e(t.element)}):t instanceof nP?nP.create(e(t.unwrap())):t instanceof nD?nD.create(e(t.unwrap())):t instanceof n_?n_.create(t.items.map(t=>e(t))):t}(this)}partial(e){let t={};for(let n of I.objectKeys(this.shape)){let r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new ng({...this._def,shape:()=>t})}required(e){let t={};for(let n of I.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof nP;)e=e._def.innerType;t[n]=e}return new ng({...this._def,shape:()=>t})}keyof(){return nN(I.objectKeys(this.shape))}}ng.create=(e,t)=>new ng({shape:()=>e,unknownKeys:"strip",catchall:nm.create(),typeName:N.ZodObject,...tX(t)}),ng.strictCreate=(e,t)=>new ng({shape:()=>e,unknownKeys:"strict",catchall:nm.create(),typeName:N.ZodObject,...tX(t)}),ng.lazycreate=(e,t)=>new ng({shape:e,unknownKeys:"strip",catchall:nm.create(),typeName:N.ZodObject,...tX(t)});class ny extends tJ{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map(async e=>{let n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;let n=e.map(e=>new tD(e.ctx.common.issues));return tF(t,{code:tP.invalid_union,unionErrors:n}),tU});{let e;let r=[];for(let a of n){let n={...t,common:{...t.common,issues:[]},parent:null},i=a._parseSync({data:t.data,path:t.path,parent:n});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let a=r.map(e=>new tD(e));return tF(t,{code:tP.invalid_union,unionErrors:a}),tU}}get options(){return this._def.options}}ny.create=(e,t)=>new ny({options:e,typeName:N.ZodUnion,...tX(t)});let nb=e=>{if(e instanceof nx)return nb(e.schema);if(e instanceof nC)return nb(e.innerType());if(e instanceof nS)return[e.value];if(e instanceof nk)return e.options;if(e instanceof nR)return I.objectValues(e.enum);if(e instanceof nM)return nb(e._def.innerType);if(e instanceof nu)return[void 0];else if(e instanceof nc)return[null];else if(e instanceof nP)return[void 0,...nb(e.unwrap())];else if(e instanceof nD)return[null,...nb(e.unwrap())];else if(e instanceof nV)return nb(e.unwrap());else if(e instanceof nL)return nb(e.unwrap());else if(e instanceof nj)return nb(e._def.innerType);else return[]};class nv extends tJ{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==tO.object)return tF(t,{code:tP.invalid_type,expected:tO.object,received:t.parsedType}),tU;let n=this.discriminator,r=t.data[n],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(tF(t,{code:tP.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),tU)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let r=new Map;for(let n of t){let t=nb(n.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of t){if(r.has(a))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);r.set(a,n)}}return new nv({typeName:N.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...tX(n)})}}class nw extends tJ{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(tB(e)||tB(r))return tU;let a=function e(t,n){let r=tC(t),a=tC(n);if(t===n)return{valid:!0,data:t};if(r===tO.object&&a===tO.object){let r=I.objectKeys(n),a=I.objectKeys(t).filter(e=>-1!==r.indexOf(e)),i={...t,...n};for(let r of a){let a=e(t[r],n[r]);if(!a.valid)return{valid:!1};i[r]=a.data}return{valid:!0,data:i}}if(r===tO.array&&a===tO.array){if(t.length!==n.length)return{valid:!1};let r=[];for(let a=0;a<t.length;a++){let i=e(t[a],n[a]);if(!i.valid)return{valid:!1};r.push(i.data)}return{valid:!0,data:r}}return r===tO.date&&a===tO.date&&+t==+n?{valid:!0,data:t}:{valid:!1}}(e.value,r.value);return a.valid?((tZ(e)||tZ(r))&&t.dirty(),{status:t.value,value:a.data}):(tF(n,{code:tP.invalid_intersection_types}),tU)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([e,t])=>r(e,t)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}nw.create=(e,t,n)=>new nw({left:e,right:t,typeName:N.ZodIntersection,...tX(n)});class n_ extends tJ{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==tO.array)return tF(n,{code:tP.invalid_type,expected:tO.array,received:n.parsedType}),tU;if(n.data.length<this._def.items.length)return tF(n,{code:tP.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),tU;!this._def.rest&&n.data.length>this._def.items.length&&(tF(n,{code:tP.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let r=[...n.data].map((e,t)=>{let r=this._def.items[t]||this._def.rest;return r?r._parse(new tK(n,e,n.path,t)):null}).filter(e=>!!e);return n.common.async?Promise.all(r).then(e=>tV.mergeArray(t,e)):tV.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new n_({...this._def,rest:e})}}n_.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new n_({items:e,typeName:N.ZodTuple,rest:null,...tX(t)})};class nE extends tJ{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==tO.object)return tF(n,{code:tP.invalid_type,expected:tO.object,received:n.parsedType}),tU;let r=[],a=this._def.keyType,i=this._def.valueType;for(let e in n.data)r.push({key:a._parse(new tK(n,e,n.path,e)),value:i._parse(new tK(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?tV.mergeObjectAsync(t,r):tV.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new nE(t instanceof tJ?{keyType:e,valueType:t,typeName:N.ZodRecord,...tX(n)}:{keyType:nr.create(),valueType:e,typeName:N.ZodRecord,...tX(t)})}}class nT extends tJ{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==tO.map)return tF(n,{code:tP.invalid_type,expected:tO.map,received:n.parsedType}),tU;let r=this._def.keyType,a=this._def.valueType,i=[...n.data.entries()].map(([e,t],i)=>({key:r._parse(new tK(n,e,n.path,[i,"key"])),value:a._parse(new tK(n,t,n.path,[i,"value"]))}));if(n.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let n of i){let r=await n.key,a=await n.value;if("aborted"===r.status||"aborted"===a.status)return tU;("dirty"===r.status||"dirty"===a.status)&&t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}})}{let e=new Map;for(let n of i){let r=n.key,a=n.value;if("aborted"===r.status||"aborted"===a.status)return tU;("dirty"===r.status||"dirty"===a.status)&&t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}}}}nT.create=(e,t,n)=>new nT({valueType:t,keyType:e,typeName:N.ZodMap,...tX(n)});class nA extends tJ{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==tO.set)return tF(n,{code:tP.invalid_type,expected:tO.set,received:n.parsedType}),tU;let r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(tF(n,{code:tP.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(tF(n,{code:tP.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let a=this._def.valueType;function i(e){let n=new Set;for(let r of e){if("aborted"===r.status)return tU;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}let s=[...n.data.values()].map((e,t)=>a._parse(new tK(n,e,n.path,t)));return n.common.async?Promise.all(s).then(e=>i(e)):i(s)}min(e,t){return new nA({...this._def,minSize:{value:e,message:S.toString(t)}})}max(e,t){return new nA({...this._def,maxSize:{value:e,message:S.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}nA.create=(e,t)=>new nA({valueType:e,minSize:null,maxSize:null,typeName:N.ZodSet,...tX(t)});class nI extends tJ{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==tO.function)return tF(t,{code:tP.invalid_type,expected:tO.function,received:t.parsedType}),tU;function n(e,n){return tj({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,tM,tM].filter(e=>!!e),issueData:{code:tP.invalid_arguments,argumentsError:n}})}function r(e,n){return tj({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,tM,tM].filter(e=>!!e),issueData:{code:tP.invalid_return_type,returnTypeError:n}})}let a={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof nO){let e=this;return t$(async function(...t){let s=new tD([]),o=await e._def.args.parseAsync(t,a).catch(e=>{throw s.addIssue(n(t,e)),s}),l=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(l,a).catch(e=>{throw s.addIssue(r(l,e)),s})})}{let e=this;return t$(function(...t){let s=e._def.args.safeParse(t,a);if(!s.success)throw new tD([n(t,s.error)]);let o=Reflect.apply(i,this,s.data),l=e._def.returns.safeParse(o,a);if(!l.success)throw new tD([r(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new nI({...this._def,args:n_.create(e).rest(np.create())})}returns(e){return new nI({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new nI({args:e||n_.create([]).rest(np.create()),returns:t||np.create(),typeName:N.ZodFunction,...tX(n)})}}class nx extends tJ{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}nx.create=(e,t)=>new nx({getter:e,typeName:N.ZodLazy,...tX(t)});class nS extends tJ{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return tF(t,{received:t.data,code:tP.invalid_literal,expected:this._def.value}),tU}return{status:"valid",value:e.data}}get value(){return this._def.value}}function nN(e,t){return new nk({values:e,typeName:N.ZodEnum,...tX(t)})}nS.create=(e,t)=>new nS({value:e,typeName:N.ZodLiteral,...tX(t)});class nk extends tJ{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),n=this._def.values;return tF(t,{expected:I.joinValues(n),received:t.parsedType,code:tP.invalid_type}),tU}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return tF(t,{received:t.data,code:tP.invalid_enum_value,options:n}),tU}return t$(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return nk.create(e,{...this._def,...t})}exclude(e,t=this._def){return nk.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}nk.create=nN;class nR extends tJ{_parse(e){let t=I.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==tO.string&&n.parsedType!==tO.number){let e=I.objectValues(t);return tF(n,{expected:I.joinValues(e),received:n.parsedType,code:tP.invalid_type}),tU}if(this._cache||(this._cache=new Set(I.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=I.objectValues(t);return tF(n,{received:n.data,code:tP.invalid_enum_value,options:e}),tU}return t$(e.data)}get enum(){return this._def.values}}nR.create=(e,t)=>new nR({values:e,typeName:N.ZodNativeEnum,...tX(t)});class nO extends tJ{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==tO.promise&&!1===t.common.async?(tF(t,{code:tP.invalid_type,expected:tO.promise,received:t.parsedType}),tU):t$((t.parsedType===tO.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}nO.create=(e,t)=>new nO({type:e,typeName:N.ZodPromise,...tX(t)});class nC extends tJ{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===N.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:e=>{tF(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===r.type){let e=r.transform(n.data,a);if(n.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return tU;let r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?tU:"dirty"===r.status||"dirty"===t.value?tL(r.value):r});{if("aborted"===t.value)return tU;let r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?tU:"dirty"===r.status||"dirty"===t.value?tL(r.value):r}}if("refinement"===r.type){let e=e=>{let t=r.refinement(e,a);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(n=>"aborted"===n.status?tU:("dirty"===n.status&&t.dirty(),e(n.value).then(()=>({status:t.value,value:n.value}))));{let r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?tU:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}}if("transform"===r.type){if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(e=>tG(e)?Promise.resolve(r.transform(e.value,a)).then(e=>({status:t.value,value:e})):tU);{let e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!tG(e))return tU;let i=r.transform(e.value,a);if(i instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}}I.assertNever(r)}}nC.create=(e,t,n)=>new nC({schema:e,typeName:N.ZodEffects,effect:t,...tX(n)}),nC.createWithPreprocess=(e,t,n)=>new nC({schema:t,effect:{type:"preprocess",transform:e},typeName:N.ZodEffects,...tX(n)});class nP extends tJ{_parse(e){return this._getType(e)===tO.undefined?t$(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}nP.create=(e,t)=>new nP({innerType:e,typeName:N.ZodOptional,...tX(t)});class nD extends tJ{_parse(e){return this._getType(e)===tO.null?t$(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}nD.create=(e,t)=>new nD({innerType:e,typeName:N.ZodNullable,...tX(t)});class nM extends tJ{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===tO.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}nM.create=(e,t)=>new nM({innerType:e,typeName:N.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...tX(t)});class nj extends tJ{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return tW(r)?r.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new tD(n.common.issues)},input:n.data})})):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new tD(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}nj.create=(e,t)=>new nj({innerType:e,typeName:N.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...tX(t)});class nF extends tJ{_parse(e){if(this._getType(e)!==tO.nan){let t=this._getOrReturnCtx(e);return tF(t,{code:tP.invalid_type,expected:tO.nan,received:t.parsedType}),tU}return{status:"valid",value:e.data}}}nF.create=e=>new nF({typeName:N.ZodNaN,...tX(e)}),Symbol("zod_brand");class nV extends tJ{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class nU extends tJ{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?tU:"dirty"===e.status?(t.dirty(),tL(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})();{let e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?tU:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new nU({in:e,out:t,typeName:N.ZodPipeline})}}class nL extends tJ{_parse(e){let t=this._def.innerType._parse(e),n=e=>(tG(e)&&(e.value=Object.freeze(e.value)),e);return tW(t)?t.then(e=>n(e)):n(t)}unwrap(){return this._def.innerType}}function n$(e,t){let n="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof n?{message:n}:n}function nB(e,t={},n){return e?nd.create().superRefine((r,a)=>{let i=e(r);if(i instanceof Promise)return i.then(e=>{if(!e){let e=n$(t,r),i=e.fatal??n??!0;a.addIssue({code:"custom",...e,fatal:i})}});if(!i){let e=n$(t,r),i=e.fatal??n??!0;a.addIssue({code:"custom",...e,fatal:i})}}):nd.create()}nL.create=(e,t)=>new nL({innerType:e,typeName:N.ZodReadonly,...tX(t)}),ng.lazycreate,function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(N||(N={}));let nZ=(e,t={message:`Input not instance of ${e.name}`})=>nB(t=>t instanceof e,t),nG=nr.create,nW=na.create;nF.create,ni.create;let nK=ns.create;no.create,nl.create,nu.create;let nY=nc.create,nX=nd.create,nJ=np.create;nm.create,nh.create;let nz=nf.create,nq=ng.create;ng.strictCreate;let nH=ny.create,nQ=nv.create;nw.create,n_.create;let n0=nE.create;nT.create,nA.create,nI.create;let n1=nx.create,n2=nS.create,n3=nk.create;nR.create,nO.create,nC.create;let n9=nP.create;function n4(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.content)?void 0:t.map(({token:e,logprob:t,top_logprobs:n})=>({token:e,logprob:t,topLogprobs:n?n.map(({token:e,logprob:t})=>({token:e,logprob:t})):[]})))?n:void 0}function n5(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}nD.create,nC.createWithPreprocess,nU.create;var n6=nq({error:nq({message:nG(),type:nG().nullish(),param:nX().nullish(),code:nH([nG(),nW()]).nullish()})}),n8=(({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:a,requestBodyValues:i})=>{let s=await r.text(),o=td(r);if(""===s.trim())return{responseHeaders:o,value:new eN({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:null==n?void 0:n(r)})};try{let l=function({text:e,schema:t}){try{let n=tl.parse(e);if(null==t)return n;return function({value:e,schema:t}){let n=tg({value:e,schema:t});if(!n.success)throw tt.wrap({value:e,cause:n.error});return n.value}({value:n,schema:t})}catch(t){if(eJ.isInstance(t)||tt.isInstance(t))throw t;throw new eJ({text:e,cause:t})}}({text:s,schema:e});return{responseHeaders:o,value:new eN({message:t(l),url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,data:l,isRetryable:null==n?void 0:n(r,l)})}}catch(e){return{responseHeaders:o,value:new eN({message:r.statusText,url:a,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:s,isRetryable:null==n?void 0:n(r)})}}})({errorSchema:n6,errorToMessage:e=>e.error.message});function n7({id:e,model:t,created:n}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=n?new Date(1e3*n):void 0}}var re=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return null!=(e=this.settings.structuredOutputs)?e:ra(this.modelId)}get defaultObjectGenerationMode(){return this.modelId.startsWith("gpt-4o-audio-preview")?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:a,topK:i,frequencyPenalty:s,presencePenalty:o,stopSequences:l,responseFormat:u,seed:c,providerMetadata:d}){var p,m,h,f,g,y,b,v,w,_,E;let T=e.type,A=[];null!=i&&A.push({type:"unsupported-setting",setting:"topK"}),(null==u?void 0:u.type)!=="json"||null==u.schema||this.supportsStructuredOutputs||A.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let I=this.settings.useLegacyFunctionCalling;if(I&&!0===this.settings.parallelToolCalls)throw new ti({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(I&&this.supportsStructuredOutputs)throw new ti({functionality:"structuredOutputs with useLegacyFunctionCalling"});let{messages:x,warnings:S}=function({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){let r=[],a=[];for(let{role:i,content:s}of e)switch(i){case"system":switch(n){case"system":r.push({role:"system",content:s});break;case"developer":r.push({role:"developer",content:s});break;case"remove":a.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${n}`)}break;case"user":if(1===s.length&&"text"===s[0].type){r.push({role:"user",content:s[0].text});break}r.push({role:"user",content:s.map((e,t)=>{var n,r,a,i;switch(e.type){case"text":return{type:"text",text:e.text};case"image":return{type:"image_url",image_url:{url:e.image instanceof URL?e.image.toString():`data:${null!=(n=e.mimeType)?n:"image/jpeg"};base64,${tR(e.image)}`,detail:null==(a=null==(r=e.providerMetadata)?void 0:r.openai)?void 0:a.imageDetail}};case"file":if(e.data instanceof URL)throw new ti({functionality:"'File content parts with URL data' functionality not supported."});switch(e.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:e.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:e.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:null!=(i=e.filename)?i:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${e.data}`}};default:throw new ti({functionality:`File content part type ${e.mimeType} in user messages`})}}})});break;case"assistant":{let e="",n=[];for(let t of s)switch(t.type){case"text":e+=t.text;break;case"tool-call":n.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.args)}})}if(t){if(n.length>1)throw new ti({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:e,function_call:n.length>0?n[0].function:void 0})}else r.push({role:"assistant",content:e,tool_calls:n.length>0?n:void 0});break}case"tool":for(let e of s)t?r.push({role:"function",name:e.toolName,content:JSON.stringify(e.result)}):r.push({role:"tool",tool_call_id:e.toolCallId,content:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${i}`)}return{messages:r,warnings:a}}({prompt:t,useLegacyFunctionCalling:I,systemMessageMode:ra(w=this.modelId)?null!=(E=null==(_=ri[w])?void 0:_.systemMessageMode)?E:"developer":"system"});A.push(...S);let N={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:!0===this.settings.logprobs||"number"==typeof this.settings.logprobs||void 0,top_logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:a,frequency_penalty:s,presence_penalty:o,response_format:(null==u?void 0:u.type)==="json"?this.supportsStructuredOutputs&&null!=u.schema?{type:"json_schema",json_schema:{schema:u.schema,strict:!0,name:null!=(p=u.name)?p:"response",description:u.description}}:{type:"json_object"}:void 0,stop:l,seed:c,max_completion_tokens:null==(m=null==d?void 0:d.openai)?void 0:m.maxCompletionTokens,store:null==(h=null==d?void 0:d.openai)?void 0:h.store,metadata:null==(f=null==d?void 0:d.openai)?void 0:f.metadata,prediction:null==(g=null==d?void 0:d.openai)?void 0:g.prediction,reasoning_effort:null!=(b=null==(y=null==d?void 0:d.openai)?void 0:y.reasoningEffort)?b:this.settings.reasoningEffort,messages:x};switch(ra(this.modelId)?(null!=N.temperature&&(N.temperature=void 0,A.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=N.top_p&&(N.top_p=void 0,A.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),null!=N.frequency_penalty&&(N.frequency_penalty=void 0,A.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=N.presence_penalty&&(N.presence_penalty=void 0,A.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=N.logit_bias&&(N.logit_bias=void 0,A.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=N.logprobs&&(N.logprobs=void 0,A.push({type:"other",message:"logprobs is not supported for reasoning models"})),null!=N.top_logprobs&&(N.top_logprobs=void 0,A.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=N.max_tokens&&(null==N.max_completion_tokens&&(N.max_completion_tokens=N.max_tokens),N.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&null!=N.temperature&&(N.temperature=void 0,A.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),T){case"regular":{let{tools:t,tool_choice:n,functions:r,function_call:a,toolWarnings:i}=function({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;let a=(null==(r=e.tools)?void 0:r.length)?e.tools:void 0,i=[];if(null==a)return{tools:void 0,tool_choice:void 0,toolWarnings:i};let s=e.toolChoice;if(t){let e=[];for(let t of a)"provider-defined"===t.type?i.push({type:"unsupported-tool",tool:t}):e.push({name:t.name,description:t.description,parameters:t.parameters});if(null==s)return{functions:e,function_call:void 0,toolWarnings:i};switch(s.type){case"auto":case"none":case void 0:return{functions:e,function_call:void 0,toolWarnings:i};case"required":throw new ti({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:e,function_call:{name:s.toolName},toolWarnings:i}}}let o=[];for(let e of a)"provider-defined"===e.type?i.push({type:"unsupported-tool",tool:e}):o.push({type:"function",function:{name:e.name,description:e.description,parameters:e.parameters,strict:!!n||void 0}});if(null==s)return{tools:o,tool_choice:void 0,toolWarnings:i};let l=s.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:s.toolName}},toolWarnings:i};default:throw new ti({functionality:`Unsupported tool choice type: ${l}`})}}({mode:e,useLegacyFunctionCalling:I,structuredOutputs:this.supportsStructuredOutputs});return{args:{...N,tools:t,tool_choice:n,functions:r,function_call:a},warnings:[...A,...i]}}case"object-json":return{args:{...N,response_format:this.supportsStructuredOutputs&&null!=e.schema?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:null!=(v=e.name)?v:"response",description:e.description}}:{type:"json_object"}},warnings:A};case"object-tool":return{args:I?{...N,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...N,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:!!this.supportsStructuredOutputs||void 0}}]},warnings:A};default:throw Error(`Unsupported type: ${T}`)}}async doGenerate(e){var t,n,r,a,i,s,o,l;let{args:u,warnings:c}=this.getArgs(e),{responseHeaders:d,value:p,rawValue:m}=await t_({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:tu(this.config.headers(),e.headers),body:u,failedResponseHandler:n8,successfulResponseHandler:tI(rn),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:h,...f}=u,g=p.choices[0],y=null==(t=p.usage)?void 0:t.completion_tokens_details,b=null==(n=p.usage)?void 0:n.prompt_tokens_details,v={openai:{}};return(null==y?void 0:y.reasoning_tokens)!=null&&(v.openai.reasoningTokens=null==y?void 0:y.reasoning_tokens),(null==y?void 0:y.accepted_prediction_tokens)!=null&&(v.openai.acceptedPredictionTokens=null==y?void 0:y.accepted_prediction_tokens),(null==y?void 0:y.rejected_prediction_tokens)!=null&&(v.openai.rejectedPredictionTokens=null==y?void 0:y.rejected_prediction_tokens),(null==b?void 0:b.cached_tokens)!=null&&(v.openai.cachedPromptTokens=null==b?void 0:b.cached_tokens),{text:null!=(r=g.message.content)?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&g.message.function_call?[{toolCallType:"function",toolCallId:tm(),toolName:g.message.function_call.name,args:g.message.function_call.arguments}]:null==(a=g.message.tool_calls)?void 0:a.map(e=>{var t;return{toolCallType:"function",toolCallId:null!=(t=e.id)?t:tm(),toolName:e.function.name,args:e.function.arguments}}),finishReason:n5(g.finish_reason),usage:{promptTokens:null!=(s=null==(i=p.usage)?void 0:i.prompt_tokens)?s:NaN,completionTokens:null!=(l=null==(o=p.usage)?void 0:o.completion_tokens)?l:NaN},rawCall:{rawPrompt:h,rawSettings:f},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(u)},response:n7(p),warnings:c,logprobs:n4(g.logprobs),providerMetadata:v}}async doStream(e){let t;if(this.settings.simulateStreaming){let t=await this.doGenerate(e);return{stream:new ReadableStream({start(e){if(e.enqueue({type:"response-metadata",...t.response}),t.text&&e.enqueue({type:"text-delta",textDelta:t.text}),t.toolCalls)for(let n of t.toolCalls)e.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:n.toolCallId,toolName:n.toolName,argsTextDelta:n.args}),e.enqueue({type:"tool-call",...n});e.enqueue({type:"finish",finishReason:t.finishReason,usage:t.usage,logprobs:t.logprobs,providerMetadata:t.providerMetadata}),e.close()}}),rawCall:t.rawCall,rawResponse:t.rawResponse,warnings:t.warnings}}let{args:n,warnings:r}=this.getArgs(e),a={...n,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:i,value:s}=await t_({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:tu(this.config.headers(),e.headers),body:a,failedResponseHandler:n8,successfulResponseHandler:tA(rr),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:o,...l}=n,u=[],c="unknown",d={promptTokens:void 0,completionTokens:void 0},p=!0,{useLegacyFunctionCalling:m}=this.settings,h={openai:{}};return{stream:s.pipeThrough(new TransformStream({transform(e,n){var r,a,i,s,o,l,f,g,y,b,v,w;if(!e.success){c="error",n.enqueue({type:"error",error:e.error});return}let _=e.value;if("error"in _){c="error",n.enqueue({type:"error",error:_.error});return}if(p&&(p=!1,n.enqueue({type:"response-metadata",...n7(_)})),null!=_.usage){let{prompt_tokens:e,completion_tokens:t,prompt_tokens_details:n,completion_tokens_details:r}=_.usage;d={promptTokens:null!=e?e:void 0,completionTokens:null!=t?t:void 0},(null==r?void 0:r.reasoning_tokens)!=null&&(h.openai.reasoningTokens=null==r?void 0:r.reasoning_tokens),(null==r?void 0:r.accepted_prediction_tokens)!=null&&(h.openai.acceptedPredictionTokens=null==r?void 0:r.accepted_prediction_tokens),(null==r?void 0:r.rejected_prediction_tokens)!=null&&(h.openai.rejectedPredictionTokens=null==r?void 0:r.rejected_prediction_tokens),(null==n?void 0:n.cached_tokens)!=null&&(h.openai.cachedPromptTokens=null==n?void 0:n.cached_tokens)}let E=_.choices[0];if((null==E?void 0:E.finish_reason)!=null&&(c=n5(E.finish_reason)),(null==E?void 0:E.delta)==null)return;let T=E.delta;null!=T.content&&n.enqueue({type:"text-delta",textDelta:T.content});let A=n4(null==E?void 0:E.logprobs);(null==A?void 0:A.length)&&(void 0===t&&(t=[]),t.push(...A));let I=m&&null!=T.function_call?[{type:"function",id:tm(),function:T.function_call,index:0}]:T.tool_calls;if(null!=I)for(let e of I){let t=e.index;if(null==u[t]){if("function"!==e.type)throw new eW({data:e,message:"Expected 'function' type."});if(null==e.id)throw new eW({data:e,message:"Expected 'id' to be a string."});if((null==(r=e.function)?void 0:r.name)==null)throw new eW({data:e,message:"Expected 'function.name' to be a string."});u[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(a=e.function.arguments)?a:""},hasFinished:!1};let l=u[t];(null==(i=l.function)?void 0:i.name)!=null&&(null==(s=l.function)?void 0:s.arguments)!=null&&(l.function.arguments.length>0&&n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:l.id,toolName:l.function.name,argsTextDelta:l.function.arguments}),tb(l.function.arguments)&&(n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(o=l.id)?o:tm(),toolName:l.function.name,args:l.function.arguments}),l.hasFinished=!0));continue}let c=u[t];!c.hasFinished&&((null==(l=e.function)?void 0:l.arguments)!=null&&(c.function.arguments+=null!=(g=null==(f=e.function)?void 0:f.arguments)?g:""),n.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:c.id,toolName:c.function.name,argsTextDelta:null!=(y=e.function.arguments)?y:""}),(null==(b=c.function)?void 0:b.name)!=null&&(null==(v=c.function)?void 0:v.arguments)!=null&&tb(c.function.arguments)&&(n.enqueue({type:"tool-call",toolCallType:"function",toolCallId:null!=(w=c.id)?w:tm(),toolName:c.function.name,args:c.function.arguments}),c.hasFinished=!0))}},flush(e){var n,r;e.enqueue({type:"finish",finishReason:c,logprobs:t,usage:{promptTokens:null!=(n=d.promptTokens)?n:NaN,completionTokens:null!=(r=d.completionTokens)?r:NaN},...null!=h?{providerMetadata:h}:{}})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},request:{body:JSON.stringify(a)},warnings:r}}},rt=nq({prompt_tokens:nW().nullish(),completion_tokens:nW().nullish(),prompt_tokens_details:nq({cached_tokens:nW().nullish()}).nullish(),completion_tokens_details:nq({reasoning_tokens:nW().nullish(),accepted_prediction_tokens:nW().nullish(),rejected_prediction_tokens:nW().nullish()}).nullish()}).nullish(),rn=nq({id:nG().nullish(),created:nW().nullish(),model:nG().nullish(),choices:nz(nq({message:nq({role:n2("assistant").nullish(),content:nG().nullish(),function_call:nq({arguments:nG(),name:nG()}).nullish(),tool_calls:nz(nq({id:nG().nullish(),type:n2("function"),function:nq({name:nG(),arguments:nG()})})).nullish()}),index:nW(),logprobs:nq({content:nz(nq({token:nG(),logprob:nW(),top_logprobs:nz(nq({token:nG(),logprob:nW()}))})).nullable()}).nullish(),finish_reason:nG().nullish()})),usage:rt}),rr=nH([nq({id:nG().nullish(),created:nW().nullish(),model:nG().nullish(),choices:nz(nq({delta:nq({role:n3(["assistant"]).nullish(),content:nG().nullish(),function_call:nq({name:nG().optional(),arguments:nG().optional()}).nullish(),tool_calls:nz(nq({index:nW(),id:nG().nullish(),type:n2("function").nullish(),function:nq({name:nG().nullish(),arguments:nG().nullish()})})).nullish()}).nullish(),logprobs:nq({content:nz(nq({token:nG(),logprob:nW(),top_logprobs:nz(nq({token:nG(),logprob:nW()}))})).nullable()}).nullish(),finish_reason:nG().nullish(),index:nW()})),usage:rt}),n6]);function ra(e){return e.startsWith("o")||e.startsWith("gpt-5")}var ri={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function rs(e){return null==e?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([e,t])=>({token:e,logprob:t})):[]}))}var ro=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:a,topP:i,topK:s,frequencyPenalty:o,presencePenalty:l,stopSequences:u,responseFormat:c,seed:d}){var p;let m=e.type,h=[];null!=s&&h.push({type:"unsupported-setting",setting:"topK"}),null!=c&&"text"!==c.type&&h.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:f,stopSequences:g}=function({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if("prompt"===t&&1===e.length&&"user"===e[0].role&&1===e[0].content.length&&"text"===e[0].content[0].type)return{prompt:e[0].content[0].text};let a="";for(let{role:t,content:i}of("system"===e[0].role&&(a+=`${e[0].content}

`,e=e.slice(1)),e))switch(t){case"system":throw new e$({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=i.map(e=>{switch(e.type){case"text":return e.text;case"image":throw new ti({functionality:"images"})}}).join("");a+=`${n}:
${e}

`;break}case"assistant":{let e=i.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new ti({functionality:"tool-call messages"})}}).join("");a+=`${r}:
${e}

`;break}case"tool":throw new ti({functionality:"tool messages"});default:throw Error(`Unsupported role: ${t}`)}return{prompt:a+=`${r}:
`,stopSequences:[`
${n}:`]}}({prompt:n,inputFormat:t}),y=[...null!=g?g:[],...null!=u?u:[]],b={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:"number"==typeof this.settings.logprobs?this.settings.logprobs:"boolean"==typeof this.settings.logprobs&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:a,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:f,stop:y.length>0?y:void 0};switch(m){case"regular":if(null==(p=e.tools)?void 0:p.length)throw new ti({functionality:"tools"});if(e.toolChoice)throw new ti({functionality:"toolChoice"});return{args:b,warnings:h};case"object-json":throw new ti({functionality:"object-json mode"});case"object-tool":throw new ti({functionality:"object-tool mode"});default:throw Error(`Unsupported type: ${m}`)}}async doGenerate(e){let{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:a,rawValue:i}=await t_({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:tu(this.config.headers(),e.headers),body:t,failedResponseHandler:n8,successfulResponseHandler:tI(rl),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:s,...o}=t,l=a.choices[0];return{text:l.text,usage:{promptTokens:a.usage.prompt_tokens,completionTokens:a.usage.completion_tokens},finishReason:n5(l.finish_reason),logprobs:rs(l.logprobs),rawCall:{rawPrompt:s,rawSettings:o},rawResponse:{headers:r,body:i},response:n7(a),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){let t;let{args:n,warnings:r}=this.getArgs(e),a={...n,stream:!0,stream_options:"strict"===this.config.compatibility?{include_usage:!0}:void 0},{responseHeaders:i,value:s}=await t_({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:tu(this.config.headers(),e.headers),body:a,failedResponseHandler:n8,successfulResponseHandler:tA(ru),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:o,...l}=n,u="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},d=!0;return{stream:s.pipeThrough(new TransformStream({transform(e,n){if(!e.success){u="error",n.enqueue({type:"error",error:e.error});return}let r=e.value;if("error"in r){u="error",n.enqueue({type:"error",error:r.error});return}d&&(d=!1,n.enqueue({type:"response-metadata",...n7(r)})),null!=r.usage&&(c={promptTokens:r.usage.prompt_tokens,completionTokens:r.usage.completion_tokens});let a=r.choices[0];(null==a?void 0:a.finish_reason)!=null&&(u=n5(a.finish_reason)),(null==a?void 0:a.text)!=null&&n.enqueue({type:"text-delta",textDelta:a.text});let i=rs(null==a?void 0:a.logprobs);(null==i?void 0:i.length)&&(void 0===t&&(t=[]),t.push(...i))},flush(e){e.enqueue({type:"finish",finishReason:u,logprobs:t,usage:c})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:r,request:{body:JSON.stringify(a)}}}},rl=nq({id:nG().nullish(),created:nW().nullish(),model:nG().nullish(),choices:nz(nq({text:nG(),finish_reason:nG(),logprobs:nq({tokens:nz(nG()),token_logprobs:nz(nW()),top_logprobs:nz(n0(nG(),nW())).nullable()}).nullish()})),usage:nq({prompt_tokens:nW(),completion_tokens:nW()})}),ru=nH([nq({id:nG().nullish(),created:nW().nullish(),model:nG().nullish(),choices:nz(nq({text:nG(),finish_reason:nG().nullish(),index:nW(),logprobs:nq({tokens:nz(nG()),token_logprobs:nz(nW()),top_logprobs:nz(n0(nG(),nW())).nullable()}).nullish()})),usage:nq({prompt_tokens:nW(),completion_tokens:nW()}).nullish()}),n6]),rc=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return null!=(e=this.settings.maxEmbeddingsPerCall)?e:2048}get supportsParallelCalls(){var e;return null==(e=this.settings.supportsParallelCalls)||e}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new e6({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let{responseHeaders:r,value:a}=await t_({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:tu(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:n8,successfulResponseHandler:tI(rd),abortSignal:n,fetch:this.config.fetch});return{embeddings:a.data.map(e=>e.embedding),usage:a.usage?{tokens:a.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},rd=nq({data:nz(nq({embedding:nz(nW())})),usage:nq({prompt_tokens:nW()}).nullish()}),rp={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},rm=new Set(["gpt-image-1"]),rh=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return null!=(t=null!=(e=this.settings.maxImagesPerCall)?e:rp[this.modelId])?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:a,providerOptions:i,headers:s,abortSignal:o}){var l,u,c,d;let p=[];null!=r&&p.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=a&&p.push({type:"unsupported-setting",setting:"seed"});let m=null!=(c=null==(u=null==(l=this.config._internal)?void 0:l.currentDate)?void 0:u.call(l))?c:new Date,{value:h,responseHeaders:f}=await t_({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:tu(this.config.headers(),s),body:{model:this.modelId,prompt:e,n:t,size:n,...null!=(d=i.openai)?d:{},...rm.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:n8,successfulResponseHandler:tI(rf),abortSignal:o,fetch:this.config.fetch});return{images:h.data.map(e=>e.b64_json),warnings:p,response:{timestamp:m,modelId:this.modelId,headers:f}}}},rf=nq({data:nz(nq({b64_json:nG()}))}),rg=nq({include:nz(nG()).nullish(),language:nG().nullish(),prompt:nG().nullish(),temperature:nW().min(0).max(1).nullish().default(0),timestampGranularities:nz(n3(["word","segment"])).nullish().default(["segment"])}),ry={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},rb=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,a,i,s,o;let l=tv({provider:"openai",providerOptions:n,schema:rg}),u=new FormData,c=e instanceof Uint8Array?new Blob([e]):new Blob([tk(e)]);if(u.append("model",this.modelId),u.append("file",new File([c],"audio",{type:t})),l){let e={include:null!=(r=l.include)?r:void 0,language:null!=(a=l.language)?a:void 0,prompt:null!=(i=l.prompt)?i:void 0,temperature:null!=(s=l.temperature)?s:void 0,timestamp_granularities:null!=(o=l.timestampGranularities)?o:void 0};for(let t in e){let n=e[t];void 0!==n&&u.append(t,String(n))}}return{formData:u,warnings:[]}}async doGenerate(e){var t,n,r,a,i,s;let o=null!=(r=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?r:new Date,{formData:l,warnings:u}=this.getArgs(e),{value:c,responseHeaders:d,rawValue:p}=await tE({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:tu(this.config.headers(),e.headers),formData:l,failedResponseHandler:n8,successfulResponseHandler:tI(rv),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=null!=c.language&&c.language in ry?ry[c.language]:void 0;return{text:c.text,segments:null!=(i=null==(a=c.words)?void 0:a.map(e=>({text:e.word,startSecond:e.start,endSecond:e.end})))?i:[],language:m,durationInSeconds:null!=(s=c.duration)?s:void 0,warnings:u,response:{timestamp:o,modelId:this.modelId,headers:d,body:p}}}},rv=nq({text:nG(),language:nG().nullish(),duration:nW().nullish(),words:nz(nq({word:nG(),start:nW(),end:nW()})).nullish()});function rw({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}var r_=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:a,topK:i,presencePenalty:s,frequencyPenalty:o,seed:l,prompt:u,providerMetadata:c,responseFormat:d}){var p,m,h,f;let g=[],y=(f=this.modelId).startsWith("o")||f.startsWith("gpt-5")?f.startsWith("o1-mini")||f.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1},b=e.type;null!=i&&g.push({type:"unsupported-setting",setting:"topK"}),null!=l&&g.push({type:"unsupported-setting",setting:"seed"}),null!=s&&g.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=o&&g.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=r&&g.push({type:"unsupported-setting",setting:"stopSequences"});let{messages:v,warnings:w}=function({prompt:e,systemMessageMode:t}){let n=[],r=[];for(let{role:a,content:i}of e)switch(a){case"system":switch(t){case"system":n.push({role:"system",content:i});break;case"developer":n.push({role:"developer",content:i});break;case"remove":r.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${t}`)}break;case"user":n.push({role:"user",content:i.map((e,t)=>{var n,r,a,i;switch(e.type){case"text":return{type:"input_text",text:e.text};case"image":return{type:"input_image",image_url:e.image instanceof URL?e.image.toString():`data:${null!=(n=e.mimeType)?n:"image/jpeg"};base64,${tR(e.image)}`,detail:null==(a=null==(r=e.providerMetadata)?void 0:r.openai)?void 0:a.imageDetail};case"file":if(e.data instanceof URL)throw new ti({functionality:"File URLs in user messages"});if("application/pdf"===e.mimeType)return{type:"input_file",filename:null!=(i=e.filename)?i:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${e.data}`};throw new ti({functionality:"Only PDF files are supported in user messages"})}})});break;case"assistant":for(let e of i)switch(e.type){case"text":n.push({role:"assistant",content:[{type:"output_text",text:e.text}]});break;case"tool-call":n.push({type:"function_call",call_id:e.toolCallId,name:e.toolName,arguments:JSON.stringify(e.args)})}break;case"tool":for(let e of i)n.push({type:"function_call_output",call_id:e.toolCallId,output:JSON.stringify(e.result)});break;default:throw Error(`Unsupported role: ${a}`)}return{messages:n,warnings:r}}({prompt:u,systemMessageMode:y.systemMessageMode});g.push(...w);let _=tv({provider:"openai",providerOptions:c,schema:rA}),E=null==(p=null==_?void 0:_.strictSchemas)||p,T={model:this.modelId,input:v,temperature:n,top_p:a,max_output_tokens:t,...(null==d?void 0:d.type)==="json"&&{text:{format:null!=d.schema?{type:"json_schema",strict:E,name:null!=(m=d.name)?m:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:null==_?void 0:_.metadata,parallel_tool_calls:null==_?void 0:_.parallelToolCalls,previous_response_id:null==_?void 0:_.previousResponseId,store:null==_?void 0:_.store,user:null==_?void 0:_.user,instructions:null==_?void 0:_.instructions,...y.isReasoningModel&&((null==_?void 0:_.reasoningEffort)!=null||(null==_?void 0:_.reasoningSummary)!=null)&&{reasoning:{...(null==_?void 0:_.reasoningEffort)!=null&&{effort:_.reasoningEffort},...(null==_?void 0:_.reasoningSummary)!=null&&{summary:_.reasoningSummary}}},...y.requiredAutoTruncation&&{truncation:"auto"}};switch(y.isReasoningModel&&(null!=T.temperature&&(T.temperature=void 0,g.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=T.top_p&&(T.top_p=void 0,g.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),b){case"regular":{let{tools:t,tool_choice:n,toolWarnings:r}=function({mode:e,strict:t}){var n;let r=(null==(n=e.tools)?void 0:n.length)?e.tools:void 0,a=[];if(null==r)return{tools:void 0,tool_choice:void 0,toolWarnings:a};let i=e.toolChoice,s=[];for(let e of r)switch(e.type){case"function":s.push({type:"function",name:e.name,description:e.description,parameters:e.parameters,strict:!!t||void 0});break;case"provider-defined":"openai.web_search_preview"===e.id?s.push({type:"web_search_preview",search_context_size:e.args.searchContextSize,user_location:e.args.userLocation}):a.push({type:"unsupported-tool",tool:e});break;default:a.push({type:"unsupported-tool",tool:e})}if(null==i)return{tools:s,tool_choice:void 0,toolWarnings:a};let o=i.type;switch(o){case"auto":case"none":case"required":return{tools:s,tool_choice:o,toolWarnings:a};case"tool":if("web_search_preview"===i.toolName)return{tools:s,tool_choice:{type:"web_search_preview"},toolWarnings:a};return{tools:s,tool_choice:{type:"function",name:i.toolName},toolWarnings:a};default:throw new ti({functionality:`Unsupported tool choice type: ${o}`})}}({mode:e,strict:E});return{args:{...T,tools:t,tool_choice:n},warnings:[...g,...r]}}case"object-json":return{args:{...T,text:{format:null!=e.schema?{type:"json_schema",strict:E,name:null!=(h=e.name)?h:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:g};case"object-tool":return{args:{...T,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:E}]},warnings:g};default:throw Error(`Unsupported type: ${b}`)}}async doGenerate(e){var t,n,r,a,i,s,o;let{args:l,warnings:u}=this.getArgs(e),c=this.config.url({path:"/responses",modelId:this.modelId}),{responseHeaders:d,value:p,rawValue:m}=await t_({url:c,headers:tu(this.config.headers(),e.headers),body:l,failedResponseHandler:n8,successfulResponseHandler:tI(nq({id:nG(),created_at:nW(),error:nq({message:nG(),code:nG()}).nullish(),model:nG(),output:nz(nQ("type",[nq({type:n2("message"),role:n2("assistant"),content:nz(nq({type:n2("output_text"),text:nG(),annotations:nz(nq({type:n2("url_citation"),start_index:nW(),end_index:nW(),url:nG(),title:nG()}))}))}),nq({type:n2("function_call"),call_id:nG(),name:nG(),arguments:nG()}),nq({type:n2("web_search_call")}),nq({type:n2("computer_call")}),nq({type:n2("reasoning"),summary:nz(nq({type:n2("summary_text"),text:nG()}))})])),incomplete_details:nq({reason:nG()}).nullable(),usage:rE})),abortSignal:e.abortSignal,fetch:this.config.fetch});if(p.error)throw new eN({message:p.error.message,url:c,requestBodyValues:l,statusCode:400,responseHeaders:d,responseBody:m,isRetryable:!1});let h=p.output.filter(e=>"message"===e.type).flatMap(e=>e.content).filter(e=>"output_text"===e.type),f=p.output.filter(e=>"function_call"===e.type).map(e=>({toolCallType:"function",toolCallId:e.call_id,toolName:e.name,args:e.arguments})),g=null!=(n=null==(t=p.output.find(e=>"reasoning"===e.type))?void 0:t.summary)?n:null;return{text:h.map(e=>e.text).join("\n"),sources:h.flatMap(e=>e.annotations.map(e=>{var t,n,r;return{sourceType:"url",id:null!=(r=null==(n=(t=this.config).generateId)?void 0:n.call(t))?r:tm(),url:e.url,title:e.title}})),finishReason:rw({finishReason:null==(r=p.incomplete_details)?void 0:r.reason,hasToolCalls:f.length>0}),toolCalls:f.length>0?f:void 0,reasoning:g?g.map(e=>({type:"text",text:e.text})):void 0,usage:{promptTokens:p.usage.input_tokens,completionTokens:p.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(l)},response:{id:p.id,timestamp:new Date(1e3*p.created_at),modelId:p.model},providerMetadata:{openai:{responseId:p.id,cachedPromptTokens:null!=(i=null==(a=p.usage.input_tokens_details)?void 0:a.cached_tokens)?i:null,reasoningTokens:null!=(o=null==(s=p.usage.output_tokens_details)?void 0:s.reasoning_tokens)?o:null}},warnings:u}}async doStream(e){let{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:a}=await t_({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:tu(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:n8,successfulResponseHandler:tA(rT),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this,s="unknown",o=NaN,l=NaN,u=null,c=null,d=null,p={},m=!1;return{stream:a.pipeThrough(new TransformStream({transform(e,t){var n,r,a,h,f,g,y,b;if(!e.success){s="error",t.enqueue({type:"error",error:e.error});return}let v=e.value;if("response.output_item.added"===v.type)"function_call"===v.item.type&&(p[v.output_index]={toolName:v.item.name,toolCallId:v.item.call_id},t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:v.item.call_id,toolName:v.item.name,argsTextDelta:v.item.arguments}));else if("response.function_call_arguments.delta"===v.type){let e=p[v.output_index];null!=e&&t.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:e.toolCallId,toolName:e.toolName,argsTextDelta:v.delta})}else"response.created"===v.type?(d=v.response.id,t.enqueue({type:"response-metadata",id:v.response.id,timestamp:new Date(1e3*v.response.created_at),modelId:v.response.model})):"response.output_text.delta"===v.type?t.enqueue({type:"text-delta",textDelta:v.delta}):"response.reasoning_summary_text.delta"===v.type?t.enqueue({type:"reasoning",textDelta:v.delta}):"response.output_item.done"===v.type&&"function_call"===v.item.type?(p[v.output_index]=void 0,m=!0,t.enqueue({type:"tool-call",toolCallType:"function",toolCallId:v.item.call_id,toolName:v.item.name,args:v.item.arguments})):"response.completed"===v.type||"response.incomplete"===v.type?(s=rw({finishReason:null==(n=v.response.incomplete_details)?void 0:n.reason,hasToolCalls:m}),o=v.response.usage.input_tokens,l=v.response.usage.output_tokens,u=null!=(a=null==(r=v.response.usage.input_tokens_details)?void 0:r.cached_tokens)?a:u,c=null!=(f=null==(h=v.response.usage.output_tokens_details)?void 0:h.reasoning_tokens)?f:c):"response.output_text.annotation.added"===v.type?t.enqueue({type:"source",source:{sourceType:"url",id:null!=(b=null==(y=(g=i.config).generateId)?void 0:y.call(g))?b:tm(),url:v.annotation.url,title:v.annotation.title}}):"error"===v.type&&t.enqueue({type:"error",error:v})},flush(e){e.enqueue({type:"finish",finishReason:s,usage:{promptTokens:o,completionTokens:l},...(null!=u||null!=c)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:u,reasoningTokens:c}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},rE=nq({input_tokens:nW(),input_tokens_details:nq({cached_tokens:nW().nullish()}).nullish(),output_tokens:nW(),output_tokens_details:nq({reasoning_tokens:nW().nullish()}).nullish()}),rT=nH([nq({type:n2("response.output_text.delta"),delta:nG()}),nq({type:n3(["response.completed","response.incomplete"]),response:nq({incomplete_details:nq({reason:nG()}).nullish(),usage:rE})}),nq({type:n2("response.created"),response:nq({id:nG(),created_at:nW(),model:nG()})}),nq({type:n2("response.output_item.done"),output_index:nW(),item:nQ("type",[nq({type:n2("message")}),nq({type:n2("function_call"),id:nG(),call_id:nG(),name:nG(),arguments:nG(),status:n2("completed")})])}),nq({type:n2("response.function_call_arguments.delta"),item_id:nG(),output_index:nW(),delta:nG()}),nq({type:n2("response.output_item.added"),output_index:nW(),item:nQ("type",[nq({type:n2("message")}),nq({type:n2("function_call"),id:nG(),call_id:nG(),name:nG(),arguments:nG()})])}),nq({type:n2("response.output_text.annotation.added"),annotation:nq({type:n2("url_citation"),url:nG(),title:nG()})}),nq({type:n2("response.reasoning_summary_text.delta"),item_id:nG(),output_index:nW(),summary_index:nW(),delta:nG()}),nq({type:n2("error"),code:nG(),message:nG(),param:nG().nullish(),sequence_number:nW()}),nq({type:nG()}).passthrough()]),rA=nq({metadata:nX().nullish(),parallelToolCalls:nK().nullish(),previousResponseId:nG().nullish(),store:nK().nullish(),user:nG().nullish(),reasoningEffort:nG().nullish(),strictSchemas:nK().nullish(),instructions:nG().nullish(),reasoningSummary:nG().nullish()}),rI=nq({}),rx={webSearchPreview:function({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:rI}}},rS=nq({instructions:nG().nullish(),speed:nW().min(.25).max(4).default(1).nullish()}),rN=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:a,providerOptions:i}){let s=[],o=tv({provider:"openai",providerOptions:i,schema:rS}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:a};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:s.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){let e={};for(let t in e){let n=e[t];void 0!==n&&(l[t]=n)}}return{requestBody:l,warnings:s}}async doGenerate(e){var t,n,r;let a=null!=(r=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?r:new Date,{requestBody:i,warnings:s}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:u}=await t_({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:tu(this.config.headers(),e.headers),body:i,failedResponseHandler:n8,successfulResponseHandler:tx(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:s,request:{body:JSON.stringify(i)},response:{timestamp:a,modelId:this.modelId,headers:l,body:u}}}};function rk(e={}){var t,n,r,a;let i=null!=(t=null==(a=e.baseURL)?void 0:a.replace(/\/$/,""))?t:"https://api.openai.com/v1",s=null!=(n=e.compatibility)?n:"compatible",o=null!=(r=e.name)?r:"openai",l=()=>({Authorization:`Bearer ${function({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if("string"==typeof e)return e;if(null!=e)throw new eQ({message:`${r} API key must be a string.`});if("undefined"==typeof process)throw new eQ({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(null==(e=process.env[t]))throw new eQ({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new eQ({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),u=(t,n={})=>new re(t,n,{provider:`${o}.chat`,url:({path:e})=>`${i}${e}`,headers:l,compatibility:s,fetch:e.fetch}),c=(t,n={})=>new ro(t,n,{provider:`${o}.completion`,url:({path:e})=>`${i}${e}`,headers:l,compatibility:s,fetch:e.fetch}),d=(t,n={})=>new rc(t,n,{provider:`${o}.embedding`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),p=(t,n={})=>new rh(t,n,{provider:`${o}.image`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),m=t=>new rb(t,{provider:`${o}.transcription`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),h=t=>new rN(t,{provider:`${o}.speech`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),f=(e,t)=>{if(new.target)throw Error("The OpenAI model function cannot be called with the new keyword.");return"gpt-3.5-turbo-instruct"===e?c(e,t):u(e,t)},g=function(e,t){return f(e,t)};return g.languageModel=f,g.chat=u,g.completion=c,g.responses=t=>new r_(t,{provider:`${o}.responses`,url:({path:e})=>`${i}${e}`,headers:l,fetch:e.fetch}),g.embedding=d,g.textEmbedding=d,g.textEmbeddingModel=d,g.image=p,g.imageModel=p,g.transcription=m,g.transcriptionModel=m,g.speech=h,g.speechModel=h,g.tools=rx,g}rk({compatibility:"strict"});var rR=n(6500),rO=n(7028);let rC=Symbol("Let zodToJsonSchema decide on which parser to use"),rP={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},rD=e=>"string"==typeof e?{...rP,name:e}:{...rP,...e},rM=e=>{let t=rD(e),n=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,n])=>[n._def,{def:n._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}},rj=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")};function rF(e){if("openAi"!==e.target)return{};let t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===e.$refStrategy?rj(t,e.currentPath):t.join("/")}}function rV(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function rU(e,t,n,r,a){e[t]=n,rV(e,t,r,a)}function rL(e,t){return r9(e.type._def,t)}let r$=(e,t)=>r9(e.innerType._def,t),rB=(e,t)=>{let n={type:"integer",format:"unix-time"};if("openApi3"===t.target)return n;for(let r of e.checks)switch(r.kind){case"min":rU(n,"minimum",r.value,r.message,t);break;case"max":rU(n,"maximum",r.value,r.message,t)}return n},rZ=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,rG={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===u&&(u=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),u),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function rW(e,t){let n={type:"string"};if(e.checks)for(let r of e.checks)switch(r.kind){case"min":rU(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":rU(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":rX(n,"email",r.message,t);break;case"format:idn-email":rX(n,"idn-email",r.message,t);break;case"pattern:zod":rJ(n,rG.email,r.message,t)}break;case"url":rX(n,"uri",r.message,t);break;case"uuid":rX(n,"uuid",r.message,t);break;case"regex":rJ(n,r.regex,r.message,t);break;case"cuid":rJ(n,rG.cuid,r.message,t);break;case"cuid2":rJ(n,rG.cuid2,r.message,t);break;case"startsWith":rJ(n,RegExp(`^${rK(r.value,t)}`),r.message,t);break;case"endsWith":rJ(n,RegExp(`${rK(r.value,t)}$`),r.message,t);break;case"datetime":rX(n,"date-time",r.message,t);break;case"date":rX(n,"date",r.message,t);break;case"time":rX(n,"time",r.message,t);break;case"duration":rX(n,"duration",r.message,t);break;case"length":rU(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,r.value):r.value,r.message,t),rU(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":rJ(n,RegExp(rK(r.value,t)),r.message,t);break;case"ip":"v6"!==r.version&&rX(n,"ipv4",r.message,t),"v4"!==r.version&&rX(n,"ipv6",r.message,t);break;case"base64url":rJ(n,rG.base64url,r.message,t);break;case"jwt":rJ(n,rG.jwt,r.message,t);break;case"cidr":"v6"!==r.version&&rJ(n,rG.ipv4Cidr,r.message,t),"v4"!==r.version&&rJ(n,rG.ipv6Cidr,r.message,t);break;case"emoji":rJ(n,rG.emoji(),r.message,t);break;case"ulid":rJ(n,rG.ulid,r.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":rX(n,"binary",r.message,t);break;case"contentEncoding:base64":rU(n,"contentEncoding","base64",r.message,t);break;case"pattern:zod":rJ(n,rG.base64,r.message,t)}break;case"nanoid":rJ(n,rG.nanoid,r.message,t)}return n}function rK(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let n=0;n<e.length;n++)rY.has(e[n])||(t+="\\"),t+=e[n];return t}(e):e}let rY=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function rX(e,t,n,r){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):rU(e,"format",t,n,r)}function rJ(e,t,n,r){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:rz(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):rU(e,"pattern",rz(t,r),n,r)}function rz(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;let n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source,a="",i=!1,s=!1,o=!1;for(let e=0;e<r.length;e++){if(i){a+=r[e],i=!1;continue}if(n.i){if(s){if(r[e].match(/[a-z]/)){o?(a+=r[e]+`${r[e-2]}-${r[e]}`.toUpperCase(),o=!1):"-"===r[e+1]&&r[e+2]?.match(/[a-z]/)?(a+=r[e],o=!0):a+=`${r[e]}${r[e].toUpperCase()}`;continue}}else if(r[e].match(/[a-z]/)){a+=`[${r[e]}${r[e].toUpperCase()}]`;continue}}if(n.m){if("^"===r[e]){a+=`(^|(?<=[\r
]))`;continue}if("$"===r[e]){a+=`($|(?=[\r
]))`;continue}}if(n.s&&"."===r[e]){a+=s?`${r[e]}\r
`:`[${r[e]}\r
]`;continue}a+=r[e],"\\"===r[e]?i=!0:s&&"]"===r[e]?s=!1:s||"["!==r[e]||(s=!0)}try{new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return a}function rq(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===N.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((n,r)=>({...n,[r]:r9(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",r]})??rF(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};let n={type:"object",additionalProperties:r9(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if("openApi3"===t.target)return n;if(e.keyType?._def.typeName===N.ZodString&&e.keyType._def.checks?.length){let{type:r,...a}=rW(e.keyType._def,t);return{...n,propertyNames:a}}if(e.keyType?._def.typeName===N.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===N.ZodBranded&&e.keyType._def.type._def.typeName===N.ZodString&&e.keyType._def.type._def.checks?.length){let{type:r,...a}=rL(e.keyType._def,t);return{...n,propertyNames:a}}return n}let rH={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},rQ=(e,t)=>{let n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,n)=>r9(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${n}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return n.length?{anyOf:n}:void 0},r0=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return r9(e.innerType._def,t);let n=r9(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:rF(t)},n]}:rF(t)},r1=(e,t)=>{if("input"===t.pipeStrategy)return r9(e.in._def,t);if("output"===t.pipeStrategy)return r9(e.out._def,t);let n=r9(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=r9(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(e=>void 0!==e)}},r2=(e,t)=>r9(e.innerType._def,t),r3=(e,t,n)=>{switch(t){case N.ZodString:return rW(e,n);case N.ZodNumber:return function(e,t){let n={type:"number"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"int":n.type="integer",rV(n,"type",r.message,t);break;case"min":"jsonSchema7"===t.target?r.inclusive?rU(n,"minimum",r.value,r.message,t):rU(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),rU(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?rU(n,"maximum",r.value,r.message,t):rU(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),rU(n,"maximum",r.value,r.message,t));break;case"multipleOf":rU(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case N.ZodObject:return function(e,t){let n="openAi"===t.target,r={type:"object",properties:{}},a=[],i=e.shape();for(let e in i){let s=i[e];if(void 0===s||void 0===s._def)continue;let o=function(e){try{return e.isOptional()}catch{return!0}}(s);o&&n&&("ZodOptional"===s._def.typeName&&(s=s._def.innerType),s.isNullable()||(s=s.nullable()),o=!1);let l=r9(s._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==l&&(r.properties[e]=l,o||a.push(e))}a.length&&(r.required=a);let s=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return r9(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==s&&(r.additionalProperties=s),r}(e,n);case N.ZodBigInt:return function(e,t){let n={type:"integer",format:"int64"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"min":"jsonSchema7"===t.target?r.inclusive?rU(n,"minimum",r.value,r.message,t):rU(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),rU(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?rU(n,"maximum",r.value,r.message,t):rU(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),rU(n,"maximum",r.value,r.message,t));break;case"multipleOf":rU(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case N.ZodBoolean:return{type:"boolean"};case N.ZodDate:return function e(t,n,r){let a=r??n.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((r,a)=>e(t,n,r))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return rB(t,n)}}(e,n);case N.ZodUndefined:return{not:rF(n)};case N.ZodNull:return"openApi3"===n.target?{enum:["null"],nullable:!0}:{type:"null"};case N.ZodArray:return function(e,t){let n={type:"array"};return e.type?._def&&e.type?._def?.typeName!==N.ZodAny&&(n.items=r9(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&rU(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&rU(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(rU(n,"minItems",e.exactLength.value,e.exactLength.message,t),rU(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}(e,n);case N.ZodUnion:case N.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return rQ(e,t);let n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(e=>e._def.typeName in rH&&(!e._def.checks||!e._def.checks.length))){let e=n.reduce((e,t)=>{let n=rH[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e},[]);return{type:e.length>1?e:e[0]}}if(n.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=n.reduce((e,t)=>{let n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[...e,n];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===n.length){let t=e.filter((e,t,n)=>n.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:n.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(n.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:n.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return rQ(e,t)}(e,n);case N.ZodIntersection:return function(e,t){let n=[r9(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r9(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),r="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,a=[];return n.forEach(e=>{if(rZ(e))a.push(...e.allOf),void 0===e.unevaluatedProperties&&(r=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:n,...r}=e;t=r}else r=void 0;a.push(t)}}),a.length?{allOf:a,...r}:void 0}(e,n);case N.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,n)=>r9(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:r9(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,n)=>r9(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,n);case N.ZodRecord:return rq(e,n);case N.ZodLiteral:return function(e,t){let n=typeof e.value;return"bigint"!==n&&"number"!==n&&"boolean"!==n&&"string"!==n?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===n?"integer":n,enum:[e.value]}:{type:"bigint"===n?"integer":n,const:e.value}}(e,n);case N.ZodEnum:return{type:"string",enum:Array.from(e.values)};case N.ZodNativeEnum:return function(e){let t=e.values,n=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),r=Array.from(new Set(n.map(e=>typeof e)));return{type:1===r.length?"string"===r[0]?"string":"number":["string","number"],enum:n}}(e);case N.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:rH[e.innerType._def.typeName],nullable:!0}:{type:[rH[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let n=r9(e.innerType._def,{...t,currentPath:[...t.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let n=r9(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}(e,n);case N.ZodOptional:return r0(e,n);case N.ZodMap:return function(e,t){return"record"===t.mapStrategy?rq(e,t):{type:"array",maxItems:125,items:{type:"array",items:[r9(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||rF(t),r9(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||rF(t)],minItems:2,maxItems:2}}}(e,n);case N.ZodSet:return function(e,t){let n={type:"array",uniqueItems:!0,items:r9(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&rU(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&rU(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}(e,n);case N.ZodLazy:return()=>e.getter()._def;case N.ZodPromise:return r9(e.type._def,n);case N.ZodNaN:case N.ZodNever:return function(e){return"openAi"===e.target?void 0:{not:rF({...e,currentPath:[...e.currentPath,"not"]})}}(n);case N.ZodEffects:return function(e,t){return"input"===t.effectStrategy?r9(e.schema._def,t):rF(t)}(e,n);case N.ZodAny:case N.ZodUnknown:return rF(n);case N.ZodDefault:return function(e,t){return{...r9(e.innerType._def,t),default:e.defaultValue()}}(e,n);case N.ZodBranded:return rL(e,n);case N.ZodReadonly:return r2(e,n);case N.ZodCatch:return r$(e,n);case N.ZodPipeline:return r1(e,n);case N.ZodFunction:case N.ZodVoid:case N.ZodSymbol:default:return}};function r9(e,t,n=!1){let r=t.seen.get(e);if(t.override){let a=t.override?.(e,t,r,n);if(a!==rC)return a}if(r&&!n){let e=r4(r,t);if(void 0!==e)return e}let a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);let i=r3(e,e.typeName,t),s="function"==typeof i?r9(i(),t):i;if(s&&r5(e,t,s),t.postProcess){let n=t.postProcess(s,e,t);return a.jsonSchema=s,n}return a.jsonSchema=s,s}let r4=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:rj(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,n)=>t.currentPath[n]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),rF(t);return"seen"===t.$refStrategy?rF(t):void 0}},r5=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),r6=(e,t)=>{let n=rM(t),r="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>({...e,[t]:r9(r._def,{...n,currentPath:[...n.basePath,n.definitionPath,t]},!0)??rF(n)}),{}):void 0,a="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,i=r9(e._def,void 0===a?n:{...n,currentPath:[...n.basePath,n.definitionPath,a]},!1)??rF(n),s="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==s&&(i.title=s),n.flags.hasReferencedOpenAiAnyType&&(r||(r={}),r[n.openAiAnyTypeName]||(r[n.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===n.$refStrategy?"1":[...n.basePath,n.definitionPath,n.openAiAnyTypeName].join("/")}}));let o=void 0===a?r?{...i,[n.definitionPath]:r}:i:{$ref:[..."relative"===n.$refStrategy?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...r,[a]:i}};return"jsonSchema7"===n.target?o.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===n.target||"openAi"===n.target)&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===n.target&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var r8={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},r7={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},ae={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},at={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},an={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}};r8.code,r7.code,ae.code,at.code,an.code,r8.name,r8.code,r7.name,r7.code,ae.name,ae.code,at.name,at.code,an.name,an.code,[r8,r7,ae,at,an].map(e=>e.code);var ar=[{code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},{code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},{code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},{code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},{code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},{code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},{code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},{code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},{code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},{code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},{code:"f",name:"start_step",parse:e=>{if(null==e||"object"!=typeof e||!("messageId"in e)||"string"!=typeof e.messageId)throw Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},{code:"g",name:"reasoning",parse:e=>{if("string"!=typeof e)throw Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},{code:"h",name:"source",parse:e=>{if(null==e||"object"!=typeof e)throw Error('"source" parts expect a Source object.');return{type:"source",value:e}}},{code:"i",name:"redacted_reasoning",parse:e=>{if(null==e||"object"!=typeof e||!("data"in e)||"string"!=typeof e.data)throw Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},{code:"j",name:"reasoning_signature",parse:e=>{if(null==e||"object"!=typeof e||!("signature"in e)||"string"!=typeof e.signature)throw Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},{code:"k",name:"file",parse:e=>{if(null==e||"object"!=typeof e||!("data"in e)||"string"!=typeof e.data||!("mimeType"in e)||"string"!=typeof e.mimeType)throw Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}}],aa=Object.fromEntries(ar.map(e=>[e.code,e]));Object.fromEntries(ar.map(e=>[e.name,e.code]));var ai=ar.map(e=>e.code),as=e=>{let t=e.indexOf(":");if(-1===t)throw Error("Failed to parse stream string. No separator found.");let n=e.slice(0,t);if(!ai.includes(n))throw Error(`Failed to parse stream string. Invalid code ${n}.`);let r=JSON.parse(e.slice(t+1));return aa[n].parse(r)};function ao(e,t){let n=ar.find(t=>t.name===e);if(!n)throw Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}var al=Symbol.for("vercel.ai.schema");function au(e){return"object"==typeof e&&null!==e&&al in e&&!0===e[al]&&"jsonSchema"in e&&"validate"in e?e:function(e,{validate:t}={}){return{[al]:!0,_type:void 0,[tf]:!0,jsonSchema:e,validate:t}}(r6(e,{$refStrategy:"none",target:"jsonSchema7"}),{validate:t=>{let n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}})}var ac=Object.defineProperty,ad=(e,t)=>{for(var n in t)ac(e,n,{get:t[n],enumerable:!0})};function ap(e,{contentType:t,dataStreamVersion:n}){let r=new Headers(null!=e?e:{});return r.has("Content-Type")||r.set("Content-Type",t),void 0!==n&&r.set("X-Vercel-AI-Data-Stream",n),r}function am(e,{contentType:t,dataStreamVersion:n}){let r={};if(null!=e)for(let[t,n]of Object.entries(e))r[t]=n;return null==r["Content-Type"]&&(r["Content-Type"]=t),void 0!==n&&(r["X-Vercel-AI-Data-Stream"]=n),r}function ah({response:e,status:t,statusText:n,headers:r,stream:a}){e.writeHead(null!=t?t:200,n,r);let i=a.getReader();(async()=>{try{for(;;){let{done:t,value:n}=await i.read();if(t)break;e.write(n)}}catch(e){throw e}finally{e.end()}})()}var af=class extends eA{constructor(){super({name:"AI_UnsupportedModelVersionError",message:'Unsupported model version. AI SDK 4 only supports models that implement specification version "v1". Please upgrade to AI SDK 5 to use this model.'})}},ag="AI_InvalidArgumentError",ay=`vercel.ai.error.${ag}`,ab=Symbol.for(ay),av=class extends eA{constructor({parameter:e,value:t,message:n}){super({name:ag,message:`Invalid argument for parameter ${e}: ${n}`}),this[k]=!0,this.parameter=e,this.value=t}static isInstance(e){return eA.hasMarker(e,ay)}};k=ab;var aw="AI_RetryError",a_=`vercel.ai.error.${aw}`,aE=Symbol.for(a_),aT=class extends eA{constructor({message:e,reason:t,errors:n}){super({name:aw,message:e}),this[R]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return eA.hasMarker(e,a_)}};R=aE;var aA=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>aI(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function aI(e,{maxRetries:t,delayInMs:n,backoffFactor:r},a=[]){try{return await e()}catch(l){if(th(l)||0===t)throw l;let i=null==l?"unknown error":"string"==typeof l?l:l instanceof Error?l.message:JSON.stringify(l),s=[...a,l],o=s.length;if(o>t)throw new aT({message:`Failed after ${o} attempts. Last error: ${i}`,reason:"maxRetriesExceeded",errors:s});if(l instanceof Error&&eN.isInstance(l)&&!0===l.isRetryable&&o<=t)return await tc(n),aI(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},s);if(1===o)throw l;throw new aT({message:`Failed after ${o} attempts with non-retryable error: '${i}'`,reason:"errorNotRetryable",errors:s})}}function ax({operationId:e,telemetry:t}){return{"operation.name":`${e}${(null==t?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":null==t?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":null==t?void 0:t.functionId}}var aS={startSpan:()=>aN,startActiveSpan:(e,t,n,r)=>"function"==typeof t?t(aN):"function"==typeof n?n(aN):"function"==typeof r?r(aN):void 0},aN={spanContext:()=>ak,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},ak={traceId:"",spanId:"",traceFlags:0};function aR({name:e,tracer:t,attributes:n,fn:r,endWhenDone:a=!0}){return t.startActiveSpan(e,{attributes:n},async e=>{try{let t=await r(e);return a&&e.end(),t}catch(t){try{aO(e,t)}finally{e.end()}throw t}})}function aO(e,t){t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:rO.Q.ERROR,message:t.message})):e.setStatus({code:rO.Q.ERROR})}function aC({telemetry:e,attributes:t}){return(null==e?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((t,[n,r])=>{if(void 0===r)return t;if("object"==typeof r&&"input"in r&&"function"==typeof r.input){if((null==e?void 0:e.recordInputs)===!1)return t;let a=r.input();return void 0===a?t:{...t,[n]:a}}if("object"==typeof r&&"output"in r&&"function"==typeof r.output){if((null==e?void 0:e.recordOutputs)===!1)return t;let a=r.output();return void 0===a?t:{...t,[n]:a}}return{...t,[n]:r}},{})}Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");var aP=class{constructor({data:e,mimeType:t}){let n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return null==this.base64Data&&(this.base64Data=tR(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=tk(this.base64Data)),this.uint8ArrayData}},aD=class extends aP{constructor(e){super(e),this.type="file"}},aM=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],aj=e=>{let t="string"==typeof e?tk(e):e,n=(127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9];return t.slice(n+10)},aF="AI_NoObjectGeneratedError",aV=`vercel.ai.error.${aF}`,aU=Symbol.for(aV),aL=class extends eA{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:a,finishReason:i}){super({name:aF,message:e,cause:t}),this[C]=!0,this.text=n,this.response=r,this.usage=a,this.finishReason=i}static isInstance(e){return eA.hasMarker(e,aV)}};C=aU;var a$="AI_DownloadError",aB=`vercel.ai.error.${a$}`,aZ=Symbol.for(aB),aG=class extends eA{constructor({url:e,statusCode:t,statusText:n,cause:r,message:a=null==r?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:a$,message:a,cause:r}),this[P]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return eA.hasMarker(e,aB)}};async function aW({url:e}){var t;let n=e.toString();try{let e=await fetch(n);if(!e.ok)throw new aG({url:n,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mimeType:null!=(t=e.headers.get("content-type"))?t:void 0}}catch(e){if(aG.isInstance(e))throw e;throw new aG({url:n,cause:e})}}P=aZ;var aK="AI_InvalidDataContentError",aY=`vercel.ai.error.${aK}`,aX=Symbol.for(aY),aJ=class extends eA{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:aK,message:n,cause:t}),this[D]=!0,this.content=e}static isInstance(e){return eA.hasMarker(e,aY)}};D=aX;var az=nH([nG(),nZ(Uint8Array),nZ(ArrayBuffer),nB(e=>{var t,n;return null!=(n=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&n},{message:"Must be a Buffer"})]);function aq(e){return"string"==typeof e?e:e instanceof ArrayBuffer?tR(new Uint8Array(e)):tR(e)}function aH(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)try{return tk(e)}catch(t){throw new aJ({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new aJ({content:e})}var aQ="AI_InvalidMessageRoleError",a0=`vercel.ai.error.${aQ}`,a1=Symbol.for(a0),a2=class extends eA{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:aQ,message:t}),this[M]=!0,this.role=e}static isInstance(e){return eA.hasMarker(e,a0)}};async function a3({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=aW}){let a=await a9(e.messages,r,t,n);return[...null!=e.system?[{role:"system",content:e.system}]:[],...e.messages.map(e=>(function(e,t){var n,r,a,i,s,o;let l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:null!=(n=e.providerOptions)?n:e.experimental_providerMetadata};case"user":if("string"==typeof e.content)return{role:"user",content:[{type:"text",text:e.content}],providerMetadata:null!=(r=e.providerOptions)?r:e.experimental_providerMetadata};return{role:"user",content:e.content.map(e=>(function(e,t){var n,r,a,i;let s,o,l;if("text"===e.type)return{type:"text",text:e.text,providerMetadata:null!=(n=e.providerOptions)?n:e.experimental_providerMetadata};let u=e.mimeType,c=e.type;switch(c){case"image":s=e.image;break;case"file":s=e.data;break;default:throw Error(`Unsupported part type: ${c}`)}try{o="string"==typeof s?new URL(s):s}catch(e){o=s}if(o instanceof URL){if("data:"===o.protocol){let{mimeType:e,base64Content:t}=function(e){try{let[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch(e){return{mimeType:void 0,base64Content:void 0}}}(o.toString());if(null==e||null==t)throw Error(`Invalid data URL format in part ${c}`);u=e,l=aH(t)}else{let e=t[o.toString()];e?(l=e.data,null!=u||(u=e.mimeType)):l=o}}else l=aH(o);switch(c){case"image":return l instanceof Uint8Array&&(u=null!=(r=function({data:e,signatures:t}){let n="string"==typeof e&&e.startsWith("SUQz")||"string"!=typeof e&&e.length>10&&73===e[0]&&68===e[1]&&51===e[2]?aj(e):e;for(let e of t)if("string"==typeof n?n.startsWith(e.base64Prefix):n.length>=e.bytesPrefix.length&&e.bytesPrefix.every((e,t)=>n[t]===e))return e.mimeType}({data:l,signatures:aM}))?r:u),{type:"image",image:l,mimeType:u,providerMetadata:null!=(a=e.providerOptions)?a:e.experimental_providerMetadata};case"file":if(null==u)throw Error("Mime type is missing for file part");return{type:"file",data:l instanceof Uint8Array?aq(l):l,filename:e.filename,mimeType:u,providerMetadata:null!=(i=e.providerOptions)?i:e.experimental_providerMetadata}}})(e,t)).filter(e=>"text"!==e.type||""!==e.text),providerMetadata:null!=(a=e.providerOptions)?a:e.experimental_providerMetadata};case"assistant":if("string"==typeof e.content)return{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:null!=(i=e.providerOptions)?i:e.experimental_providerMetadata};return{role:"assistant",content:e.content.filter(e=>"text"!==e.type||""!==e.text).map(e=>{var t;let n=null!=(t=e.providerOptions)?t:e.experimental_providerMetadata;switch(e.type){case"file":return{type:"file",data:e.data instanceof URL?e.data:aq(e.data),filename:e.filename,mimeType:e.mimeType,providerMetadata:n};case"reasoning":return{type:"reasoning",text:e.text,signature:e.signature,providerMetadata:n};case"redacted-reasoning":return{type:"redacted-reasoning",data:e.data,providerMetadata:n};case"text":return{type:"text",text:e.text,providerMetadata:n};case"tool-call":return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,args:e.args,providerMetadata:n}}}),providerMetadata:null!=(s=e.providerOptions)?s:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(e=>{var t;return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result,content:e.experimental_content,isError:e.isError,providerMetadata:null!=(t=e.providerOptions)?t:e.experimental_providerMetadata}}),providerMetadata:null!=(o=e.providerOptions)?o:e.experimental_providerMetadata};default:throw new a2({role:l})}})(e,a))]}async function a9(e,t,n,r){let a=e.filter(e=>"user"===e.role).map(e=>e.content).filter(e=>Array.isArray(e)).flat().filter(e=>"image"===e.type||"file"===e.type).filter(e=>!("image"===e.type&&!0===n)).map(e=>"image"===e.type?e.image:e.data).map(e=>"string"==typeof e&&(e.startsWith("http:")||e.startsWith("https:"))?new URL(e):e).filter(e=>e instanceof URL).filter(e=>!r(e));return Object.fromEntries((await Promise.all(a.map(async e=>({url:e,data:await t({url:e})})))).map(({url:e,data:t})=>[e.toString(),t]))}function a4(e){var t,n,r;let a=[];for(let i of e){let e;try{e=new URL(i.url)}catch(e){throw Error(`Invalid URL: ${i.url}`)}switch(e.protocol){case"http:":case"https:":if(null==(t=i.contentType)?void 0:t.startsWith("image/"))a.push({type:"image",image:e});else{if(!i.contentType)throw Error("If the attachment is not an image, it must specify a content type");a.push({type:"file",data:e,mimeType:i.contentType})}break;case"data:":{let e,t,s;try{[e,t]=i.url.split(","),s=e.split(";")[0].split(":")[1]}catch(e){throw Error(`Error processing data URL: ${i.url}`)}if(null==s||null==t)throw Error(`Invalid data URL format: ${i.url}`);if(null==(n=i.contentType)?void 0:n.startsWith("image/"))a.push({type:"image",image:aH(t)});else if(null==(r=i.contentType)?void 0:r.startsWith("text/"))a.push({type:"text",text:function(e){try{return new TextDecoder().decode(e)}catch(e){throw Error("Error decoding Uint8Array to text")}}(aH(t))});else{if(!i.contentType)throw Error("If the attachment is not an image or text, it must specify a content type");a.push({type:"file",data:t,mimeType:i.contentType})}break}default:throw Error(`Unsupported URL protocol: ${e.protocol}`)}}return a}M=a1;var a5="AI_MessageConversionError",a6=`vercel.ai.error.${a5}`,a8=Symbol.for(a6),a7=class extends eA{constructor({originalMessage:e,message:t}){super({name:a5,message:t}),this[j]=!0,this.originalMessage=e}static isInstance(e){return eA.hasMarker(e,a6)}};j=a8;var ie=n1(()=>nH([nY(),nG(),nW(),nK(),n0(nG(),ie),nz(ie)])),it=n0(nG(),n0(nG(),ie)),ir=nz(nH([nq({type:n2("text"),text:nG()}),nq({type:n2("image"),data:nG(),mimeType:nG().optional()})])),ia=nq({type:n2("text"),text:nG(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),ii=nq({type:n2("image"),image:nH([az,nZ(URL)]),mimeType:nG().optional(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),is=nq({type:n2("file"),data:nH([az,nZ(URL)]),filename:nG().optional(),mimeType:nG(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),io=nq({type:n2("reasoning"),text:nG(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),il=nq({type:n2("redacted-reasoning"),data:nG(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),iu=nq({type:n2("tool-call"),toolCallId:nG(),toolName:nG(),args:nJ(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),ic=nq({type:n2("tool-result"),toolCallId:nG(),toolName:nG(),result:nJ(),content:ir.optional(),isError:nK().optional(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),id=nq({role:n2("system"),content:nG(),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),ip=nq({role:n2("user"),content:nH([nG(),nz(nH([ia,ii,is]))]),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),im=nq({role:n2("assistant"),content:nH([nG(),nz(nH([ia,is,io,il,iu]))]),providerOptions:it.optional(),experimental_providerMetadata:it.optional()}),ih=nH([id,ip,im,nq({role:n2("tool"),content:nz(ic),providerOptions:it.optional(),experimental_providerMetadata:it.optional()})]);function ig(e){return"object"==typeof e&&null!==e&&("function"===e.role||"data"===e.role||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":"object"==typeof e&&null!==e&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":"object"==typeof e&&null!==e&&"role"in e&&"content"in e&&"string"==typeof e.content&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function iy(e){let t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{let e=t.getReader();return{async next(){let{done:t,value:n}=await e.read();return t?{done:!0,value:void 0}:{done:!1,value:n}}}},t}function ib(e){return"image"===e.type?{...e,image:e.image instanceof Uint8Array?aq(e.image):e.image}:e}tp({prefix:"aiobj",size:24});var iv=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise||(this.promise=new Promise((e,t)=>{"resolved"===this.status.type?e(this.status.value):"rejected"===this.status.type&&t(this.status.error),this._resolve=e,this._reject=t})),this.promise}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&(null==(t=this._resolve)||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&(null==(t=this._reject)||t.call(this,e))}};function iw(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}tp({prefix:"aiobj",size:24});var i_="AI_NoOutputSpecifiedError",iE=`vercel.ai.error.${i_}`,iT=Symbol.for(iE),iA=class extends eA{constructor({message:e="No output specified."}={}){super({name:i_,message:e}),this[F]=!0}static isInstance(e){return eA.hasMarker(e,iE)}};F=iT;var iI="AI_ToolExecutionError",ix=`vercel.ai.error.${iI}`,iS=Symbol.for(ix),iN=class extends eA{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:a=`Error executing tool ${t}: ${eP(r)}`}){super({name:iI,message:a,cause:r}),this[V]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return eA.hasMarker(e,ix)}};V=iS;var ik=/^([\s\S]*?)(\s+)(\S*)$/,iR="AI_InvalidToolArgumentsError",iO=`vercel.ai.error.${iR}`,iC=Symbol.for(iO),iP=class extends eA{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${eP(n)}`}){super({name:iR,message:r,cause:n}),this[U]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return eA.hasMarker(e,iO)}};U=iC;var iD="AI_NoSuchToolError",iM=`vercel.ai.error.${iD}`,ij=Symbol.for(iM),iF=class extends eA{constructor({toolName:e,availableTools:t,message:n=`Model tried to call unavailable tool '${e}'. ${void 0===t?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:iD,message:n}),this[L]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return eA.hasMarker(e,iM)}};L=ij;var iV="AI_ToolCallRepairError",iU=`vercel.ai.error.${iV}`,iL=Symbol.for(iU),i$=class extends eA{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${eP(e)}`}){super({name:iV,message:n,cause:e}),this[$]=!0,this.originalError=t}static isInstance(e){return eA.hasMarker(e,iU)}};async function iB({toolCall:e,tools:t,repairToolCall:n,system:r,messages:a}){if(null==t)throw new iF({toolName:e.toolName});try{return await iZ({toolCall:e,tools:t})}catch(s){if(null==n||!(iF.isInstance(s)||iP.isInstance(s)))throw s;let i=null;try{i=await n({toolCall:e,tools:t,parameterSchema:({toolName:e})=>au(t[e].parameters).jsonSchema,system:r,messages:a,error:s})}catch(e){throw new i$({cause:e,originalError:s})}if(null==i)throw s;return await iZ({toolCall:i,tools:t})}}async function iZ({toolCall:e,tools:t}){let n=e.toolName,r=t[n];if(null==r)throw new iF({toolName:e.toolName,availableTools:Object.keys(t)});let a=au(r.parameters),i=""===e.args.trim()?tg({value:{},schema:a}):ty({text:e.args,schema:a});if(!1===i.success)throw new iP({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function iG({text:e="",files:t,reasoning:n,tools:r,toolCalls:a,toolResults:i,messageId:s,generateMessageId:o}){let l=[],u=[];return n.length>0&&u.push(...n.map(e=>"text"===e.type?{...e,type:"reasoning"}:{...e,type:"redacted-reasoning"})),t.length>0&&u.push(...t.map(e=>({type:"file",data:e.base64,mimeType:e.mimeType}))),e.length>0&&u.push({type:"text",text:e}),a.length>0&&u.push(...a),u.length>0&&l.push({role:"assistant",content:u,id:s}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(e=>{let t=r[e.toolName];return(null==t?void 0:t.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:t.experimental_toToolResultContent(e.result),experimental_content:t.experimental_toToolResultContent(e.result)}:{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result}})}),l}$=iL,tp({prefix:"aitxt",size:24}),tp({prefix:"msg",size:24}),ad({},{object:()=>iQ,text:()=>iH});var iW="AI_InvalidStreamPartError",iK=`vercel.ai.error.${iW}`,iY=Symbol.for(iK),iX=class extends eA{constructor({chunk:e,message:t}){super({name:iW,message:t}),this[B]=!0,this.chunk=e}static isInstance(e){return eA.hasMarker(e,iK)}};B=iY;var iJ="vercel.ai.error.AI_MCPClientError",iz=Symbol.for(iJ),iq=class extends eA{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[Z]=!0}static isInstance(e){return eA.hasMarker(e,iJ)}};Z=iz;var iH=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt:({system:e})=>e,parsePartial:({text:e})=>({partial:e}),parseOutput:({text:e})=>e}),iQ=({schema:e})=>{let t=au(e);return{type:"object",responseFormat:({model:e})=>({type:"json",schema:e.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt:({system:e,model:n})=>n.supportsStructuredOutputs?e:function({prompt:e,schema:t,schemaPrefix:n=null!=t?"JSON schema:":void 0,schemaSuffix:r=null!=t?"You MUST answer with a JSON object that matches the JSON schema above.":"You MUST answer with JSON."}){return[null!=e&&e.length>0?e:void 0,null!=e&&e.length>0?"":void 0,n,null!=t?JSON.stringify(t):void 0,r].filter(e=>null!=e).join("\n")}({prompt:e,schema:t.jsonSchema}),parsePartial({text:e}){let t=function(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=ty({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=ty({text:function(e){let t=["ROOT"],n=-1,r=null;function a(e,a,i){switch(e){case'"':n=a,t.pop(),t.push(i),t.push("INSIDE_STRING");break;case"f":case"t":case"n":n=a,r=a,t.pop(),t.push(i),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=a,t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"{":n=a,t.pop(),t.push(i),t.push("INSIDE_OBJECT_START");break;case"[":n=a,t.pop(),t.push(i),t.push("INSIDE_ARRAY_START")}}function i(e,r){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":n=r,t.pop()}}function s(e,r){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":n=r,t.pop()}}for(let o=0;o<e.length;o++){let l=e[o];switch(t[t.length-1]){case"ROOT":a(l,o,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":n=o,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":a(l,o,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":i(l,o);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),n=o;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:n=o}break;case"INSIDE_ARRAY_START":"]"===l?(n=o,t.pop()):(n=o,a(l,o,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":n=o,t.pop();break;default:n=o}break;case"INSIDE_ARRAY_AFTER_COMMA":a(l,o,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),n=o;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=o;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,o),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(l,o);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(l,o);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,o);break;default:t.pop()}break;case"INSIDE_LITERAL":{let a=e.substring(r,o+1);"false".startsWith(a)||"true".startsWith(a)||"null".startsWith(a)?n=o:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?i(l,o):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(l,o))}}}let o=e.slice(0,n+1);for(let n=t.length-1;n>=0;n--)switch(t[n]){case"INSIDE_STRING":o+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":o+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":o+="]";break;case"INSIDE_LITERAL":{let t=e.substring(r,e.length);"true".startsWith(t)?o+="true".slice(t.length):"false".startsWith(t)?o+="false".slice(t.length):"null".startsWith(t)&&(o+="null".slice(t.length))}}return o}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}(e);switch(t.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:t.value};default:{let e=t.state;throw Error(`Unsupported parse state: ${e}`)}}},parseOutput({text:e},n){let r=ty({text:e});if(!r.success)throw new aL({message:"No object generated: could not parse the response.",cause:r.error,text:e,response:n.response,usage:n.usage,finishReason:n.finishReason});let a=tg({value:r.value,schema:t});if(!a.success)throw new aL({message:"No object generated: response did not match schema.",cause:a.error,text:e,response:n.response,usage:n.usage,finishReason:n.finishReason});return a.value}}};async function i0({stream:e,onError:t}){let n=e.getReader();try{for(;;){let{done:e}=await n.read();if(e)break}}catch(e){null==t||t(e)}finally{n.releaseLock()}}function i1(e,t){let n,r;let a=e.getReader(),i=t.getReader(),s=!1,o=!1;async function l(e){try{null==n&&(n=a.read());let t=await n;n=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}async function u(e){try{null==r&&(r=i.read());let t=await r;r=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}return new ReadableStream({async pull(e){try{if(s){await u(e);return}if(o){await l(e);return}null==n&&(n=a.read()),null==r&&(r=i.read());let{result:t,reader:c}=await Promise.race([n.then(e=>({result:e,reader:a})),r.then(e=>({result:e,reader:i}))]);t.done||e.enqueue(t.value),c===a?(n=void 0,t.done&&(await u(e),s=!0)):(r=void 0,t.done&&(o=!0,await l(e)))}catch(t){e.error(t)}},cancel(){a.cancel(),i.cancel()}})}var i2=tp({prefix:"aitxt",size:24}),i3=tp({prefix:"msg",size:24}),i9=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:a,abortSignal:i,system:s,prompt:o,messages:l,tools:u,toolChoice:c,toolCallStreaming:d,transforms:p,activeTools:m,repairToolCall:h,maxSteps:f,output:g,continueSteps:y,providerOptions:b,now:v,currentDate:w,generateId:_,generateMessageId:E,onChunk:T,onError:A,onFinish:I,onStepFinish:x}){var S;let N,k,R,O;if(this.warningsPromise=new iv,this.usagePromise=new iv,this.finishReasonPromise=new iv,this.providerMetadataPromise=new iv,this.textPromise=new iv,this.reasoningPromise=new iv,this.reasoningDetailsPromise=new iv,this.sourcesPromise=new iv,this.filesPromise=new iv,this.toolCallsPromise=new iv,this.toolResultsPromise=new iv,this.requestPromise=new iv,this.responsePromise=new iv,this.stepsPromise=new iv,f<1)throw new av({parameter:"maxSteps",value:f,message:"maxSteps must be at least 1"});this.output=g;let C="",P="",D="",M=[],j=[],F=[],V=[],U={id:_(),timestamp:w(),modelId:e.modelId,messages:[]},L=[],$=[],B="initial",Z=[],G=new TransformStream({async transform(e,t){t.enqueue(e);let{part:n}=e;if(("text-delta"===n.type||"reasoning"===n.type||"source"===n.type||"tool-call"===n.type||"tool-result"===n.type||"tool-call-streaming-start"===n.type||"tool-call-delta"===n.type)&&await (null==T?void 0:T({chunk:n})),"error"===n.type&&await (null==A?void 0:A({error:n.error})),"text-delta"===n.type&&(C+=n.textDelta,P+=n.textDelta,D+=n.textDelta),"reasoning"===n.type&&(null==k?(k={type:"text",text:n.textDelta},M.push(k)):k.text+=n.textDelta),"reasoning-signature"===n.type){if(null==k)throw new eA({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});k.signature=n.signature,k=void 0}if("redacted-reasoning"===n.type&&M.push({type:"redacted",data:n.data}),"file"===n.type&&j.push(n),"source"===n.type&&(V.push(n.source),F.push(n.source)),"tool-call"===n.type&&L.push(n),"tool-result"===n.type&&$.push(n),"step-finish"===n.type){let e=iG({text:P,files:j,reasoning:M,tools:null!=u?u:{},toolCalls:L,toolResults:$,messageId:n.messageId,generateMessageId:E}),t=Z.length,r="done";t+1<f&&(y&&"length"===n.finishReason&&0===L.length?r="continue":L.length>0&&$.length===L.length&&(r="tool-result"));let a={stepType:B,text:C,reasoning:function(e){let t=e.filter(e=>"text"===e.type).map(e=>e.text).join("");return t.length>0?t:void 0}(M),reasoningDetails:M,files:j,sources:F,toolCalls:L,toolResults:$,finishReason:n.finishReason,usage:n.usage,warnings:n.warnings,logprobs:n.logprobs,request:n.request,response:{...n.response,messages:[...U.messages,...e]},providerMetadata:n.experimental_providerMetadata,experimental_providerMetadata:n.experimental_providerMetadata,isContinued:n.isContinued};await (null==x?void 0:x(a)),Z.push(a),L=[],$=[],C="",F=[],M=[],j=[],k=void 0,"done"!==r&&(B=r),"continue"!==r&&(U.messages.push(...e),P="")}"finish"===n.type&&(U.id=n.response.id,U.timestamp=n.response.timestamp,U.modelId=n.response.modelId,U.headers=n.response.headers,O=n.usage,R=n.finishReason)},async flush(e){var n;try{if(0===Z.length)return;let e=Z[Z.length-1];H.warningsPromise.resolve(e.warnings),H.requestPromise.resolve(e.request),H.responsePromise.resolve(e.response),H.toolCallsPromise.resolve(e.toolCalls),H.toolResultsPromise.resolve(e.toolResults),H.providerMetadataPromise.resolve(e.experimental_providerMetadata),H.reasoningPromise.resolve(e.reasoning),H.reasoningDetailsPromise.resolve(e.reasoningDetails);let r=null!=R?R:"unknown",a=null!=O?O:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};H.finishReasonPromise.resolve(r),H.usagePromise.resolve(a),H.textPromise.resolve(D),H.sourcesPromise.resolve(V),H.filesPromise.resolve(e.files),H.stepsPromise.resolve(Z),await (null==I?void 0:I({finishReason:r,logprobs:void 0,usage:a,text:D,reasoning:e.reasoning,reasoningDetails:e.reasoningDetails,files:e.files,sources:e.sources,toolCalls:e.toolCalls,toolResults:e.toolResults,request:null!=(n=e.request)?n:{},response:e.response,warnings:e.warnings,providerMetadata:e.providerMetadata,experimental_providerMetadata:e.experimental_providerMetadata,steps:Z})),N.setAttributes(aC({telemetry:t,attributes:{"ai.response.finishReason":r,"ai.response.text":{output:()=>D},"ai.response.toolCalls":{output:()=>{var t;return(null==(t=e.toolCalls)?void 0:t.length)?JSON.stringify(e.toolCalls):void 0}},"ai.usage.promptTokens":a.promptTokens,"ai.usage.completionTokens":a.completionTokens,"ai.response.providerMetadata":JSON.stringify(e.providerMetadata)}}))}catch(t){e.error(t)}finally{N.end()}}}),W=function(){let e=[],t=null,n=!1,r=iw(),a=async()=>{if(n&&0===e.length){null==t||t.close();return}if(0===e.length)return r=iw(),await r.promise,a();try{let{value:r,done:i}=await e[0].read();i?(e.shift(),e.length>0?await a():n&&(null==t||t.close())):null==t||t.enqueue(r)}catch(r){null==t||t.error(r),e.shift(),n&&0===e.length&&(null==t||t.close())}};return{stream:new ReadableStream({start(e){t=e},pull:a,async cancel(){for(let t of e)await t.cancel();e=[],n=!0}}),addStream:t=>{if(n)throw Error("Cannot add inner stream: outer stream is closed");e.push(t.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),0===e.length&&(null==t||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(e=>e.cancel()),e=[],null==t||t.close()}}}();this.addStream=W.addStream,this.closeStream=W.close;let K=W.stream;for(let e of p)K=K.pipeThrough(e({tools:u,stopStream(){W.terminate()}}));this.baseStream=K.pipeThrough(function(e){if(!e)return new TransformStream({transform(e,t){t.enqueue({part:e,partialOutput:void 0})}});let t="",n="",r="";function a({controller:e,partialOutput:t}){e.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:t}),n=""}return new TransformStream({transform(i,s){if("step-finish"===i.type&&a({controller:s}),"text-delta"!==i.type){s.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;let o=e.parsePartial({text:t});if(null!=o){let e=JSON.stringify(o.partial);e!==r&&(a({controller:s,partialOutput:o.partial}),r=e)}},flush(e){n.length>0&&a({controller:e})}})}(g)).pipeThrough(G);let{maxRetries:Y,retry:X}=function({maxRetries:e}){if(null!=e){if(!Number.isInteger(e))throw new av({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new av({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}let t=null!=e?e:2;return{maxRetries:t,retry:aA({maxRetries:t})}}({maxRetries:a}),J=function({isEnabled:e=!1,tracer:t}={}){return e?t||rR.g.getTracer("ai"):aS}(t),z=function({model:e,settings:t,telemetry:n,headers:r}){var a;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((e,[t,n])=>(e[`ai.settings.${t}`]=n,e),{}),...Object.entries(null!=(a=null==n?void 0:n.metadata)?a:{}).reduce((e,[t,n])=>(e[`ai.telemetry.metadata.${t}`]=n,e),{}),...Object.entries(null!=r?r:{}).reduce((e,[t,n])=>(void 0!==n&&(e[`ai.request.headers.${t}`]=n),e),{})}}({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Y}}),q=function({prompt:e,tools:t}){if(null==e.prompt&&null==e.messages)throw new e$({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new e$({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!=typeof e.system)throw new e$({prompt:e,message:"system must be a string"});if(null!=e.prompt){if("string"!=typeof e.prompt)throw new e$({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(null!=e.messages){let n="ui-messages"===function(e){if(!Array.isArray(e))throw new e$({prompt:e,message:`messages must be an array of CoreMessage or UIMessage
Received non-array value: ${JSON.stringify(e)}`,cause:e});if(0===e.length)return"messages";let t=e.map(ig);if(t.some(e=>"has-ui-specific-parts"===e))return"ui-messages";let n=t.findIndex(e=>"has-core-specific-parts"!==e&&"message"!==e);if(-1===n)return"messages";throw new e$({prompt:e,message:`messages must be an array of CoreMessage or UIMessage
Received message of type: "${t[n]}" at index ${n}
messages[${n}]: ${JSON.stringify(e[n])}`,cause:e})}(e.messages)?function(e,t){var n,r;let a=null!=(n=null==t?void 0:t.tools)?n:{},i=[];for(let t=0;t<e.length;t++){let n=e[t],s=t===e.length-1,{role:o,content:l,experimental_attachments:u}=n;switch(o){case"system":i.push({role:"system",content:l});break;case"user":if(null==n.parts)i.push({role:"user",content:u?[{type:"text",text:l},...a4(u)]:l});else{let e=n.parts.filter(e=>"text"===e.type).map(e=>({type:"text",text:e.text}));i.push({role:"user",content:u?[...e,...a4(u)]:e})}break;case"assistant":{if(null!=n.parts){let e=function(){let e=[];for(let t of o)switch(t.type){case"file":case"text":e.push(t);break;case"reasoning":for(let n of t.details)switch(n.type){case"text":e.push({type:"reasoning",text:n.text,signature:n.signature});break;case"redacted":e.push({type:"redacted-reasoning",data:n.data})}break;case"tool-invocation":e.push({type:"tool-call",toolCallId:t.toolInvocation.toolCallId,toolName:t.toolInvocation.toolName,args:t.toolInvocation.args});break;default:throw Error(`Unsupported part: ${t}`)}i.push({role:"assistant",content:e});let r=o.filter(e=>"tool-invocation"===e.type).map(e=>e.toolInvocation);r.length>0&&i.push({role:"tool",content:r.map(e=>{if(!("result"in e))throw new a7({originalMessage:n,message:"ToolInvocation must have a result: "+JSON.stringify(e)});let{toolCallId:t,toolName:r,result:i}=e,s=a[r];return(null==s?void 0:s.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:t,toolName:r,result:s.experimental_toToolResultContent(i),experimental_content:s.experimental_toToolResultContent(i)}:{type:"tool-result",toolCallId:t,toolName:r,result:i}})}),o=[],s=!1,t++},t=0,s=!1,o=[];for(let a of n.parts)switch(a.type){case"text":s&&e(),o.push(a);break;case"file":case"reasoning":o.push(a);break;case"tool-invocation":(null!=(r=a.toolInvocation.step)?r:0)!==t&&e(),o.push(a),s=!0}e();break}let e=n.toolInvocations;if(null==e||0===e.length){i.push({role:"assistant",content:l});break}let t=e.reduce((e,t)=>{var n;return Math.max(e,null!=(n=t.step)?n:0)},0);for(let r=0;r<=t;r++){let t=e.filter(e=>{var t;return(null!=(t=e.step)?t:0)===r});0!==t.length&&(i.push({role:"assistant",content:[...s&&l&&0===r?[{type:"text",text:l}]:[],...t.map(({toolCallId:e,toolName:t,args:n})=>({type:"tool-call",toolCallId:e,toolName:t,args:n}))]}),i.push({role:"tool",content:t.map(e=>{if(!("result"in e))throw new a7({originalMessage:n,message:"ToolInvocation must have a result: "+JSON.stringify(e)});let{toolCallId:t,toolName:r,result:i}=e,s=a[r];return(null==s?void 0:s.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:t,toolName:r,result:s.experimental_toToolResultContent(i),experimental_content:s.experimental_toToolResultContent(i)}:{type:"tool-result",toolCallId:t,toolName:r,result:i}})}))}l&&!s&&i.push({role:"assistant",content:l});break}case"data":break;default:throw new a7({originalMessage:n,message:`Unsupported role: ${o}`})}}return i}(e.messages,{tools:t}):e.messages;if(0===n.length)throw new e$({prompt:e,message:"messages must not be empty"});let r=tg({value:n,schema:nz(ih)});if(!r.success)throw new e$({prompt:e,message:`message must be a CoreMessage or a UI message
Validation error: ${r.error.message}`,cause:r.error});return{type:"messages",messages:n,system:e.system}}throw Error("unreachable")}({prompt:{system:null!=(S=null==g?void 0:g.injectIntoSystemPrompt({system:s,model:e}))?S:s,prompt:o,messages:l},tools:u}),H=this;aR({name:"ai.streamText",attributes:aC({telemetry:t,attributes:{...ax({operationId:"ai.streamText",telemetry:t}),...z,"ai.prompt":{input:()=>JSON.stringify({system:s,prompt:o,messages:l})},"ai.settings.maxSteps":f}}),tracer:J,endWhenDone:!1,fn:async a=>{async function o({currentStep:a,responseMessages:l,usage:p,stepType:T,previousStepText:A,hasLeadingWhitespace:I,messageId:x}){var S;let N,k,R;let O=0===l.length?q.type:"messages",C=[...q.messages,...l],P=await a3({prompt:{type:O,system:q.system,messages:C},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:null==(S=e.supportsUrl)?void 0:S.bind(e)}),D={type:"regular",...function({tools:e,toolChoice:t,activeTools:n}){return null!=e&&Object.keys(e).length>0?{tools:(null!=n?Object.entries(e).filter(([e])=>n.includes(e)):Object.entries(e)).map(([e,t])=>{let n=t.type;switch(n){case void 0:case"function":return{type:"function",name:e,description:t.description,parameters:au(t.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:e,id:t.id,args:t.args};default:throw Error(`Unsupported tool type: ${n}`)}}),toolChoice:null==t?{type:"auto"}:"string"==typeof t?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}({tools:u,toolChoice:c,activeTools:m})},{result:{stream:M,warnings:j,rawResponse:F,request:V},doStreamSpan:U,startTimestampMs:L}=await X(()=>aR({name:"ai.streamText.doStream",attributes:aC({telemetry:t,attributes:{...ax({operationId:"ai.streamText.doStream",telemetry:t}),...z,"ai.prompt.format":{input:()=>O},"ai.prompt.messages":{input:()=>JSON.stringify(P.map(e=>({...e,content:"string"==typeof e.content?e.content:e.content.map(ib)})))},"ai.prompt.tools":{input:()=>{var e;return null==(e=D.tools)?void 0:e.map(e=>JSON.stringify(e))}},"ai.prompt.toolChoice":{input:()=>null!=D.toolChoice?JSON.stringify(D.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:J,endWhenDone:!1,fn:async t=>({startTimestampMs:v(),doStreamSpan:t,result:await e.doStream({mode:D,...function({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:a,frequencyPenalty:i,stopSequences:s,seed:o}){if(null!=e){if(!Number.isInteger(e))throw new av({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new av({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(null!=t&&"number"!=typeof t)throw new av({parameter:"temperature",value:t,message:"temperature must be a number"});if(null!=n&&"number"!=typeof n)throw new av({parameter:"topP",value:n,message:"topP must be a number"});if(null!=r&&"number"!=typeof r)throw new av({parameter:"topK",value:r,message:"topK must be a number"});if(null!=a&&"number"!=typeof a)throw new av({parameter:"presencePenalty",value:a,message:"presencePenalty must be a number"});if(null!=i&&"number"!=typeof i)throw new av({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(null!=o&&!Number.isInteger(o))throw new av({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:null!=t?t:0,topP:n,topK:r,presencePenalty:a,frequencyPenalty:i,stopSequences:null!=s&&s.length>0?s:void 0,seed:o}}(r),inputFormat:O,responseFormat:null==g?void 0:g.responseFormat({model:e}),prompt:P,providerMetadata:b,abortSignal:i,headers:n})})})),$=function({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:a,system:i,messages:s,abortSignal:o,repairToolCall:l}){let u,c=null,d=new ReadableStream({start(e){c=e}}),p={},m=new Set,h=!1;function f(){h&&0===m.size&&(null!=u&&c.enqueue(u),c.close())}let g=new TransformStream({async transform(t,d){let h=t.type;switch(h){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":d.enqueue(t);break;case"file":d.enqueue(new aD({data:t.data,mimeType:t.mimeType}));break;case"tool-call-delta":n&&(p[t.toolCallId]||(d.enqueue({type:"tool-call-streaming-start",toolCallId:t.toolCallId,toolName:t.toolName}),p[t.toolCallId]=!0),d.enqueue({type:"tool-call-delta",toolCallId:t.toolCallId,toolName:t.toolName,argsTextDelta:t.argsTextDelta}));break;case"tool-call":try{let n=await iB({toolCall:t,tools:e,repairToolCall:l,system:i,messages:s});d.enqueue(n);let u=e[n.toolName];if(null!=u.execute){let e=tm();m.add(e),aR({name:"ai.toolCall",attributes:aC({telemetry:a,attributes:{...ax({operationId:"ai.toolCall",telemetry:a}),"ai.toolCall.name":n.toolName,"ai.toolCall.id":n.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(n.args)}}}),tracer:r,fn:async t=>u.execute(n.args,{toolCallId:n.toolCallId,messages:s,abortSignal:o}).then(r=>{c.enqueue({...n,type:"tool-result",result:r}),m.delete(e),f();try{t.setAttributes(aC({telemetry:a,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(r)}}}))}catch(e){}},r=>{aO(t,r),c.enqueue({type:"error",error:new iN({toolCallId:n.toolCallId,toolName:n.toolName,toolArgs:n.args,cause:r})}),m.delete(e),f()})})}}catch(e){c.enqueue({type:"error",error:e})}break;case"finish":u={type:"finish",finishReason:t.finishReason,logprobs:t.logprobs,usage:function({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}(t.usage),experimental_providerMetadata:t.providerMetadata};break;default:throw Error(`Unhandled chunk type: ${h}`)}},flush(){h=!0,f()}});return new ReadableStream({start:async e=>Promise.all([t.pipeThrough(g).pipeTo(new WritableStream({write(t){e.enqueue(t)},close(){}})),d.pipeTo(new WritableStream({write(t){e.enqueue(t)},close(){e.close()}}))])})}({tools:u,generatorStream:M,toolCallStreaming:d,tracer:J,telemetry:t,system:s,messages:C,repairToolCall:h,abortSignal:i}),B=null!=V?V:{},Z=[],G=[],W=[],K=[],Y="unknown",Q={promptTokens:0,completionTokens:0,totalTokens:0},ee=!0,et="",en="continue"===T?A:"",er={id:_(),timestamp:w(),modelId:e.modelId},ea="",ei=!1,es=!0,eo=!1;async function el({controller:e,chunk:t}){e.enqueue(t),et+=t.textDelta,en+=t.textDelta,ei=!0,eo=t.textDelta.trimEnd()!==t.textDelta}H.addStream($.pipeThrough(new TransformStream({async transform(e,t){var n,r,a;if(ee){let e=v()-L;ee=!1,U.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":e}),U.setAttributes({"ai.response.msToFirstChunk":e}),t.enqueue({type:"step-start",messageId:x,request:B,warnings:null!=j?j:[]})}if("text-delta"===e.type&&0===e.textDelta.length)return;let i=e.type;switch(i){case"text-delta":if(y){let n=es&&I?e.textDelta.trimStart():e.textDelta;if(0===n.length)break;es=!1;let r=function(e){let t=e.match(ik);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}(ea+=n);null!=r&&(ea=r.suffix,await el({controller:t,chunk:{type:"text-delta",textDelta:r.prefix+r.whitespace}}))}else await el({controller:t,chunk:e});break;case"reasoning":t.enqueue(e),null==R?(R={type:"text",text:e.textDelta},W.push(R)):R.text+=e.textDelta;break;case"reasoning-signature":if(t.enqueue(e),null==R)throw new iX({chunk:e,message:"reasoning-signature without reasoning"});R.signature=e.signature,R=void 0;break;case"redacted-reasoning":t.enqueue(e),W.push({type:"redacted",data:e.data});break;case"tool-call":t.enqueue(e),Z.push(e);break;case"tool-result":t.enqueue(e),G.push(e);break;case"response-metadata":er={id:null!=(n=e.id)?n:er.id,timestamp:null!=(r=e.timestamp)?r:er.timestamp,modelId:null!=(a=e.modelId)?a:er.modelId};break;case"finish":{Q=e.usage,Y=e.finishReason,N=e.experimental_providerMetadata,k=e.logprobs;let t=v()-L;U.addEvent("ai.stream.finish"),U.setAttributes({"ai.response.msToFinish":t,"ai.response.avgCompletionTokensPerSecond":1e3*Q.completionTokens/t});break}case"file":K.push(e),t.enqueue(e);break;case"source":case"tool-call-streaming-start":case"tool-call-delta":t.enqueue(e);break;case"error":t.enqueue(e),Y="error";break;default:throw Error(`Unknown chunk type: ${i}`)}},async flush(e){var n;let r=Z.length>0?JSON.stringify(Z):void 0,i="done";a+1<f&&(y&&"length"===Y&&0===Z.length?i="continue":Z.length>0&&G.length===Z.length&&(i="tool-result")),y&&ea.length>0&&("continue"!==i||"continue"===T&&!ei)&&(await el({controller:e,chunk:{type:"text-delta",textDelta:ea}}),ea="");try{U.setAttributes(aC({telemetry:t,attributes:{"ai.response.finishReason":Y,"ai.response.text":{output:()=>et},"ai.response.toolCalls":{output:()=>r},"ai.response.id":er.id,"ai.response.model":er.modelId,"ai.response.timestamp":er.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(N),"ai.usage.promptTokens":Q.promptTokens,"ai.usage.completionTokens":Q.completionTokens,"gen_ai.response.finish_reasons":[Y],"gen_ai.response.id":er.id,"gen_ai.response.model":er.modelId,"gen_ai.usage.input_tokens":Q.promptTokens,"gen_ai.usage.output_tokens":Q.completionTokens}}))}catch(e){}finally{U.end()}e.enqueue({type:"step-finish",finishReason:Y,usage:Q,providerMetadata:N,experimental_providerMetadata:N,logprobs:k,request:B,response:{...er,headers:null==F?void 0:F.headers},warnings:j,isContinued:"continue"===i,messageId:x});let s=(n=Q,{promptTokens:p.promptTokens+n.promptTokens,completionTokens:p.completionTokens+n.completionTokens,totalTokens:p.totalTokens+n.totalTokens});if("done"===i)e.enqueue({type:"finish",finishReason:Y,usage:s,providerMetadata:N,experimental_providerMetadata:N,logprobs:k,response:{...er,headers:null==F?void 0:F.headers}}),H.closeStream();else{if("continue"===T){let e=l[l.length-1];"string"==typeof e.content?e.content+=et:e.content.push({text:et,type:"text"})}else l.push(...iG({text:et,files:K,reasoning:W,tools:null!=u?u:{},toolCalls:Z,toolResults:G,messageId:x,generateMessageId:E}));await o({currentStep:a+1,responseMessages:l,usage:s,stepType:i,previousStepText:en,hasLeadingWhitespace:eo,messageId:"continue"===i?x:E()})}}})))}N=a,await o({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:E()})}}).catch(e=>{H.addStream(new ReadableStream({start(t){t.enqueue({type:"error",error:e}),t.close()}})),H.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){let[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return iy(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){"text-delta"===e.type&&t.enqueue(e.textDelta)}})))}get fullStream(){return iy(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await i0({stream:this.fullStream,onError:null==e?void 0:e.onError})}catch(n){null==(t=null==e?void 0:e.onError)||t.call(e,n)}}get experimental_partialOutputStream(){if(null==this.output)throw new iA;return iy(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){null!=e&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:a=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,s)=>{let o=i.type;switch(o){case"text-delta":s.enqueue(ao("text",i.textDelta));break;case"reasoning":n&&s.enqueue(ao("reasoning",i.textDelta));break;case"redacted-reasoning":n&&s.enqueue(ao("redacted_reasoning",{data:i.data}));break;case"reasoning-signature":n&&s.enqueue(ao("reasoning_signature",{signature:i.signature}));break;case"file":s.enqueue(ao("file",{mimeType:i.mimeType,data:i.base64}));break;case"source":r&&s.enqueue(ao("source",i.source));break;case"tool-call-streaming-start":s.enqueue(ao("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break;case"tool-call-delta":s.enqueue(ao("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break;case"tool-call":s.enqueue(ao("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break;case"tool-result":s.enqueue(ao("tool_result",{toolCallId:i.toolCallId,result:i.result}));break;case"error":s.enqueue(ao("error",e(i.error)));break;case"step-start":s.enqueue(ao("start_step",{messageId:i.messageId}));break;case"step-finish":s.enqueue(ao("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break;case"finish":a&&s.enqueue(ao("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break;default:throw Error(`Unknown chunk type: ${o}`)}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:a,getErrorMessage:i,sendUsage:s,sendReasoning:o,sendSources:l,experimental_sendFinish:u}={}){ah({response:e,status:t,statusText:n,headers:am(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:a,getErrorMessage:i,sendUsage:s,sendReasoning:o,sendSources:l,experimental_sendFinish:u})})}pipeTextStreamToResponse(e,t){ah({response:e,status:null==t?void 0:t.status,statusText:null==t?void 0:t.statusText,headers:am(null==t?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){let t=this.toDataStreamInternal({getErrorMessage:null==e?void 0:e.getErrorMessage,sendUsage:null==e?void 0:e.sendUsage,sendReasoning:null==e?void 0:e.sendReasoning,sendSources:null==e?void 0:e.sendSources,experimental_sendFinish:null==e?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return(null==e?void 0:e.data)?i1(null==e?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:null==t?void 0:t.sendUsage,sendReasoning:null==t?void 0:t.sendReasoning,sendSources:null==t?void 0:t.sendSources,experimental_sendFinish:null==t?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:a,sendUsage:i,sendReasoning:s,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:a,sendUsage:i,sendReasoning:s,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:ap(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:null!=(t=null==e?void 0:e.status)?t:200,headers:ap(null==e?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}},i4="AI_NoSuchProviderError",i5=`vercel.ai.error.${i4}`;G=Symbol.for(i5);var i6=nq({name:nG(),version:nG()}).passthrough(),i8=nq({_meta:n9(nq({}).passthrough())}).passthrough(),i7=nq({method:nG(),params:n9(i8)}),se=nq({experimental:n9(nq({}).passthrough()),logging:n9(nq({}).passthrough()),prompts:n9(nq({listChanged:n9(nK())}).passthrough()),resources:n9(nq({subscribe:n9(nK()),listChanged:n9(nK())}).passthrough()),tools:n9(nq({listChanged:n9(nK())}).passthrough())}).passthrough(),st=(i8.extend({protocolVersion:nG(),capabilities:se,serverInfo:i6,instructions:n9(nG())}),i8.extend({nextCursor:n9(nG())})),sn=nq({name:nG(),description:n9(nG()),inputSchema:nq({type:n2("object"),properties:n9(nq({}).passthrough())}).passthrough()}).passthrough(),sr=(st.extend({tools:nz(sn)}),nq({type:n2("text"),text:nG()}).passthrough()),sa=nq({type:n2("image"),data:nG().base64(),mimeType:nG()}).passthrough(),si=nq({uri:nG(),mimeType:n9(nG())}).passthrough(),ss=si.extend({text:nG()}),so=si.extend({blob:nG().base64()}),sl=nq({type:n2("resource"),resource:nH([ss,so])}).passthrough(),su=(i8.extend({content:nz(nH([sr,sa,sl])),isError:nK().default(!1).optional()}).or(i8.extend({toolResult:nJ()})),nq({jsonrpc:n2("2.0"),id:nH([nG(),nW().int()])}).merge(i7).strict()),sc=nq({jsonrpc:n2("2.0"),id:nH([nG(),nW().int()]),result:i8}).strict(),sd=nq({jsonrpc:n2("2.0"),id:nH([nG(),nW().int()]),error:nq({code:nW().int(),message:nG(),data:n9(nJ())})}).strict(),sp=nH([su,nq({jsonrpc:n2("2.0")}).merge(nq({method:nG(),params:n9(i8)})).strict(),sc,sd]);function sm(e={}){let t=new TextEncoder,n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,a){a.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&"string"==typeof r&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function sh(e,t){return e.pipeThrough(new TransformStream({transform:async(e,t)=>{var n;if("string"==typeof e){t.enqueue(e);return}if("event"in e){"on_chat_model_stream"===e.event&&sb(null==(n=e.data)?void 0:n.chunk,t);return}sb(e,t)}})).pipeThrough(sm(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(e,t)=>{t.enqueue(ao("text",e))}}))}function sf(e,t){return sh(e,t).pipeThrough(new TextEncoderStream)}function sg(e,t){var n;let r=sh(e,null==t?void 0:t.callbacks).pipeThrough(new TextEncoderStream),a=null==t?void 0:t.data,i=null==t?void 0:t.init;return new Response(a?i1(a.stream,r):r,{status:null!=(n=null==i?void 0:i.status)?n:200,statusText:null==i?void 0:i.statusText,headers:ap(null==i?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function sy(e,t){t.dataStream.merge(sh(e,t.callbacks))}function sb(e,t){if("string"==typeof e.content)t.enqueue(e.content);else for(let n of e.content)"text"===n.type&&t.enqueue(n.text)}function sv(e,t){var n;let r;let a=(r=!0,e=>(r&&(e=e.trimStart())&&(r=!1),e));return(n=e[Symbol.asyncIterator](),new ReadableStream({async pull(e){try{let{value:t,done:r}=await n.next();r?e.close():e.enqueue(t)}catch(t){e.error(t)}},cancel(){}})).pipeThrough(new TransformStream({async transform(e,t){t.enqueue(a(e.delta))}})).pipeThrough(sm(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(e,t)=>{t.enqueue(ao("text",e))}}))}function sw(e,t){return sv(e,t).pipeThrough(new TextEncoderStream)}function s_(e,t={}){var n;let{init:r,data:a,callbacks:i}=t,s=sv(e,i).pipeThrough(new TextEncoderStream);return new Response(a?i1(a.stream,s):s,{status:null!=(n=null==r?void 0:r.status)?n:200,statusText:null==r?void 0:r.statusText,headers:ap(null==r?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function sE(e,t){t.dataStream.merge(sv(e,t.callbacks))}ad({},{mergeIntoDataStream:()=>sy,toDataStream:()=>sf,toDataStreamResponse:()=>sg}),ad({},{mergeIntoDataStream:()=>sE,toDataStream:()=>sw,toDataStreamResponse:()=>s_});let sT=/\{[^{}]+\}/g,sA=()=>"object"==typeof process&&Number.parseInt(process?.versions?.node?.substring(0,2))>=18&&process.versions.undici;function sI(e){let{baseUrl:t="",Request:n=globalThis.Request,fetch:r=globalThis.fetch,querySerializer:a,bodySerializer:i,headers:s,requestInitExt:o,...l}={...e};o=sA()?o:void 0,t=sC(t);let u=[];async function c(e,c){var d;let p,m,h,f,g;let{baseUrl:y,fetch:b=r,Request:v=n,headers:w,params:_={},parseAs:E="json",querySerializer:T,bodySerializer:A=i??sR,body:I,...x}=c||{},S=t;y&&(S=sC(y)??t);let N="function"==typeof a?a:sk(a);T&&(N="function"==typeof T?T:sk({..."object"==typeof a?a:{},...T}));let k=void 0===I?void 0:A(I,sO(s,w,_.header)),R=sO(void 0===k||k instanceof FormData?{}:{"Content-Type":"application/json"},s,w,_.header),O={redirect:"follow",...l,...x,body:k,headers:R},C=new v((d={baseUrl:S,params:_,querySerializer:N},f=`${d.baseUrl}${e}`,d.params?.path&&(f=function(e,t){let n=e;for(let r of e.match(sT)??[]){let e=r.substring(1,r.length-1),a=!1,i="simple";if(e.endsWith("*")&&(a=!0,e=e.substring(0,e.length-1)),e.startsWith(".")?(i="label",e=e.substring(1)):e.startsWith(";")&&(i="matrix",e=e.substring(1)),!t||void 0===t[e]||null===t[e])continue;let s=t[e];if(Array.isArray(s)){n=n.replace(r,sN(e,s,{style:i,explode:a}));continue}if("object"==typeof s){n=n.replace(r,sS(e,s,{style:i,explode:a}));continue}if("matrix"===i){n=n.replace(r,`;${sx(e,s)}`);continue}n=n.replace(r,"label"===i?`.${encodeURIComponent(s)}`:encodeURIComponent(s))}return n}(f,d.params.path)),(g=d.querySerializer(d.params.query??{})).startsWith("?")&&(g=g.substring(1)),g&&(f+=`?${g}`),f),O);for(let e in x)e in C||(C[e]=x[e]);if(u.length){for(let t of(p=Math.random().toString(36).slice(2,11),m=Object.freeze({baseUrl:S,fetch:b,parseAs:E,querySerializer:N,bodySerializer:A}),u))if(t&&"object"==typeof t&&"function"==typeof t.onRequest){let n=await t.onRequest({request:C,schemaPath:e,params:_,options:m,id:p});if(n){if(n instanceof v)C=n;else if(n instanceof Response){h=n;break}else throw Error("onRequest: must return new Request() or Response() when modifying the request")}}}if(!h){try{h=await b(C,o)}catch(n){let t=n;if(u.length)for(let n=u.length-1;n>=0;n--){let r=u[n];if(r&&"object"==typeof r&&"function"==typeof r.onError){let n=await r.onError({request:C,error:t,schemaPath:e,params:_,options:m,id:p});if(n){if(n instanceof Response){t=void 0,h=n;break}if(n instanceof Error){t=n;continue}throw Error("onError: must return new Response() or instance of Error")}}}if(t)throw t}if(u.length)for(let t=u.length-1;t>=0;t--){let n=u[t];if(n&&"object"==typeof n&&"function"==typeof n.onResponse){let t=await n.onResponse({request:C,response:h,schemaPath:e,params:_,options:m,id:p});if(t){if(!(t instanceof Response))throw Error("onResponse: must return new Response() when modifying the response");h=t}}}}if(204===h.status||"HEAD"===C.method||"0"===h.headers.get("Content-Length"))return h.ok?{data:void 0,response:h}:{error:void 0,response:h};if(h.ok)return"stream"===E?{data:h.body,response:h}:{data:await h[E](),response:h};let P=await h.text();try{P=JSON.parse(P)}catch{}return{error:P,response:h}}return{request:(e,t,n)=>c(t,{...n,method:e.toUpperCase()}),GET:(e,t)=>c(e,{...t,method:"GET"}),PUT:(e,t)=>c(e,{...t,method:"PUT"}),POST:(e,t)=>c(e,{...t,method:"POST"}),DELETE:(e,t)=>c(e,{...t,method:"DELETE"}),OPTIONS:(e,t)=>c(e,{...t,method:"OPTIONS"}),HEAD:(e,t)=>c(e,{...t,method:"HEAD"}),PATCH:(e,t)=>c(e,{...t,method:"PATCH"}),TRACE:(e,t)=>c(e,{...t,method:"TRACE"}),use(...e){for(let t of e)if(t){if("object"!=typeof t||!("onRequest"in t||"onResponse"in t||"onError"in t))throw Error("Middleware must be an object with one of `onRequest()`, `onResponse() or `onError()`");u.push(t)}},eject(...e){for(let t of e){let e=u.indexOf(t);-1!==e&&u.splice(e,1)}}}}function sx(e,t,n){if(null==t)return"";if("object"==typeof t)throw Error("Deeply-nested arrays/objects arent supported. Provide your own `querySerializer()` to handle these.");return`${e}=${n?.allowReserved===!0?t:encodeURIComponent(t)}`}function sS(e,t,n){if(!t||"object"!=typeof t)return"";let r=[],a={simple:",",label:".",matrix:";"}[n.style]||"&";if("deepObject"!==n.style&&!1===n.explode){for(let e in t)r.push(e,!0===n.allowReserved?t[e]:encodeURIComponent(t[e]));let a=r.join(",");switch(n.style){case"form":return`${e}=${a}`;case"label":return`.${a}`;case"matrix":return`;${e}=${a}`;default:return a}}for(let a in t){let i="deepObject"===n.style?`${e}[${a}]`:a;r.push(sx(i,t[a],n))}let i=r.join(a);return"label"===n.style||"matrix"===n.style?`${a}${i}`:i}function sN(e,t,n){if(!Array.isArray(t))return"";if(!1===n.explode){let r={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[n.style]||",",a=(!0===n.allowReserved?t:t.map(e=>encodeURIComponent(e))).join(r);switch(n.style){case"simple":return a;case"label":return`.${a}`;case"matrix":return`;${e}=${a}`;default:return`${e}=${a}`}}let r={simple:",",label:".",matrix:";"}[n.style]||"&",a=[];for(let r of t)"simple"===n.style||"label"===n.style?a.push(!0===n.allowReserved?r:encodeURIComponent(r)):a.push(sx(e,r,n));return"label"===n.style||"matrix"===n.style?`${r}${a.join(r)}`:a.join(r)}function sk(e){return function(t){let n=[];if(t&&"object"==typeof t)for(let r in t){let a=t[r];if(null!=a){if(Array.isArray(a)){if(0===a.length)continue;n.push(sN(r,a,{style:"form",explode:!0,...e?.array,allowReserved:e?.allowReserved||!1}));continue}if("object"==typeof a){n.push(sS(r,a,{style:"deepObject",explode:!0,...e?.object,allowReserved:e?.allowReserved||!1}));continue}n.push(sx(r,a,e))}}return n.join("&")}}function sR(e,t){return e instanceof FormData?e:t&&"application/x-www-form-urlencoded"===(t.get instanceof Function?t.get("Content-Type")??t.get("content-type"):t["Content-Type"]??t["content-type"])?new URLSearchParams(e).toString():JSON.stringify(e)}function sO(...e){let t=new Headers;for(let n of e)if(n&&"object"==typeof n)for(let[e,r]of n instanceof Headers?n.entries():Object.entries(n))if(null===r)t.delete(e);else if(Array.isArray(r))for(let n of r)t.append(e,n);else void 0!==r&&t.set(e,r);return t}function sC(e){return e.endsWith("/")?e.substring(0,e.length-1):e}var sP=n(3023);function sD(e,t){return null!==e&&"object"==typeof e&&"$typeName"in e&&"string"==typeof e.$typeName&&(void 0===t||t.typeName===e.$typeName)}function sM(){let e=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(e|=(127&r)<<n,(128&r)==0)return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,(128&n)==0)return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(127&r)<<n,(128&r)==0)return this.assertBounds(),[e,t]}throw Error("invalid varint")}function sj(e,t,n){for(let r=0;r<28;r+=7){let a=e>>>r,i=!(a>>>7==0&&0==t),s=(i?128|a:a)&255;if(n.push(s),!i)return}let r=e>>>28&15|(7&t)<<4,a=t>>3!=0;if(n.push((a?128|r:r)&255),a){for(let e=3;e<31;e+=7){let r=t>>>e,a=r>>>7!=0,i=(a?128|r:r)&255;if(n.push(i),!a)return}n.push(t>>>31&1)}}function sF(e){let t="-"===e[0];t&&(e=e.slice(1));let n=0,r=0;function a(t,a){let i=Number(e.slice(t,a));r*=1e6,(n=1e6*n+i)>=4294967296&&(r+=n/4294967296|0,n%=4294967296)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?sL(n,r):sU(n,r)}function sV(e,t){if({lo:e,hi:t}={lo:e>>>0,hi:t>>>0},t<=2097151)return String(4294967296*t+e);let n=16777215&e,r=(e>>>24|t<<8)&16777215,a=t>>16&65535,i=n+6777216*r+6710656*a,s=r+8147497*a,o=2*a;return i>=1e7&&(s+=Math.floor(i/1e7),i%=1e7),s>=1e7&&(o+=Math.floor(s/1e7),s%=1e7),o.toString()+s$(s)+s$(i)}function sU(e,t){return{lo:0|e,hi:0|t}}function sL(e,t){return t=~t,e?e=~e+1:t+=1,sU(e,t)}(function(e){e[e.Canceled=1]="Canceled",e[e.Unknown=2]="Unknown",e[e.InvalidArgument=3]="InvalidArgument",e[e.DeadlineExceeded=4]="DeadlineExceeded",e[e.NotFound=5]="NotFound",e[e.AlreadyExists=6]="AlreadyExists",e[e.PermissionDenied=7]="PermissionDenied",e[e.ResourceExhausted=8]="ResourceExhausted",e[e.FailedPrecondition=9]="FailedPrecondition",e[e.Aborted=10]="Aborted",e[e.OutOfRange=11]="OutOfRange",e[e.Unimplemented=12]="Unimplemented",e[e.Internal=13]="Internal",e[e.Unavailable=14]="Unavailable",e[e.DataLoss=15]="DataLoss",e[e.Unauthenticated=16]="Unauthenticated"})(W||(W={})),function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(K||(K={}));let s$=e=>{let t=String(e);return"0000000".slice(t.length)+t};function sB(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function sZ(){let e=this.buf[this.pos++],t=127&e;if((128&e)==0||(t|=(127&(e=this.buf[this.pos++]))<<7,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<14,(128&e)==0)||(t|=(127&(e=this.buf[this.pos++]))<<21,(128&e)==0))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(let t=5;(128&e)!=0&&t<10;t++)e=this.buf[this.pos++];if((128&e)!=0)throw Error("invalid varint");return this.assertBounds(),t>>>0}let sG=function(){let e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&(globalThis.Deno||"object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){let t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),r=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){let r="bigint"==typeof e?e:BigInt(e);if(r>n||r<t)throw Error(`invalid int64: ${e}`);return r},uParse(e){let t="bigint"==typeof e?e:BigInt(e);if(t>a||t<r)throw Error(`invalid uint64: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),sW(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),sK(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),sW(e),sF(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),sK(e),sF(e)),dec:(e,t)=>(function(e,t){let n=sU(e,t),r=2147483648&n.hi;r&&(n=sL(n.lo,n.hi));let a=sV(n.lo,n.hi);return r?"-"+a:a})(e,t),uDec:(e,t)=>sV(e,t)}}();function sW(e){if(!/^-?[0-9]+$/.test(e))throw Error("invalid int64: "+e)}function sK(e){if(!/^[0-9]+$/.test(e))throw Error("invalid uint64: "+e)}function sY(e,t){switch(e){case K.STRING:return"";case K.BOOL:return!1;case K.DOUBLE:case K.FLOAT:return 0;case K.INT64:case K.UINT64:case K.SFIXED64:case K.FIXED64:case K.SINT64:return t?"0":sG.zero;case K.BYTES:return new Uint8Array(0);default:return 0}}let sX=Symbol.for("reflect unsafe local");function sJ(e,t){let n=e[t.localName].case;return void 0===n?n:t.fields.find(e=>e.localName===n)}function sz(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&void 0!==e[t]}function sq(e,t){if(t.oneof){let n=e[t.oneof.localName];return n.case===t.localName?n.value:void 0}return e[t.localName]}function sH(e,t,n){t.oneof?e[t.oneof.localName]={case:t.localName,value:n}:e[t.localName]=n}function sQ(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function s0(e,t){var n,r,a,i;if(sQ(e)&&sX in e&&"add"in e&&"field"in e&&"function"==typeof e.field){if(void 0!==t){let s=e.field();return t.listKind==s.listKind&&t.scalar===s.scalar&&(null===(n=t.message)||void 0===n?void 0:n.typeName)===(null===(r=s.message)||void 0===r?void 0:r.typeName)&&(null===(a=t.enum)||void 0===a?void 0:a.typeName)===(null===(i=s.enum)||void 0===i?void 0:i.typeName)}return!0}return!1}function s1(e,t){var n,r,a,i;if(sQ(e)&&sX in e&&"has"in e&&"field"in e&&"function"==typeof e.field){if(void 0!==t){let s=e.field();return t.mapKey===s.mapKey&&t.mapKind==s.mapKind&&t.scalar===s.scalar&&(null===(n=t.message)||void 0===n?void 0:n.typeName)===(null===(r=s.message)||void 0===r?void 0:r.typeName)&&(null===(a=t.enum)||void 0===a?void 0:a.typeName)===(null===(i=s.enum)||void 0===i?void 0:i.typeName)}return!0}return!1}function s2(e,t){return sQ(e)&&sX in e&&"desc"in e&&sQ(e.desc)&&"message"===e.desc.kind&&(void 0===t||e.desc.typeName==t.typeName)}function s3(e){let t=e.fields[0];return s9(e.typeName)&&void 0!==t&&"scalar"==t.fieldKind&&"value"==t.name&&1==t.number}function s9(e){return e.startsWith("google.protobuf.")&&["DoubleValue","FloatValue","Int64Value","UInt64Value","Int32Value","UInt32Value","BoolValue","StringValue","BytesValue"].includes(e.substring(16))}function s4(e,t){if(sD(t,e))return t;let n=function(e){let t;if(function(e){switch(e.file.edition){case 999:return!1;case 998:return!0;default:return e.fields.some(e=>2!=e.presence&&"message"!=e.fieldKind&&!e.oneof)}}(e)){let n,r;let a=ot.get(e);if(a)({prototype:n,members:r}=a);else{for(let t of(n={},r=new Set,e.members))"oneof"!=t.kind&&("scalar"==t.fieldKind||"enum"==t.fieldKind)&&2!=t.presence&&(r.add(t),n[t.localName]=on(t));ot.set(e,{prototype:n,members:r})}for(let a of((t=Object.create(n)).$typeName=e.typeName,e.members))r.has(a)||"field"==a.kind&&("message"==a.fieldKind||("scalar"==a.fieldKind||"enum"==a.fieldKind)&&2!=a.presence)||(t[a.localName]=on(a))}else for(let n of(t={$typeName:e.typeName},e.members))("oneof"==n.kind||2==n.presence)&&(t[n.localName]=on(n));return t}(e);return void 0!==t&&function(e,t,n){for(let r of e.members){let e,a=n[r.localName];if(null!=a){if("oneof"==r.kind){let t=sJ(n,r);if(!t)continue;e=t,a=sq(n,t)}else e=r;switch(e.fieldKind){case"message":a=s6(e,a);break;case"scalar":a=s5(e,a);break;case"list":a=function(e,t){if(Array.isArray(t)){if(e.scalar==K.BYTES)return t.map(s8);if("message"==e.listKind)return t.map(t=>s6(e,t))}return t}(e,a);break;case"map":a=function(e,t){if(sQ(t)){if(e.scalar==K.BYTES)return s7(t,s8);if("message"==e.mapKind)return s7(t,t=>s6(e,t))}return t}(e,a)}sH(t,e,a)}}}(e,n,t),n}function s5(e,t){return e.scalar==K.BYTES?s8(t):t}function s6(e,t){if("message"==e.fieldKind&&!e.oneof&&s3(e.message))return s5(e.message.fields[0],t);if(sQ(t)){if("google.protobuf.Struct"==e.message.typeName&&"google.protobuf.Value"!==e.parent.typeName)return t;if(!sD(t,e.message))return s4(e.message,t)}return t}function s8(e){return Array.isArray(e)?new Uint8Array(e):e}function s7(e,t){let n={};for(let r of Object.entries(e))n[r[0]]=t(r[1]);return n}let oe=Symbol(),ot=new WeakMap;function on(e){if("oneof"==e.kind)return{case:void 0};if("list"==e.fieldKind)return[];if("map"==e.fieldKind)return{};if("message"==e.fieldKind)return oe;let t=e.getDefaultValue();return void 0!==t?"scalar"==e.fieldKind&&e.longAsString?t.toString():t:"scalar"==e.fieldKind?sY(e.scalar,e.longAsString):e.enum.values[0].number}let or=["FieldValueInvalidError","FieldListRangeError","ForeignFieldError"];class oa extends Error{constructor(e,t,n="FieldValueInvalidError"){super(t),this.name=n,this.field=()=>e}}let oi=Symbol.for("@bufbuild/protobuf/text-encoding");function os(){if(void 0==globalThis[oi]){let e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[oi]={encodeUtf8:t=>e.encode(t),decodeUtf8:e=>t.decode(e),checkUtf8(e){try{return encodeURIComponent(e),!0}catch(e){return!1}}}}return globalThis[oi]}!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Y||(Y={}));class oo{constructor(e=os().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(oc(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return ou(e),sB(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.encodeUtf8(e);return this.uint32(t.byteLength),this.raw(t)}float(e){(function(e){if("string"==typeof e){let t=e;if(Number.isNaN(e=Number(e))&&"NaN"!==t)throw Error("invalid float32: "+t)}else if("number"!=typeof e)throw Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw Error("invalid float32: "+e)})(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){oc(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){ou(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return ou(e),sB(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=sG.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=sG.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=sG.enc(e);return sj(t.lo,t.hi,this.buf),this}sint64(e){let t=sG.enc(e),n=t.hi>>31;return sj(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=sG.uEnc(e);return sj(t.lo,t.hi,this.buf),this}}class ol{constructor(e,t=os().decodeUtf8){this.decodeUtf8=t,this.varint64=sM,this.uint32=sZ,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case Y.Varint:for(;128&this.buf[this.pos++];);break;case Y.Bit64:this.pos+=4;case Y.Bit32:this.pos+=4;break;case Y.LengthDelimited:let r=this.uint32();this.pos+=r;break;case Y.StartGroup:for(;;){let[e,n]=this.tag();if(n===Y.EndGroup){if(void 0!==t&&e!==t)throw Error("invalid end group tag");break}this.skip(n,e)}break;default:throw Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return sG.dec(...this.varint64())}uint64(){return sG.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,sG.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return sG.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return sG.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.decodeUtf8(this.bytes())}}function ou(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw Error("invalid int32: "+e)}function oc(e){if("string"==typeof e)e=Number(e);else if("number"!=typeof e)throw Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw Error("invalid uint32: "+e)}function od(e,t){let n;let r="list"==e.fieldKind?s0(t,e):"map"==e.fieldKind?s1(t,e):om(e,t);if(!0!==r){switch(e.fieldKind){case"list":n=`expected ${ob(e)}, got ${og(t)}`;break;case"map":n=`expected ${ov(e)}, got ${og(t)}`;break;default:n=of(e,t,r)}return new oa(e,n)}}function op(e,t,n){let r=om(e,n);if(!0!==r)return new oa(e,`list item #${t+1}: ${of(e,n,r)}`)}function om(e,t){return void 0!==e.scalar?oh(t,e.scalar):void 0!==e.enum?e.enum.open?Number.isInteger(t):e.enum.values.some(e=>e.number===t):s2(t,e.message)}function oh(e,t){switch(t){case K.DOUBLE:return"number"==typeof e;case K.FLOAT:if("number"!=typeof e)return!1;if(Number.isNaN(e)||!Number.isFinite(e))return!0;if(e>34028234663852886e22||e<-34028234663852886e22)return`${e.toFixed()} out of range`;return!0;case K.INT32:case K.SFIXED32:case K.SINT32:if("number"!=typeof e||!Number.isInteger(e))return!1;if(e>2147483647||e<-2147483648)return`${e.toFixed()} out of range`;return!0;case K.FIXED32:case K.UINT32:if("number"!=typeof e||!Number.isInteger(e))return!1;if(e>4294967295||e<0)return`${e.toFixed()} out of range`;return!0;case K.BOOL:return"boolean"==typeof e;case K.STRING:if("string"!=typeof e)return!1;return os().checkUtf8(e)||"invalid UTF8";case K.BYTES:return e instanceof Uint8Array;case K.INT64:case K.SFIXED64:case K.SINT64:if("bigint"==typeof e||"number"==typeof e||"string"==typeof e&&e.length>0)try{return sG.parse(e),!0}catch(t){return`${e} out of range`}return!1;case K.FIXED64:case K.UINT64:if("bigint"==typeof e||"number"==typeof e||"string"==typeof e&&e.length>0)try{return sG.uParse(e),!0}catch(t){return`${e} out of range`}return!1}}function of(e,t,n){return(n="string"==typeof n?`: ${n}`:`, got ${og(t)}`,void 0!==e.scalar)?`expected ${function(e){switch(e){case K.STRING:return"string";case K.BOOL:return"boolean";case K.INT64:case K.SINT64:case K.SFIXED64:return"bigint (int64)";case K.UINT64:case K.FIXED64:return"bigint (uint64)";case K.BYTES:return"Uint8Array";case K.DOUBLE:return"number (float64)";case K.FLOAT:return"number (float32)";case K.FIXED32:case K.UINT32:return"number (uint32)";case K.INT32:case K.SFIXED32:case K.SINT32:return"number (int32)"}}(e.scalar)}`+n:void 0!==e.enum?`expected ${e.enum.toString()}`+n:`expected ${oy(e.message)}`+n}function og(e){switch(typeof e){case"object":if(null===e)return"null";if(e instanceof Uint8Array)return`Uint8Array(${e.length})`;if(Array.isArray(e))return`Array(${e.length})`;if(s0(e))return ob(e.field());if(s1(e))return ov(e.field());if(s2(e))return oy(e.desc);if(sD(e))return`message ${e.$typeName}`;return"object";case"string":return e.length>30?"string":`"${e.split('"').join('\\"')}"`;case"boolean":case"number":return String(e);case"bigint":return String(e)+"n";default:return typeof e}}function oy(e){return`ReflectMessage (${e.typeName})`}function ob(e){switch(e.listKind){case"message":return`ReflectList (${e.message.toString()})`;case"enum":return`ReflectList (${e.enum.toString()})`;case"scalar":return`ReflectList (${K[e.scalar]})`}}function ov(e){switch(e.mapKind){case"message":return`ReflectMap (${K[e.mapKey]}, ${e.message.toString()})`;case"enum":return`ReflectMap (${K[e.mapKey]}, ${e.enum.toString()})`;case"scalar":return`ReflectMap (${K[e.mapKey]}, ${K[e.scalar]})`}}function ow(e,t,n=!0){return new oE(e,t,n)}let o_=new WeakMap;class oE{get sortedFields(){let e=o_.get(this.desc);if(e)return e;let t=this.desc.fields.concat().sort((e,t)=>e.number-t.number);return o_.set(this.desc,t),t}constructor(e,t,n=!0){this.lists=new Map,this.maps=new Map,this.check=n,this.desc=e,this.message=this[sX]=null!=t?t:s4(e),this.fields=e.fields,this.oneofs=e.oneofs,this.members=e.members}findNumber(e){return this._fieldsByNumber||(this._fieldsByNumber=new Map(this.desc.fields.map(e=>[e.number,e]))),this._fieldsByNumber.get(e)}oneofCase(e){return oT(this.message,e),sJ(this.message,e)}isSet(e){return oT(this.message,e),function(e,t){let n=t.localName;if(t.oneof)return e[t.oneof.localName].case===n;if(2!=t.presence)return void 0!==e[n]&&Object.prototype.hasOwnProperty.call(e,n);switch(t.fieldKind){case"list":return e[n].length>0;case"map":return Object.keys(e[n]).length>0;case"scalar":return!function(e,t){switch(e){case K.BOOL:return!1===t;case K.STRING:return""===t;case K.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}(t.scalar,e[n]);case"enum":return e[n]!==t.enum.values[0].number}throw Error("message field with implicit presence")}(this.message,e)}clear(e){oT(this.message,e),function(e,t){let n=t.localName;if(t.oneof){let r=t.oneof.localName;e[r].case===n&&(e[r]={case:void 0})}else if(2!=t.presence)delete e[n];else switch(t.fieldKind){case"map":e[n]={};break;case"list":e[n]=[];break;case"enum":e[n]=t.enum.values[0].number;break;case"scalar":e[n]=sY(t.scalar,t.longAsString)}}(this.message,e)}get(e){oT(this.message,e);let t=sq(this.message,e);switch(e.fieldKind){case"list":let n=this.lists.get(e);return n&&n[sX]===t||this.lists.set(e,n=new oA(e,t,this.check)),n;case"map":let r=this.maps.get(e);return r&&r[sX]===t||this.maps.set(e,r=new oI(e,t,this.check)),r;case"message":return oS(e,t,this.check);case"scalar":return void 0===t?sY(e.scalar,!1):oP(e,t);case"enum":return null!=t?t:e.enum.values[0].number}}set(e,t){let n;if(oT(this.message,e),this.check){let n=od(e,t);if(n)throw n}n="message"==e.fieldKind?ox(e,t):s1(t)||s0(t)?t[sX]:oD(e,t),sH(this.message,e,n)}getUnknown(){return this.message.$unknown}setUnknown(e){this.message.$unknown=e}}function oT(e,t){if(t.parent.typeName!==e.$typeName)throw new oa(t,`cannot use ${t.toString()} with message ${e.$typeName}`,"ForeignFieldError")}class oA{field(){return this._field}get size(){return this._arr.length}constructor(e,t,n){this._field=e,this._arr=this[sX]=t,this.check=n}get(e){let t=this._arr[e];return void 0===t?void 0:ok(this._field,t,this.check)}set(e,t){if(e<0||e>=this._arr.length)throw new oa(this._field,`list item #${e+1}: out of range`);if(this.check){let n=op(this._field,e,t);if(n)throw n}this._arr[e]=oN(this._field,t)}add(e){if(this.check){let t=op(this._field,this._arr.length,e);if(t)throw t}this._arr.push(oN(this._field,e))}clear(){this._arr.splice(0,this._arr.length)}[Symbol.iterator](){return this.values()}keys(){return this._arr.keys()}*values(){for(let e of this._arr)yield ok(this._field,e,this.check)}*entries(){for(let e=0;e<this._arr.length;e++)yield[e,ok(this._field,this._arr[e],this.check)]}}class oI{constructor(e,t,n=!0){this.obj=this[sX]=null!=t?t:{},this.check=n,this._field=e}field(){return this._field}set(e,t){var n;if(this.check){let n=function(e,t,n){let r=oh(t,e.mapKey);if(!0!==r)return new oa(e,`invalid map key: ${of({scalar:e.mapKey},t,r)}`);let a=om(e,n);if(!0!==a)return new oa(e,`map entry ${og(t)}: ${of(e,n,a)}`)}(this._field,e,t);if(n)throw n}return this.obj[oO(e)]="message"==(n=this._field).mapKind?ox(n,t):oD(n,t),this}delete(e){let t=oO(e),n=Object.prototype.hasOwnProperty.call(this.obj,t);return n&&delete this.obj[t],n}clear(){for(let e of Object.keys(this.obj))delete this.obj[e]}get(e){let t=this.obj[oO(e)];return void 0!==t&&(t=oR(this._field,t,this.check)),t}has(e){return Object.prototype.hasOwnProperty.call(this.obj,oO(e))}*keys(){for(let e of Object.keys(this.obj))yield oC(e,this._field.mapKey)}*entries(){for(let e of Object.entries(this.obj))yield[oC(e[0],this._field.mapKey),oR(this._field,e[1],this.check)]}[Symbol.iterator](){return this.entries()}get size(){return Object.keys(this.obj).length}*values(){for(let e of Object.values(this.obj))yield oR(this._field,e,this.check)}forEach(e,t){for(let n of this.entries())e.call(t,n[1],n[0],this)}}function ox(e,t){return s2(t)?s9(t.message.$typeName)&&!e.oneof&&"message"==e.fieldKind?t.message.value:"google.protobuf.Struct"==t.desc.typeName&&"google.protobuf.Value"!=e.parent.typeName?function e(t){let n={};for(let[r,a]of Object.entries(t.fields))n[r]=function t(n){switch(n.kind.case){case"structValue":return e(n.kind.value);case"listValue":return n.kind.value.values.map(t);case"nullValue":case void 0:return null;default:return n.kind.value}}(a);return n}(t.message):t.message:t}function oS(e,t,n){return void 0!==t&&(s3(e.message)&&!e.oneof&&"message"==e.fieldKind?t={$typeName:e.message.typeName,value:oP(e.message.fields[0],t)}:"google.protobuf.Struct"==e.message.typeName&&"google.protobuf.Value"!=e.parent.typeName&&sQ(t)&&(t=function e(t){let n={$typeName:"google.protobuf.Struct",fields:{}};if(sQ(t))for(let[r,a]of Object.entries(t))n.fields[r]=function t(n){let r={$typeName:"google.protobuf.Value",kind:{case:void 0}};switch(typeof n){case"number":r.kind={case:"numberValue",value:n};break;case"string":r.kind={case:"stringValue",value:n};break;case"boolean":r.kind={case:"boolValue",value:n};break;case"object":if(null===n)r.kind={case:"nullValue",value:0};else if(Array.isArray(n)){let e={$typeName:"google.protobuf.ListValue",values:[]};if(Array.isArray(n))for(let r of n)e.values.push(t(r));r.kind={case:"listValue",value:e}}else r.kind={case:"structValue",value:e(n)}}return r}(a);return n}(t))),new oE(e.message,t,n)}function oN(e,t){return"message"==e.listKind?ox(e,t):oD(e,t)}function ok(e,t,n){return"message"==e.listKind?oS(e,t,n):oP(e,t)}function oR(e,t,n){return"message"==e.mapKind?oS(e,t,n):t}function oO(e){return"string"==typeof e||"number"==typeof e?e:String(e)}function oC(e,t){switch(t){case K.STRING:break;case K.INT32:case K.FIXED32:case K.UINT32:case K.SFIXED32:case K.SINT32:{let t=Number.parseInt(e);if(Number.isFinite(t))return t;break}case K.BOOL:switch(e){case"true":return!0;case"false":return!1}break;case K.UINT64:case K.FIXED64:try{return sG.uParse(e)}catch(e){}break;default:try{return sG.parse(e)}catch(e){}}return e}function oP(e,t){switch(e.scalar){case K.INT64:case K.SFIXED64:case K.SINT64:"longAsString"in e&&e.longAsString&&"string"==typeof t&&(t=sG.parse(t));break;case K.FIXED64:case K.UINT64:"longAsString"in e&&e.longAsString&&"string"==typeof t&&(t=sG.uParse(t))}return t}function oD(e,t){switch(e.scalar){case K.INT64:case K.SFIXED64:case K.SINT64:"longAsString"in e&&e.longAsString?t=String(t):("string"==typeof t||"number"==typeof t)&&(t=sG.parse(t));break;case K.FIXED64:case K.UINT64:"longAsString"in e&&e.longAsString?t=String(t):("string"==typeof t||"number"==typeof t)&&(t=sG.uParse(t))}return t}let oM={readUnknownFields:!0};function oj(e,t,n){let r=ow(e,void 0,!1);return oF(r,new ol(t),n?Object.assign(Object.assign({},oM),n):oM,!1,t.byteLength),r.message}function oF(e,t,n,r,a){var i;let s,o;let l=r?t.len:t.pos+a,u=null!==(i=e.getUnknown())&&void 0!==i?i:[];for(;t.pos<l&&([s,o]=t.tag(),!r||o!=Y.EndGroup);){let r=e.findNumber(s);if(!r){let e=t.skip(o,s);n.readUnknownFields&&u.push({no:s,wireType:o,data:e});continue}oV(e,t,r,o,n)}if(r&&(o!=Y.EndGroup||s!==a))throw Error("invalid end group tag");u.length>0&&e.setUnknown(u)}function oV(e,t,n,r,a){var i;switch(n.fieldKind){case"scalar":e.set(n,oL(t,n.scalar));break;case"enum":let s=oL(t,K.INT32);if(n.enum.open)e.set(n,s);else if(n.enum.values.some(e=>e.number===s))e.set(n,s);else if(a.readUnknownFields){let t=[];sB(s,t);let a=null!==(i=e.getUnknown())&&void 0!==i?i:[];a.push({no:n.number,wireType:r,data:new Uint8Array(t)}),e.setUnknown(a)}break;case"message":e.set(n,oU(t,a,n,e.get(n)));break;case"list":(function(e,t,n,r){var a;let i=n.field();if("message"===i.listKind){n.add(oU(e,r,i));return}let s=null!==(a=i.scalar)&&void 0!==a?a:K.INT32;if(!(t==Y.LengthDelimited&&s!=K.STRING&&s!=K.BYTES)){n.add(oL(e,s));return}let o=e.uint32()+e.pos;for(;e.pos<o;)n.add(oL(e,s))})(t,r,e.get(n),a);break;case"map":(function(e,t,n){let r,a;let i=t.field(),s=e.uint32(),o=e.pos+s;for(;e.pos<o;){let[t]=e.tag();switch(t){case 1:r=oL(e,i.mapKey);break;case 2:switch(i.mapKind){case"scalar":a=oL(e,i.scalar);break;case"enum":a=e.int32();break;case"message":a=oU(e,n,i)}}}if(void 0===r&&(r=sY(i.mapKey,!1)),void 0===a)switch(i.mapKind){case"scalar":a=sY(i.scalar,!1);break;case"enum":a=i.enum.values[0].number;break;case"message":a=ow(i.message,void 0,!1)}t.set(r,a)})(t,e.get(n),a)}}function oU(e,t,n,r){let a=n.delimitedEncoding,i=null!=r?r:ow(n.message,void 0,!1);return oF(i,e,t,a,a?n.number:e.uint32()),i}function oL(e,t){switch(t){case K.STRING:return e.string();case K.BOOL:return e.bool();case K.DOUBLE:return e.double();case K.FLOAT:return e.float();case K.INT32:return e.int32();case K.INT64:return e.int64();case K.UINT64:return e.uint64();case K.FIXED64:return e.fixed64();case K.BYTES:return e.bytes();case K.FIXED32:return e.fixed32();case K.SFIXED32:return e.sfixed32();case K.SFIXED64:return e.sfixed64();case K.SINT64:return e.sint64();case K.UINT32:return e.uint32();case K.SINT32:return e.sint32()}}function o$(e){let t=W[e];return"string"!=typeof t?e.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,e=>"_"+e.toLowerCase())}class oB extends Error{constructor(e,t=W.Unknown,n,r,a){super(function(e,t){return e.length?`[${o$(t)}] ${e}`:`[${o$(t)}]`}(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(null!=n?n:{}),this.details=null!=r?r:[],this.cause=a}static from(e,t=W.Unknown){return e instanceof oB?e:e instanceof Error?"AbortError"==e.name?new oB(e.message,W.Canceled):new oB(e.message,t,void 0,void 0,e):new oB(String(e),t,void 0,void 0,e)}static[Symbol.hasInstance](e){return e instanceof Error&&(Object.getPrototypeOf(e)===oB.prototype||"ConnectError"===e.name&&"code"in e&&"number"==typeof e.code&&"metadata"in e&&"details"in e&&Array.isArray(e.details)&&"rawMessage"in e&&"string"==typeof e.rawMessage&&"cause"in e)}findDetails(e){let t="message"===e.kind?{getMessage:t=>t===e.typeName?e:void 0}:e,n=[];for(let e of this.details){if("desc"in e){t.getMessage(e.desc.typeName)&&n.push(s4(e.desc,e.value));continue}let r=t.getMessage(e.type);if(r)try{n.push(oj(r,e.value))}catch(e){}}return n}}var oZ=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,a){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,a,(t=e[n](t)).done,t.value)})}}},oG=function(e){return this instanceof oG?(this.v=e,this):new oG(e)},oW=function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),i=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function s(e,t){a[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||o(e,t)})},t&&(r[e]=t(r[e])))}function o(e,t){try{var n;(n=a[e](t)).value instanceof oG?Promise.resolve(n.value.v).then(l,u):c(i[0][2],n)}catch(e){c(i[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),i.shift(),i.length&&o(i[0][0],i[0][1])}},oK=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,a){t[r]=e[r]?function(t){return(n=!n)?{value:oG(e[r](t)),done:!1}:a?a(t):t}:a}},oY=function(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,a){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,a,(t=e[n](t)).done,t.value)})}}},oX=function(e){return this instanceof oX?(this.v=e,this):new oX(e)},oJ=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,a){t[r]=e[r]?function(t){return(n=!n)?{value:oX(e[r](t)),done:!1}:a?a(t):t}:a}},oz=function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),i=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function s(e,t){a[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||o(e,t)})},t&&(r[e]=t(r[e])))}function o(e,t){try{var n;(n=a[e](t)).value instanceof oX?Promise.resolve(n.value.v).then(l,u):c(i[0][2],n)}catch(e){c(i[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),i.shift(),i.length&&o(i[0][0],i[0][1])}};function oq(e,t){return function(e,t){let n={};for(let r of e.methods){let e=t(r);null!=e&&(n[r.localName]=e)}return n}(e,e=>{switch(e.methodKind){case"unary":return async function(n,r){var a,i;let s=await t.unary(e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,n,null==r?void 0:r.contextValues);return null===(a=null==r?void 0:r.onHeader)||void 0===a||a.call(r,s.header),null===(i=null==r?void 0:r.onTrailer)||void 0===i||i.call(r,s.trailer),s.message};case"server_streaming":return function(n,r){return oH(t.stream(e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,function(e){return oW(this,arguments,function*(){yield oG((yield*oK(oZ(e))))})}([n]),null==r?void 0:r.contextValues),r)};case"client_streaming":return async function(n,r){let a;let i=await t.stream(e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,n,null==r?void 0:r.contextValues);null===(d=null==r?void 0:r.onHeader)||void 0===d||d.call(r,i.header);let s=0;try{for(var o,l,u,c,d,p,m,h=!0,f=oY(i.message);!(o=(m=await f.next()).done);h=!0)c=m.value,h=!1,a=c,s++}catch(e){l={error:e}}finally{try{!h&&!o&&(u=f.return)&&await u.call(f)}finally{if(l)throw l.error}}if(!a)throw new oB("protocol error: missing response message",W.Unimplemented);if(s>1)throw new oB("protocol error: received extra messages for client streaming method",W.Unimplemented);return null===(p=null==r?void 0:r.onTrailer)||void 0===p||p.call(r,i.trailer),a};case"bidi_streaming":return function(n,r){return oH(t.stream(e,null==r?void 0:r.signal,null==r?void 0:r.timeoutMs,null==r?void 0:r.headers,n,null==r?void 0:r.contextValues),r)};default:return null}})}function oH(e,t){let n=(function(){return oz(this,arguments,function*(){var n,r;let a=yield oX(e);null===(n=null==t?void 0:t.onHeader)||void 0===n||n.call(t,a.header),yield oX((yield*oJ(oY(a.message)))),null===(r=null==t?void 0:t.onTrailer)||void 0===r||r.call(t,a.trailer)})})()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>n.next()})}}let oQ=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,o0=e=>{if("string"!=typeof e)throw TypeError("Invalid argument expected string");let t=e.match(oQ);if(!t)throw Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},o1=e=>"*"===e||"x"===e||"X"===e,o2=e=>{let t=parseInt(e,10);return isNaN(t)?e:t},o3=(e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t],o9=(e,t)=>{if(o1(e)||o1(t))return 0;let[n,r]=o3(o2(e),o2(t));return n>r?1:n<r?-1:0},o4=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){let r=o9(e[n]||"0",t[n]||"0");if(0!==r)return r}return 0},o5=(e,t)=>{let n=o0(e),r=o0(t),a=n.pop(),i=r.pop(),s=o4(n,r);return 0!==s?s:a&&i?o4(a.split("."),i.split(".")):a||i?a?-1:1:0};function o6(e){let t=function(){if(!o){o=[];let e=o7("std");for(let t=0;t<e.length;t++)o[e[t].charCodeAt(0)]=t;o["-".charCodeAt(0)]=e.indexOf("+"),o["_".charCodeAt(0)]=e.indexOf("/")}return o}(),n=3*e.length/4;"="==e[e.length-2]?n-=2:"="==e[e.length-1]&&(n-=1);let r=new Uint8Array(n),a=0,i=0,s,l=0;for(let n=0;n<e.length;n++){if(void 0===(s=t[e.charCodeAt(n)]))switch(e[n]){case"=":i=0;case"\n":case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string")}switch(i){case 0:l=s,i=1;break;case 1:r[a++]=l<<2|(48&s)>>4,l=s,i=2;break;case 2:r[a++]=(15&l)<<4|(60&s)>>2,l=s,i=3;break;case 3:r[a++]=(3&l)<<6|s,i=0}}if(1==i)throw Error("invalid base64 string");return r.subarray(0,a)}function o8(e,t="std"){let n=o7(t),r="std"==t,a="",i=0,s,o=0;for(let t=0;t<e.length;t++)switch(s=e[t],i){case 0:a+=n[s>>2],o=(3&s)<<4,i=1;break;case 1:a+=n[o|s>>4],o=(15&s)<<2,i=2;break;case 2:a+=n[o|s>>6]+n[63&s],i=0}return i&&(a+=n[o],r&&(a+="=",1==i&&(a+="="))),a}function o7(e){return i||(s=(i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("")).slice(0,-2).concat("-","_")),"url"==e?s:i}function le(e){let t=!1,n=[];for(let r=0;r<e.length;r++){let a=e.charAt(r);switch(a){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(a),t=!1;break;default:t&&(t=!1,a=a.toUpperCase()),n.push(a)}}return n.join("")}let lt=new Set(["constructor","toString","toJSON","valueOf"]);function ln(e){return lt.has(e)?e+"$":e}function lr(e){for(let t of e.field)sz(t,"jsonName")||(t.jsonName=le(t.name));e.nestedType.forEach(lr)}function la(...e){let t=function(){let e=new Map,t=new Map,n=new Map;return{kind:"registry",types:e,extendees:t,[Symbol.iterator]:()=>e.values(),get files(){return n.values()},addFile(e,t,r){if(n.set(e.proto.name,e),!t)for(let t of function* e(t){switch(t.kind){case"file":for(let n of t.messages)yield n,yield*e(n);yield*t.enums,yield*t.services,yield*t.extensions;break;case"message":for(let n of t.nestedMessages)yield n,yield*e(n);yield*t.nestedEnums,yield*t.nestedExtensions}}(e))this.add(t);if(r)for(let n of e.dependencies)this.addFile(n,t,r)},add(n){if("extension"==n.kind){let e=t.get(n.extendee.typeName);e||t.set(n.extendee.typeName,e=new Map),e.set(n.number,n)}e.set(n.typeName,n)},get:t=>e.get(t),getFile:e=>n.get(e),getMessage(t){let n=e.get(t);return(null==n?void 0:n.kind)=="message"?n:void 0},getEnum(t){let n=e.get(t);return(null==n?void 0:n.kind)=="enum"?n:void 0},getExtension(t){let n=e.get(t);return(null==n?void 0:n.kind)=="extension"?n:void 0},getExtensionFor(e,n){var r;return null===(r=t.get(e.typeName))||void 0===r?void 0:r.get(n)},getService(t){let n=e.get(t);return(null==n?void 0:n.kind)=="service"?n:void 0}}}();if(!e.length)return t;if("$typeName"in e[0]&&"google.protobuf.FileDescriptorSet"==e[0].$typeName){for(let n of e[0].file)ls(n,t);return t}if("$typeName"in e[0]){let n=e[0],r=e[1],a=new Set;for(let e of[n,...function e(n){let i=[];for(let e of n.dependency){if(void 0!=t.getFile(e)||a.has(e))continue;let s=r(e);if(!s)throw Error(`Unable to resolve ${e}, imported by ${n.name}`);"kind"in s?t.addFile(s,!1,!0):(a.add(s.name),i.push(s))}return i.concat(...i.map(e))}(n)].reverse())ls(e,t)}else for(let n of e)for(let e of n.files)t.addFile(e);return t}let li={998:{fieldPresence:1,enumType:2,repeatedFieldEncoding:2,utf8Validation:3,messageEncoding:1,jsonFormat:2,enforceNamingStyle:2,defaultSymbolVisibility:1},999:{fieldPresence:2,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:2,defaultSymbolVisibility:1},1e3:{fieldPresence:1,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:2,defaultSymbolVisibility:1},1001:{fieldPresence:1,enumType:1,repeatedFieldEncoding:1,utf8Validation:2,messageEncoding:1,jsonFormat:1,enforceNamingStyle:1,defaultSymbolVisibility:2}};function ls(e,t){var n,r;let a={kind:"file",proto:e,deprecated:null!==(r=null===(n=e.options)||void 0===n?void 0:n.deprecated)&&void 0!==r&&r,edition:function(e){switch(e.syntax){case"":case"proto2":return 998;case"proto3":return 999;case"editions":if(e.edition in li)return e.edition;throw Error(`${e.name}: unsupported edition`);default:throw Error(`${e.name}: unsupported syntax "${e.syntax}"`)}}(e),name:e.name.replace(/\.proto$/,""),dependencies:e.dependency.map(n=>{let r=t.getFile(n);if(!r)throw Error(`Cannot find ${n}, imported by ${e.name}`);return r}),enums:[],messages:[],extensions:[],services:[],toString:()=>`file ${e.name}`},i=new Map,s={get:e=>i.get(e),add(e){var t;lf((null===(t=e.proto.options)||void 0===t?void 0:t.mapEntry)===!0),i.set(e.typeName,e)}};for(let n of e.enumType)lu(n,a,void 0,t);for(let n of e.messageType)(function e(t,n,r,a,i){var s,o,l,u;let c={kind:"message",proto:t,deprecated:null!==(o=null===(s=t.options)||void 0===s?void 0:s.deprecated)&&void 0!==o&&o,file:n,parent:r,name:t.name,typeName:ld(t,r,n),fields:[],field:{},oneofs:[],members:[],nestedEnums:[],nestedMessages:[],nestedExtensions:[],toString(){return`message ${this.typeName}`}};for(let e of((null===(l=t.options)||void 0===l?void 0:l.mapEntry)===!0?i.add(c):((null!==(u=null==r?void 0:r.nestedMessages)&&void 0!==u?u:n.messages).push(c),a.add(c)),t.enumType))lu(e,n,c,a);for(let r of t.nestedType)e(r,n,c,a,i)})(n,a,void 0,t,s);for(let n of e.service)(function(e,t,n){var r,a;let i={kind:"service",proto:e,deprecated:null!==(a=null===(r=e.options)||void 0===r?void 0:r.deprecated)&&void 0!==a&&a,file:t,name:e.name,typeName:ld(e,void 0,t),methods:[],method:{},toString(){return`service ${this.typeName}`}};for(let r of(t.services.push(i),n.add(i),e.method)){let e=function(e,t,n){var r,a,i,s;let o;o=e.clientStreaming&&e.serverStreaming?"bidi_streaming":e.clientStreaming?"client_streaming":e.serverStreaming?"server_streaming":"unary";let l=n.getMessage(lp(e.inputType)),u=n.getMessage(lp(e.outputType));lf(l,`invalid MethodDescriptorProto: input_type ${e.inputType} not found`),lf(u,`invalid MethodDescriptorProto: output_type ${e.inputType} not found`);let c=e.name;return{kind:"rpc",proto:e,deprecated:null!==(a=null===(r=e.options)||void 0===r?void 0:r.deprecated)&&void 0!==a&&a,parent:t,name:c,localName:ln(c.length?ln(c[0].toLowerCase()+c.substring(1)):c),methodKind:o,input:l,output:u,idempotency:null!==(s=null===(i=e.options)||void 0===i?void 0:i.idempotencyLevel)&&void 0!==s?s:0,toString:()=>`rpc ${t.typeName}.${c}`}}(r,i,n);i.methods.push(e),i.method[e.localName]=e}})(n,a,t);for(let e of(lo(a,t),i.values()))ll(e,t,s);for(let e of a.messages)ll(e,t,s),lo(e,t);t.addFile(a,!0)}function lo(e,t){switch(e.kind){case"file":for(let n of e.proto.extension){let r=lc(n,e,t);e.extensions.push(r),t.add(r)}break;case"message":for(let n of e.proto.extension){let r=lc(n,e,t);e.nestedExtensions.push(r),t.add(r)}for(let n of e.nestedMessages)lo(n,t)}}function ll(e,t,n){let r=e.proto.oneofDecl.map(t=>({kind:"oneof",proto:t,deprecated:!1,parent:e,fields:[],name:t.name,localName:ln(le(t.name)),toString(){return`oneof ${e.typeName}.${this.name}`}})),a=new Set;for(let i of e.proto.field){let s=function(e,t){if(!sz(e,"oneofIndex")||e.proto3Optional)return;let n=t[e.oneofIndex];return lf(n,`invalid FieldDescriptorProto: oneof #${e.oneofIndex} for field #${e.number} not found`),n}(i,r),o=lc(i,e,t,s,n);e.fields.push(o),e.field[o.localName]=o,void 0===s?e.members.push(o):(s.fields.push(o),a.has(s)||(a.add(s),e.members.push(s)))}for(let t of r.filter(e=>a.has(e)))e.oneofs.push(t);for(let r of e.nestedMessages)ll(r,t,n)}function lu(e,t,n,r){var a,i,s,o,l,u;let c=function(e,t){let n=(e.substring(0,1)+e.substring(1).replace(/[A-Z]/g,e=>"_"+e)).toLowerCase()+"_";for(let e of t){if(!e.name.toLowerCase().startsWith(n))return;let t=e.name.substring(n.length);if(0==t.length||/^\d/.test(t))return}return n}(e.name,e.value),d={kind:"enum",proto:e,deprecated:null!==(i=null===(a=e.options)||void 0===a?void 0:a.deprecated)&&void 0!==i&&i,file:t,parent:n,open:!0,name:e.name,typeName:ld(e,n,t),value:{},values:[],sharedPrefix:c,toString(){return`enum ${this.typeName}`}};for(let t of(d.open=1==lh("enumType",{proto:d.proto,parent:null!==(u=d.parent)&&void 0!==u?u:d.file}),r.add(d),e.value)){let e=t.name;d.values.push(d.value[t.number]={kind:"enum_value",proto:t,deprecated:null!==(o=null===(s=t.options)||void 0===s?void 0:s.deprecated)&&void 0!==o&&o,parent:d,name:e,localName:ln(void 0==c?e:e.substring(c.length)),number:t.number,toString:()=>`enum value ${d.typeName}.${e}`})}(null!==(l=null==n?void 0:n.nestedEnums)&&void 0!==l?l:t.enums).push(d)}function lc(e,t,n,r,a){var i,s,o;let l=void 0===a,u={kind:"field",proto:e,deprecated:null!==(s=null===(i=e.options)||void 0===i?void 0:i.deprecated)&&void 0!==s&&s,name:e.name,number:e.number,scalar:void 0,message:void 0,enum:void 0,presence:function(e,t,n,r){if(2==e.label)return 3;if(3==e.label)return 2;if(t||e.proto3Optional||n)return 1;let a=lh("fieldPresence",{proto:e,parent:r});return 2==a&&(11==e.type||10==e.type)?1:a}(e,r,l,t),listKind:void 0,mapKind:void 0,mapKey:void 0,delimitedEncoding:void 0,packed:void 0,longAsString:!1,getDefaultValue:void 0};if(l){let r="file"==t.kind?t:t.file,a="file"==t.kind?void 0:t,i=ld(e,a,r);u.kind="extension",u.file=r,u.parent=a,u.oneof=void 0,u.typeName=i,u.jsonName=`[${i}]`,u.toString=()=>`extension ${i}`;let s=n.getMessage(lp(e.extendee));lf(s,`invalid FieldDescriptorProto: extendee ${e.extendee} not found`),u.extendee=s}else lf("message"==t.kind),u.parent=t,u.oneof=r,u.localName=r?le(e.name):ln(le(e.name)),u.jsonName=e.jsonName,u.toString=()=>`field ${t.typeName}.${e.name}`;let c=e.label,d=e.type,p=null===(o=e.options)||void 0===o?void 0:o.jstype;if(3===c){let r=11==d?null==a?void 0:a.get(lp(e.typeName)):void 0;if(r){u.fieldKind="map";let{key:e,value:t}=function(e){let t=e.fields.find(e=>1===e.number),n=e.fields.find(e=>2===e.number);return lf(t&&"scalar"==t.fieldKind&&t.scalar!=K.BYTES&&t.scalar!=K.FLOAT&&t.scalar!=K.DOUBLE&&n&&"list"!=n.fieldKind&&"map"!=n.fieldKind),{key:t,value:n}}(r);return u.mapKey=e.scalar,u.mapKind=t.fieldKind,u.message=t.message,u.delimitedEncoding=!1,u.enum=t.enum,u.scalar=t.scalar,u}switch(u.fieldKind="list",d){case 11:case 10:u.listKind="message",u.message=n.getMessage(lp(e.typeName)),lf(u.message),u.delimitedEncoding=lm(e,t);break;case 14:u.listKind="enum",u.enum=n.getEnum(lp(e.typeName)),lf(u.enum);break;default:u.listKind="scalar",u.scalar=d,u.longAsString=1==p}return u.packed=function(e,t){if(3!=e.label)return!1;switch(e.type){case 9:case 12:case 10:case 11:return!1}let n=e.options;return n&&sz(n,"packed")?n.packed:1==lh("repeatedFieldEncoding",{proto:e,parent:t})}(e,t),u}switch(d){case 11:case 10:u.fieldKind="message",u.message=n.getMessage(lp(e.typeName)),lf(u.message,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),u.delimitedEncoding=lm(e,t),u.getDefaultValue=()=>void 0;break;case 14:{let t=n.getEnum(lp(e.typeName));lf(void 0!==t,`invalid FieldDescriptorProto: type_name ${e.typeName} not found`),u.fieldKind="enum",u.enum=n.getEnum(lp(e.typeName)),u.getDefaultValue=()=>sz(e,"defaultValue")?function(e,t){let n=e.values.find(e=>e.name===t);if(!n)throw Error(`cannot parse ${e} default value: ${t}`);return n.number}(t,e.defaultValue):void 0;break}default:u.fieldKind="scalar",u.scalar=d,u.longAsString=1==p,u.getDefaultValue=()=>sz(e,"defaultValue")?function(e,t){switch(e){case K.STRING:return t;case K.BYTES:{let n=function(e){let t=[],n={tail:e,c:"",next(){return 0!=this.tail.length&&(this.c=this.tail[0],this.tail=this.tail.substring(1),!0)},take(e){if(this.tail.length>=e){let t=this.tail.substring(0,e);return this.tail=this.tail.substring(e),t}return!1}};for(;n.next();)if("\\"===n.c){if(n.next())switch(n.c){case"\\":t.push(n.c.charCodeAt(0));break;case"b":t.push(8);break;case"f":t.push(12);break;case"n":t.push(10);break;case"r":t.push(13);break;case"t":t.push(9);break;case"v":t.push(11);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{let e=n.c,r=n.take(2);if(!1===r)return!1;let a=parseInt(e+r,8);if(Number.isNaN(a))return!1;t.push(a);break}case"x":{let e=n.c,r=n.take(2);if(!1===r)return!1;let a=parseInt(e+r,16);if(Number.isNaN(a))return!1;t.push(a);break}case"u":{let e=n.c,r=n.take(4);if(!1===r)return!1;let a=parseInt(e+r,16);if(Number.isNaN(a))return!1;let i=new Uint8Array(4);new DataView(i.buffer).setInt32(0,a,!0),t.push(i[0],i[1],i[2],i[3]);break}case"U":{let e=n.c,r=n.take(8);if(!1===r)return!1;let a=sG.uEnc(e+r),i=new Uint8Array(8),s=new DataView(i.buffer);s.setInt32(0,a.lo,!0),s.setInt32(4,a.hi,!0),t.push(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7])}}}else t.push(n.c.charCodeAt(0));return new Uint8Array(t)}(t);if(!1===n)throw Error(`cannot parse ${K[e]} default value: ${t}`);return n}case K.INT64:case K.SFIXED64:case K.SINT64:return sG.parse(t);case K.UINT64:case K.FIXED64:return sG.uParse(t);case K.DOUBLE:case K.FLOAT:switch(t){case"inf":return Number.POSITIVE_INFINITY;case"-inf":return Number.NEGATIVE_INFINITY;case"nan":return Number.NaN;default:return parseFloat(t)}case K.BOOL:return"true"===t;case K.INT32:case K.UINT32:case K.SINT32:case K.FIXED32:case K.SFIXED32:return parseInt(t,10)}}(d,e.defaultValue):void 0}return u}function ld(e,t,n){return t?`${t.typeName}.${e.name}`:n.proto.package.length>0?`${n.proto.package}.${e.name}`:`${e.name}`}function lp(e){return e.startsWith(".")?e.substring(1):e}function lm(e,t){return 10==e.type||2==lh("messageEncoding",{proto:e,parent:t})}function lh(e,t){var n,r;let a=null===(n=t.proto.options)||void 0===n?void 0:n.features;if(a){let t=a[e];if(0!=t)return t}if("kind"in t){if("message"==t.kind)return lh(e,null!==(r=t.parent)&&void 0!==r?r:t.file);let n=li[t.edition];if(!n)throw Error(`feature default for edition ${t.edition} not found`);return n[e]}return lh(e,t.parent)}function lf(e,t){if(!e)throw Error(t)}function lg(e){var t,n,r,a,i,s,o,l;return Object.assign(Object.create({visibility:0}),{$typeName:"google.protobuf.DescriptorProto",name:e.name,field:null!==(n=null===(t=e.field)||void 0===t?void 0:t.map(ly))&&void 0!==n?n:[],extension:[],nestedType:null!==(a=null===(r=e.nestedType)||void 0===r?void 0:r.map(lg))&&void 0!==a?a:[],enumType:null!==(s=null===(i=e.enumType)||void 0===i?void 0:i.map(lb))&&void 0!==s?s:[],extensionRange:null!==(l=null===(o=e.extensionRange)||void 0===o?void 0:o.map(e=>Object.assign({$typeName:"google.protobuf.DescriptorProto.ExtensionRange"},e)))&&void 0!==l?l:[],oneofDecl:[],reservedRange:[],reservedName:[]})}function ly(e){var t,n,r,a;return Object.assign(Object.create({label:1,typeName:"",extendee:"",defaultValue:"",oneofIndex:0,jsonName:"",proto3Optional:!1}),Object.assign(Object.assign({$typeName:"google.protobuf.FieldDescriptorProto"},e),{options:e.options?(t=e.options,Object.assign(Object.create({ctype:0,packed:!1,jstype:0,lazy:!1,unverifiedLazy:!1,deprecated:!1,weak:!1,debugRedact:!1,retention:0}),Object.assign(Object.assign({$typeName:"google.protobuf.FieldOptions"},t),{targets:null!==(n=t.targets)&&void 0!==n?n:[],editionDefaults:null!==(a=null===(r=t.editionDefaults)||void 0===r?void 0:r.map(e=>Object.assign({$typeName:"google.protobuf.FieldOptions.EditionDefault"},e)))&&void 0!==a?a:[],uninterpretedOption:[]}))):void 0}))}function lb(e){return Object.assign(Object.create({visibility:0}),{$typeName:"google.protobuf.EnumDescriptorProto",name:e.name,reservedName:[],reservedRange:[],value:e.value.map(e=>Object.assign({$typeName:"google.protobuf.EnumValueDescriptorProto"},e))})}function lv(e,t,...n){return n.reduce((e,t)=>e.nestedMessages[t],e.messages[t])}let lw=lv(function(e){let t=Object.assign(Object.create({syntax:"",edition:0}),Object.assign(Object.assign({$typeName:"google.protobuf.FileDescriptorProto",dependency:[],publicDependency:[],weakDependency:[],optionDependency:[],service:[],extension:[]},e),{messageType:e.messageType.map(lg),enumType:e.enumType.map(lb)}));return t.messageType.forEach(lr),la(t,()=>void 0).getFile(t.name)}({name:"google/protobuf/descriptor.proto",package:"google.protobuf",messageType:[{name:"FileDescriptorSet",field:[{name:"file",number:1,type:11,label:3,typeName:".google.protobuf.FileDescriptorProto"}],extensionRange:[{start:536e6,end:536000001}]},{name:"FileDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"package",number:2,type:9,label:1},{name:"dependency",number:3,type:9,label:3},{name:"public_dependency",number:10,type:5,label:3},{name:"weak_dependency",number:11,type:5,label:3},{name:"option_dependency",number:15,type:9,label:3},{name:"message_type",number:4,type:11,label:3,typeName:".google.protobuf.DescriptorProto"},{name:"enum_type",number:5,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto"},{name:"service",number:6,type:11,label:3,typeName:".google.protobuf.ServiceDescriptorProto"},{name:"extension",number:7,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"options",number:8,type:11,label:1,typeName:".google.protobuf.FileOptions"},{name:"source_code_info",number:9,type:11,label:1,typeName:".google.protobuf.SourceCodeInfo"},{name:"syntax",number:12,type:9,label:1},{name:"edition",number:14,type:14,label:1,typeName:".google.protobuf.Edition"}]},{name:"DescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"field",number:2,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"extension",number:6,type:11,label:3,typeName:".google.protobuf.FieldDescriptorProto"},{name:"nested_type",number:3,type:11,label:3,typeName:".google.protobuf.DescriptorProto"},{name:"enum_type",number:4,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto"},{name:"extension_range",number:5,type:11,label:3,typeName:".google.protobuf.DescriptorProto.ExtensionRange"},{name:"oneof_decl",number:8,type:11,label:3,typeName:".google.protobuf.OneofDescriptorProto"},{name:"options",number:7,type:11,label:1,typeName:".google.protobuf.MessageOptions"},{name:"reserved_range",number:9,type:11,label:3,typeName:".google.protobuf.DescriptorProto.ReservedRange"},{name:"reserved_name",number:10,type:9,label:3},{name:"visibility",number:11,type:14,label:1,typeName:".google.protobuf.SymbolVisibility"}],nestedType:[{name:"ExtensionRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.ExtensionRangeOptions"}]},{name:"ReservedRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1}]}]},{name:"ExtensionRangeOptions",field:[{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"},{name:"declaration",number:2,type:11,label:3,typeName:".google.protobuf.ExtensionRangeOptions.Declaration",options:{retention:2}},{name:"features",number:50,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"verification",number:3,type:14,label:1,typeName:".google.protobuf.ExtensionRangeOptions.VerificationState",defaultValue:"UNVERIFIED",options:{retention:2}}],nestedType:[{name:"Declaration",field:[{name:"number",number:1,type:5,label:1},{name:"full_name",number:2,type:9,label:1},{name:"type",number:3,type:9,label:1},{name:"reserved",number:5,type:8,label:1},{name:"repeated",number:6,type:8,label:1}]}],enumType:[{name:"VerificationState",value:[{name:"DECLARATION",number:0},{name:"UNVERIFIED",number:1}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"FieldDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"number",number:3,type:5,label:1},{name:"label",number:4,type:14,label:1,typeName:".google.protobuf.FieldDescriptorProto.Label"},{name:"type",number:5,type:14,label:1,typeName:".google.protobuf.FieldDescriptorProto.Type"},{name:"type_name",number:6,type:9,label:1},{name:"extendee",number:2,type:9,label:1},{name:"default_value",number:7,type:9,label:1},{name:"oneof_index",number:9,type:5,label:1},{name:"json_name",number:10,type:9,label:1},{name:"options",number:8,type:11,label:1,typeName:".google.protobuf.FieldOptions"},{name:"proto3_optional",number:17,type:8,label:1}],enumType:[{name:"Type",value:[{name:"TYPE_DOUBLE",number:1},{name:"TYPE_FLOAT",number:2},{name:"TYPE_INT64",number:3},{name:"TYPE_UINT64",number:4},{name:"TYPE_INT32",number:5},{name:"TYPE_FIXED64",number:6},{name:"TYPE_FIXED32",number:7},{name:"TYPE_BOOL",number:8},{name:"TYPE_STRING",number:9},{name:"TYPE_GROUP",number:10},{name:"TYPE_MESSAGE",number:11},{name:"TYPE_BYTES",number:12},{name:"TYPE_UINT32",number:13},{name:"TYPE_ENUM",number:14},{name:"TYPE_SFIXED32",number:15},{name:"TYPE_SFIXED64",number:16},{name:"TYPE_SINT32",number:17},{name:"TYPE_SINT64",number:18}]},{name:"Label",value:[{name:"LABEL_OPTIONAL",number:1},{name:"LABEL_REPEATED",number:3},{name:"LABEL_REQUIRED",number:2}]}]},{name:"OneofDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"options",number:2,type:11,label:1,typeName:".google.protobuf.OneofOptions"}]},{name:"EnumDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"value",number:2,type:11,label:3,typeName:".google.protobuf.EnumValueDescriptorProto"},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.EnumOptions"},{name:"reserved_range",number:4,type:11,label:3,typeName:".google.protobuf.EnumDescriptorProto.EnumReservedRange"},{name:"reserved_name",number:5,type:9,label:3},{name:"visibility",number:6,type:14,label:1,typeName:".google.protobuf.SymbolVisibility"}],nestedType:[{name:"EnumReservedRange",field:[{name:"start",number:1,type:5,label:1},{name:"end",number:2,type:5,label:1}]}]},{name:"EnumValueDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"number",number:2,type:5,label:1},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.EnumValueOptions"}]},{name:"ServiceDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"method",number:2,type:11,label:3,typeName:".google.protobuf.MethodDescriptorProto"},{name:"options",number:3,type:11,label:1,typeName:".google.protobuf.ServiceOptions"}]},{name:"MethodDescriptorProto",field:[{name:"name",number:1,type:9,label:1},{name:"input_type",number:2,type:9,label:1},{name:"output_type",number:3,type:9,label:1},{name:"options",number:4,type:11,label:1,typeName:".google.protobuf.MethodOptions"},{name:"client_streaming",number:5,type:8,label:1,defaultValue:"false"},{name:"server_streaming",number:6,type:8,label:1,defaultValue:"false"}]},{name:"FileOptions",field:[{name:"java_package",number:1,type:9,label:1},{name:"java_outer_classname",number:8,type:9,label:1},{name:"java_multiple_files",number:10,type:8,label:1,defaultValue:"false"},{name:"java_generate_equals_and_hash",number:20,type:8,label:1,options:{deprecated:!0}},{name:"java_string_check_utf8",number:27,type:8,label:1,defaultValue:"false"},{name:"optimize_for",number:9,type:14,label:1,typeName:".google.protobuf.FileOptions.OptimizeMode",defaultValue:"SPEED"},{name:"go_package",number:11,type:9,label:1},{name:"cc_generic_services",number:16,type:8,label:1,defaultValue:"false"},{name:"java_generic_services",number:17,type:8,label:1,defaultValue:"false"},{name:"py_generic_services",number:18,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:23,type:8,label:1,defaultValue:"false"},{name:"cc_enable_arenas",number:31,type:8,label:1,defaultValue:"true"},{name:"objc_class_prefix",number:36,type:9,label:1},{name:"csharp_namespace",number:37,type:9,label:1},{name:"swift_prefix",number:39,type:9,label:1},{name:"php_class_prefix",number:40,type:9,label:1},{name:"php_namespace",number:41,type:9,label:1},{name:"php_metadata_namespace",number:44,type:9,label:1},{name:"ruby_package",number:45,type:9,label:1},{name:"features",number:50,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],enumType:[{name:"OptimizeMode",value:[{name:"SPEED",number:1},{name:"CODE_SIZE",number:2},{name:"LITE_RUNTIME",number:3}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"MessageOptions",field:[{name:"message_set_wire_format",number:1,type:8,label:1,defaultValue:"false"},{name:"no_standard_descriptor_accessor",number:2,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"map_entry",number:7,type:8,label:1},{name:"deprecated_legacy_json_field_conflicts",number:11,type:8,label:1,options:{deprecated:!0}},{name:"features",number:12,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"FieldOptions",field:[{name:"ctype",number:1,type:14,label:1,typeName:".google.protobuf.FieldOptions.CType",defaultValue:"STRING"},{name:"packed",number:2,type:8,label:1},{name:"jstype",number:6,type:14,label:1,typeName:".google.protobuf.FieldOptions.JSType",defaultValue:"JS_NORMAL"},{name:"lazy",number:5,type:8,label:1,defaultValue:"false"},{name:"unverified_lazy",number:15,type:8,label:1,defaultValue:"false"},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"weak",number:10,type:8,label:1,defaultValue:"false",options:{deprecated:!0}},{name:"debug_redact",number:16,type:8,label:1,defaultValue:"false"},{name:"retention",number:17,type:14,label:1,typeName:".google.protobuf.FieldOptions.OptionRetention"},{name:"targets",number:19,type:14,label:3,typeName:".google.protobuf.FieldOptions.OptionTargetType"},{name:"edition_defaults",number:20,type:11,label:3,typeName:".google.protobuf.FieldOptions.EditionDefault"},{name:"features",number:21,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"feature_support",number:22,type:11,label:1,typeName:".google.protobuf.FieldOptions.FeatureSupport"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],nestedType:[{name:"EditionDefault",field:[{name:"edition",number:3,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"value",number:2,type:9,label:1}]},{name:"FeatureSupport",field:[{name:"edition_introduced",number:1,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"edition_deprecated",number:2,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"deprecation_warning",number:3,type:9,label:1},{name:"edition_removed",number:4,type:14,label:1,typeName:".google.protobuf.Edition"}]}],enumType:[{name:"CType",value:[{name:"STRING",number:0},{name:"CORD",number:1},{name:"STRING_PIECE",number:2}]},{name:"JSType",value:[{name:"JS_NORMAL",number:0},{name:"JS_STRING",number:1},{name:"JS_NUMBER",number:2}]},{name:"OptionRetention",value:[{name:"RETENTION_UNKNOWN",number:0},{name:"RETENTION_RUNTIME",number:1},{name:"RETENTION_SOURCE",number:2}]},{name:"OptionTargetType",value:[{name:"TARGET_TYPE_UNKNOWN",number:0},{name:"TARGET_TYPE_FILE",number:1},{name:"TARGET_TYPE_EXTENSION_RANGE",number:2},{name:"TARGET_TYPE_MESSAGE",number:3},{name:"TARGET_TYPE_FIELD",number:4},{name:"TARGET_TYPE_ONEOF",number:5},{name:"TARGET_TYPE_ENUM",number:6},{name:"TARGET_TYPE_ENUM_ENTRY",number:7},{name:"TARGET_TYPE_SERVICE",number:8},{name:"TARGET_TYPE_METHOD",number:9}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"OneofOptions",field:[{name:"features",number:1,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"EnumOptions",field:[{name:"allow_alias",number:2,type:8,label:1},{name:"deprecated",number:3,type:8,label:1,defaultValue:"false"},{name:"deprecated_legacy_json_field_conflicts",number:6,type:8,label:1,options:{deprecated:!0}},{name:"features",number:7,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"EnumValueOptions",field:[{name:"deprecated",number:1,type:8,label:1,defaultValue:"false"},{name:"features",number:2,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"debug_redact",number:3,type:8,label:1,defaultValue:"false"},{name:"feature_support",number:4,type:11,label:1,typeName:".google.protobuf.FieldOptions.FeatureSupport"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"ServiceOptions",field:[{name:"features",number:34,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"deprecated",number:33,type:8,label:1,defaultValue:"false"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],extensionRange:[{start:1e3,end:536870912}]},{name:"MethodOptions",field:[{name:"deprecated",number:33,type:8,label:1,defaultValue:"false"},{name:"idempotency_level",number:34,type:14,label:1,typeName:".google.protobuf.MethodOptions.IdempotencyLevel",defaultValue:"IDEMPOTENCY_UNKNOWN"},{name:"features",number:35,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"uninterpreted_option",number:999,type:11,label:3,typeName:".google.protobuf.UninterpretedOption"}],enumType:[{name:"IdempotencyLevel",value:[{name:"IDEMPOTENCY_UNKNOWN",number:0},{name:"NO_SIDE_EFFECTS",number:1},{name:"IDEMPOTENT",number:2}]}],extensionRange:[{start:1e3,end:536870912}]},{name:"UninterpretedOption",field:[{name:"name",number:2,type:11,label:3,typeName:".google.protobuf.UninterpretedOption.NamePart"},{name:"identifier_value",number:3,type:9,label:1},{name:"positive_int_value",number:4,type:4,label:1},{name:"negative_int_value",number:5,type:3,label:1},{name:"double_value",number:6,type:1,label:1},{name:"string_value",number:7,type:12,label:1},{name:"aggregate_value",number:8,type:9,label:1}],nestedType:[{name:"NamePart",field:[{name:"name_part",number:1,type:9,label:2},{name:"is_extension",number:2,type:8,label:2}]}]},{name:"FeatureSet",field:[{name:"field_presence",number:1,type:14,label:1,typeName:".google.protobuf.FeatureSet.FieldPresence",options:{retention:1,targets:[4,1],editionDefaults:[{value:"EXPLICIT",edition:900},{value:"IMPLICIT",edition:999},{value:"EXPLICIT",edition:1e3}]}},{name:"enum_type",number:2,type:14,label:1,typeName:".google.protobuf.FeatureSet.EnumType",options:{retention:1,targets:[6,1],editionDefaults:[{value:"CLOSED",edition:900},{value:"OPEN",edition:999}]}},{name:"repeated_field_encoding",number:3,type:14,label:1,typeName:".google.protobuf.FeatureSet.RepeatedFieldEncoding",options:{retention:1,targets:[4,1],editionDefaults:[{value:"EXPANDED",edition:900},{value:"PACKED",edition:999}]}},{name:"utf8_validation",number:4,type:14,label:1,typeName:".google.protobuf.FeatureSet.Utf8Validation",options:{retention:1,targets:[4,1],editionDefaults:[{value:"NONE",edition:900},{value:"VERIFY",edition:999}]}},{name:"message_encoding",number:5,type:14,label:1,typeName:".google.protobuf.FeatureSet.MessageEncoding",options:{retention:1,targets:[4,1],editionDefaults:[{value:"LENGTH_PREFIXED",edition:900}]}},{name:"json_format",number:6,type:14,label:1,typeName:".google.protobuf.FeatureSet.JsonFormat",options:{retention:1,targets:[3,6,1],editionDefaults:[{value:"LEGACY_BEST_EFFORT",edition:900},{value:"ALLOW",edition:999}]}},{name:"enforce_naming_style",number:7,type:14,label:1,typeName:".google.protobuf.FeatureSet.EnforceNamingStyle",options:{retention:2,targets:[1,2,3,4,5,6,7,8,9],editionDefaults:[{value:"STYLE_LEGACY",edition:900},{value:"STYLE2024",edition:1001}]}},{name:"default_symbol_visibility",number:8,type:14,label:1,typeName:".google.protobuf.FeatureSet.VisibilityFeature.DefaultSymbolVisibility",options:{retention:2,targets:[1],editionDefaults:[{value:"EXPORT_ALL",edition:900},{value:"EXPORT_TOP_LEVEL",edition:1001}]}}],nestedType:[{name:"VisibilityFeature",enumType:[{name:"DefaultSymbolVisibility",value:[{name:"DEFAULT_SYMBOL_VISIBILITY_UNKNOWN",number:0},{name:"EXPORT_ALL",number:1},{name:"EXPORT_TOP_LEVEL",number:2},{name:"LOCAL_ALL",number:3},{name:"STRICT",number:4}]}]}],enumType:[{name:"FieldPresence",value:[{name:"FIELD_PRESENCE_UNKNOWN",number:0},{name:"EXPLICIT",number:1},{name:"IMPLICIT",number:2},{name:"LEGACY_REQUIRED",number:3}]},{name:"EnumType",value:[{name:"ENUM_TYPE_UNKNOWN",number:0},{name:"OPEN",number:1},{name:"CLOSED",number:2}]},{name:"RepeatedFieldEncoding",value:[{name:"REPEATED_FIELD_ENCODING_UNKNOWN",number:0},{name:"PACKED",number:1},{name:"EXPANDED",number:2}]},{name:"Utf8Validation",value:[{name:"UTF8_VALIDATION_UNKNOWN",number:0},{name:"VERIFY",number:2},{name:"NONE",number:3}]},{name:"MessageEncoding",value:[{name:"MESSAGE_ENCODING_UNKNOWN",number:0},{name:"LENGTH_PREFIXED",number:1},{name:"DELIMITED",number:2}]},{name:"JsonFormat",value:[{name:"JSON_FORMAT_UNKNOWN",number:0},{name:"ALLOW",number:1},{name:"LEGACY_BEST_EFFORT",number:2}]},{name:"EnforceNamingStyle",value:[{name:"ENFORCE_NAMING_STYLE_UNKNOWN",number:0},{name:"STYLE2024",number:1},{name:"STYLE_LEGACY",number:2}]}],extensionRange:[{start:1e3,end:9995},{start:9995,end:1e4},{start:1e4,end:10001}]},{name:"FeatureSetDefaults",field:[{name:"defaults",number:1,type:11,label:3,typeName:".google.protobuf.FeatureSetDefaults.FeatureSetEditionDefault"},{name:"minimum_edition",number:4,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"maximum_edition",number:5,type:14,label:1,typeName:".google.protobuf.Edition"}],nestedType:[{name:"FeatureSetEditionDefault",field:[{name:"edition",number:3,type:14,label:1,typeName:".google.protobuf.Edition"},{name:"overridable_features",number:4,type:11,label:1,typeName:".google.protobuf.FeatureSet"},{name:"fixed_features",number:5,type:11,label:1,typeName:".google.protobuf.FeatureSet"}]}]},{name:"SourceCodeInfo",field:[{name:"location",number:1,type:11,label:3,typeName:".google.protobuf.SourceCodeInfo.Location"}],nestedType:[{name:"Location",field:[{name:"path",number:1,type:5,label:3,options:{packed:!0}},{name:"span",number:2,type:5,label:3,options:{packed:!0}},{name:"leading_comments",number:3,type:9,label:1},{name:"trailing_comments",number:4,type:9,label:1},{name:"leading_detached_comments",number:6,type:9,label:3}]}],extensionRange:[{start:536e6,end:536000001}]},{name:"GeneratedCodeInfo",field:[{name:"annotation",number:1,type:11,label:3,typeName:".google.protobuf.GeneratedCodeInfo.Annotation"}],nestedType:[{name:"Annotation",field:[{name:"path",number:1,type:5,label:3,options:{packed:!0}},{name:"source_file",number:2,type:9,label:1},{name:"begin",number:3,type:5,label:1},{name:"end",number:4,type:5,label:1},{name:"semantic",number:5,type:14,label:1,typeName:".google.protobuf.GeneratedCodeInfo.Annotation.Semantic"}],enumType:[{name:"Semantic",value:[{name:"NONE",number:0},{name:"SET",number:1},{name:"ALIAS",number:2}]}]}]}],enumType:[{name:"Edition",value:[{name:"EDITION_UNKNOWN",number:0},{name:"EDITION_LEGACY",number:900},{name:"EDITION_PROTO2",number:998},{name:"EDITION_PROTO3",number:999},{name:"EDITION_2023",number:1e3},{name:"EDITION_2024",number:1001},{name:"EDITION_UNSTABLE",number:9999},{name:"EDITION_1_TEST_ONLY",number:1},{name:"EDITION_2_TEST_ONLY",number:2},{name:"EDITION_99997_TEST_ONLY",number:99997},{name:"EDITION_99998_TEST_ONLY",number:99998},{name:"EDITION_99999_TEST_ONLY",number:99999},{name:"EDITION_MAX",number:2147483647}]},{name:"SymbolVisibility",value:[{name:"VISIBILITY_UNSET",number:0},{name:"VISIBILITY_LOCAL",number:1},{name:"VISIBILITY_EXPORT",number:2}]}]}),1);function l_(e,t){var n;let r=oj(lw,o6(e));return r.messageType.forEach(lr),r.dependency=null!==(n=null==t?void 0:t.map(e=>e.proto.name))&&void 0!==n?n:[],la(r,e=>null==t?void 0:t.find(t=>t.proto.name===e)).getFile(r.name)}function lE(e,t,...n){if(n.length>0)throw Error();return e.services[t]}(function(e){e[e.DECLARATION=0]="DECLARATION",e[e.UNVERIFIED=1]="UNVERIFIED"})(X||(X={})),function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.GROUP=10]="GROUP",e[e.MESSAGE=11]="MESSAGE",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.ENUM=14]="ENUM",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(J||(J={})),function(e){e[e.OPTIONAL=1]="OPTIONAL",e[e.REPEATED=3]="REPEATED",e[e.REQUIRED=2]="REQUIRED"}(z||(z={})),function(e){e[e.SPEED=1]="SPEED",e[e.CODE_SIZE=2]="CODE_SIZE",e[e.LITE_RUNTIME=3]="LITE_RUNTIME"}(q||(q={})),function(e){e[e.STRING=0]="STRING",e[e.CORD=1]="CORD",e[e.STRING_PIECE=2]="STRING_PIECE"}(H||(H={})),function(e){e[e.JS_NORMAL=0]="JS_NORMAL",e[e.JS_STRING=1]="JS_STRING",e[e.JS_NUMBER=2]="JS_NUMBER"}(Q||(Q={})),function(e){e[e.RETENTION_UNKNOWN=0]="RETENTION_UNKNOWN",e[e.RETENTION_RUNTIME=1]="RETENTION_RUNTIME",e[e.RETENTION_SOURCE=2]="RETENTION_SOURCE"}(ee||(ee={})),function(e){e[e.TARGET_TYPE_UNKNOWN=0]="TARGET_TYPE_UNKNOWN",e[e.TARGET_TYPE_FILE=1]="TARGET_TYPE_FILE",e[e.TARGET_TYPE_EXTENSION_RANGE=2]="TARGET_TYPE_EXTENSION_RANGE",e[e.TARGET_TYPE_MESSAGE=3]="TARGET_TYPE_MESSAGE",e[e.TARGET_TYPE_FIELD=4]="TARGET_TYPE_FIELD",e[e.TARGET_TYPE_ONEOF=5]="TARGET_TYPE_ONEOF",e[e.TARGET_TYPE_ENUM=6]="TARGET_TYPE_ENUM",e[e.TARGET_TYPE_ENUM_ENTRY=7]="TARGET_TYPE_ENUM_ENTRY",e[e.TARGET_TYPE_SERVICE=8]="TARGET_TYPE_SERVICE",e[e.TARGET_TYPE_METHOD=9]="TARGET_TYPE_METHOD"}(et||(et={})),function(e){e[e.IDEMPOTENCY_UNKNOWN=0]="IDEMPOTENCY_UNKNOWN",e[e.NO_SIDE_EFFECTS=1]="NO_SIDE_EFFECTS",e[e.IDEMPOTENT=2]="IDEMPOTENT"}(en||(en={})),function(e){e[e.DEFAULT_SYMBOL_VISIBILITY_UNKNOWN=0]="DEFAULT_SYMBOL_VISIBILITY_UNKNOWN",e[e.EXPORT_ALL=1]="EXPORT_ALL",e[e.EXPORT_TOP_LEVEL=2]="EXPORT_TOP_LEVEL",e[e.LOCAL_ALL=3]="LOCAL_ALL",e[e.STRICT=4]="STRICT"}(er||(er={})),function(e){e[e.FIELD_PRESENCE_UNKNOWN=0]="FIELD_PRESENCE_UNKNOWN",e[e.EXPLICIT=1]="EXPLICIT",e[e.IMPLICIT=2]="IMPLICIT",e[e.LEGACY_REQUIRED=3]="LEGACY_REQUIRED"}(ea||(ea={})),function(e){e[e.ENUM_TYPE_UNKNOWN=0]="ENUM_TYPE_UNKNOWN",e[e.OPEN=1]="OPEN",e[e.CLOSED=2]="CLOSED"}(ei||(ei={})),function(e){e[e.REPEATED_FIELD_ENCODING_UNKNOWN=0]="REPEATED_FIELD_ENCODING_UNKNOWN",e[e.PACKED=1]="PACKED",e[e.EXPANDED=2]="EXPANDED"}(es||(es={})),function(e){e[e.UTF8_VALIDATION_UNKNOWN=0]="UTF8_VALIDATION_UNKNOWN",e[e.VERIFY=2]="VERIFY",e[e.NONE=3]="NONE"}(eo||(eo={})),function(e){e[e.MESSAGE_ENCODING_UNKNOWN=0]="MESSAGE_ENCODING_UNKNOWN",e[e.LENGTH_PREFIXED=1]="LENGTH_PREFIXED",e[e.DELIMITED=2]="DELIMITED"}(el||(el={})),function(e){e[e.JSON_FORMAT_UNKNOWN=0]="JSON_FORMAT_UNKNOWN",e[e.ALLOW=1]="ALLOW",e[e.LEGACY_BEST_EFFORT=2]="LEGACY_BEST_EFFORT"}(eu||(eu={})),function(e){e[e.ENFORCE_NAMING_STYLE_UNKNOWN=0]="ENFORCE_NAMING_STYLE_UNKNOWN",e[e.STYLE2024=1]="STYLE2024",e[e.STYLE_LEGACY=2]="STYLE_LEGACY"}(ec||(ec={})),function(e){e[e.NONE=0]="NONE",e[e.SET=1]="SET",e[e.ALIAS=2]="ALIAS"}(ed||(ed={})),function(e){e[e.EDITION_UNKNOWN=0]="EDITION_UNKNOWN",e[e.EDITION_LEGACY=900]="EDITION_LEGACY",e[e.EDITION_PROTO2=998]="EDITION_PROTO2",e[e.EDITION_PROTO3=999]="EDITION_PROTO3",e[e.EDITION_2023=1e3]="EDITION_2023",e[e.EDITION_2024=1001]="EDITION_2024",e[e.EDITION_UNSTABLE=9999]="EDITION_UNSTABLE",e[e.EDITION_1_TEST_ONLY=1]="EDITION_1_TEST_ONLY",e[e.EDITION_2_TEST_ONLY=2]="EDITION_2_TEST_ONLY",e[e.EDITION_99997_TEST_ONLY=99997]="EDITION_99997_TEST_ONLY",e[e.EDITION_99998_TEST_ONLY=99998]="EDITION_99998_TEST_ONLY",e[e.EDITION_99999_TEST_ONLY=99999]="EDITION_99999_TEST_ONLY",e[e.EDITION_MAX=2147483647]="EDITION_MAX"}(ep||(ep={})),function(e){e[e.VISIBILITY_UNSET=0]="VISIBILITY_UNSET",e[e.VISIBILITY_LOCAL=1]="VISIBILITY_LOCAL",e[e.VISIBILITY_EXPORT=2]="VISIBILITY_EXPORT"}(em||(em={}));let lT=l_("Ch9nb29nbGUvcHJvdG9idWYvdGltZXN0YW1wLnByb3RvEg9nb29nbGUucHJvdG9idWYiKwoJVGltZXN0YW1wEg8KB3NlY29uZHMYASABKAMSDQoFbmFub3MYAiABKAVChQEKE2NvbS5nb29nbGUucHJvdG9idWZCDlRpbWVzdGFtcFByb3RvUAFaMmdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3RpbWVzdGFtcHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),lA=lv(l_("Chlnb29nbGUvcHJvdG9idWYvYW55LnByb3RvEg9nb29nbGUucHJvdG9idWYiJgoDQW55EhAKCHR5cGVfdXJsGAEgASgJEg0KBXZhbHVlGAIgASgMQnYKE2NvbS5nb29nbGUucHJvdG9idWZCCEFueVByb3RvUAFaLGdvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL2FueXBiogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),0),lI={writeUnknownFields:!0};function lx(e,t,n){return lS(new oo,n?Object.assign(Object.assign({},lI),n):lI,ow(e,t)).finish()}function lS(e,t,n){var r;for(let r of n.sortedFields){if(!n.isSet(r)){if(3==r.presence)throw Error(`cannot encode ${r} to binary: required field not set`);continue}lN(e,t,n,r)}if(t.writeUnknownFields)for(let{no:t,wireType:a,data:i}of null!==(r=n.getUnknown())&&void 0!==r?r:[])e.tag(t,a).raw(i);return e}function lN(e,t,n,r){var a;switch(r.fieldKind){case"scalar":case"enum":lk(e,n.desc.typeName,r.name,null!==(a=r.scalar)&&void 0!==a?a:K.INT32,r.number,n.get(r));break;case"list":(function(e,t,n,r){var a;if("message"==n.listKind){for(let a of r)lR(e,t,n,a);return}let i=null!==(a=n.scalar)&&void 0!==a?a:K.INT32;if(n.packed){if(!r.size)return;for(let t of(e.tag(n.number,Y.LengthDelimited).fork(),r))lO(e,n.parent.typeName,n.name,i,t);e.join();return}for(let t of r)lk(e,n.parent.typeName,n.name,i,n.number,t)})(e,t,r,n.get(r));break;case"message":lR(e,t,r,n.get(r));break;case"map":for(let[a,i]of n.get(r))(function(e,t,n,r,a){var i;switch(e.tag(n.number,Y.LengthDelimited).fork(),lk(e,n.parent.typeName,n.name,n.mapKey,1,r),n.mapKind){case"scalar":case"enum":lk(e,n.parent.typeName,n.name,null!==(i=n.scalar)&&void 0!==i?i:K.INT32,2,a);break;case"message":lS(e.tag(2,Y.LengthDelimited).fork(),t,a).join()}e.join()})(e,t,r,a,i)}}function lk(e,t,n,r,a,i){lO(e.tag(a,function(e){switch(e){case K.BYTES:case K.STRING:return Y.LengthDelimited;case K.DOUBLE:case K.FIXED64:case K.SFIXED64:return Y.Bit64;case K.FIXED32:case K.SFIXED32:case K.FLOAT:return Y.Bit32;default:return Y.Varint}}(r)),t,n,r,i)}function lR(e,t,n,r){n.delimitedEncoding?lS(e.tag(n.number,Y.StartGroup),t,r).tag(n.number,Y.EndGroup):lS(e.tag(n.number,Y.LengthDelimited).fork(),t,r).join()}function lO(e,t,n,r,a){try{switch(r){case K.STRING:e.string(a);break;case K.BOOL:e.bool(a);break;case K.DOUBLE:e.double(a);break;case K.FLOAT:e.float(a);break;case K.INT32:e.int32(a);break;case K.INT64:e.int64(a);break;case K.UINT64:e.uint64(a);break;case K.FIXED64:e.fixed64(a);break;case K.BYTES:e.bytes(a);break;case K.FIXED32:e.fixed32(a);break;case K.SFIXED32:e.sfixed32(a);break;case K.SFIXED64:e.sfixed64(a);break;case K.SINT64:e.sint64(a);break;case K.UINT32:e.uint32(a);break;case K.SINT32:e.sint32(a)}}catch(e){if(e instanceof Error)throw Error(`cannot encode field ${t}.${n} to binary: ${e.message}`);throw e}}function lC(e){let t=e.lastIndexOf("/"),n=t>=0?e.substring(t+1):e;if(!n.length)throw Error(`invalid type url: ${e}`);return n}let lP=l_("Chxnb29nbGUvcHJvdG9idWYvc3RydWN0LnByb3RvEg9nb29nbGUucHJvdG9idWYihAEKBlN0cnVjdBIzCgZmaWVsZHMYASADKAsyIy5nb29nbGUucHJvdG9idWYuU3RydWN0LkZpZWxkc0VudHJ5GkUKC0ZpZWxkc0VudHJ5EgsKA2tleRgBIAEoCRIlCgV2YWx1ZRgCIAEoCzIWLmdvb2dsZS5wcm90b2J1Zi5WYWx1ZToCOAEi6gEKBVZhbHVlEjAKCm51bGxfdmFsdWUYASABKA4yGi5nb29nbGUucHJvdG9idWYuTnVsbFZhbHVlSAASFgoMbnVtYmVyX3ZhbHVlGAIgASgBSAASFgoMc3RyaW5nX3ZhbHVlGAMgASgJSAASFAoKYm9vbF92YWx1ZRgEIAEoCEgAEi8KDHN0cnVjdF92YWx1ZRgFIAEoCzIXLmdvb2dsZS5wcm90b2J1Zi5TdHJ1Y3RIABIwCgpsaXN0X3ZhbHVlGAYgASgLMhouZ29vZ2xlLnByb3RvYnVmLkxpc3RWYWx1ZUgAQgYKBGtpbmQiMwoJTGlzdFZhbHVlEiYKBnZhbHVlcxgBIAMoCzIWLmdvb2dsZS5wcm90b2J1Zi5WYWx1ZSobCglOdWxsVmFsdWUSDgoKTlVMTF9WQUxVRRAAQn8KE2NvbS5nb29nbGUucHJvdG9idWZCC1N0cnVjdFByb3RvUAFaL2dvb2dsZS5nb2xhbmcub3JnL3Byb3RvYnVmL3R5cGVzL2tub3duL3N0cnVjdHBi+AEBogIDR1BCqgIeR29vZ2xlLlByb3RvYnVmLldlbGxLbm93blR5cGVzYgZwcm90bzM"),lD=lv(lP,0),lM=lv(lP,1),lj=lv(lP,2);function lF(e,t){let n=e.typeName,r=Object.assign(Object.assign({},e),{kind:"field",parent:e.extendee,localName:n}),a=Object.assign(Object.assign({},e.extendee),{fields:[r],members:[r],oneofs:[]}),i=s4(a,void 0!==t?{[n]:t}:void 0);return[ow(a,i),r,()=>{let t=i[n];if(void 0===t){let t=e.message;return s3(t)?sY(t.fields[0].scalar,t.fields[0].longAsString):s4(t)}return t}]}function lV(e,t){if(e.extendee.typeName!=t.$typeName)throw Error(`extension ${e.typeName} can only be applied to message ${e.extendee.typeName}`)}!function(e){e[e.NULL_VALUE=0]="NULL_VALUE"}(eh||(eh={}));let lU={ignoreUnknownFields:!1};function lL(e,t,n){let r=ow(e);try{l$(r,t,n?Object.assign(Object.assign({},lU),n):lU)}catch(e){if(e instanceof Error&&or.includes(e.name)&&"field"in e&&"function"==typeof e.field)throw Error(`cannot decode ${e.field()} from JSON: ${e.message}`,{cause:e});throw e}return r.message}function l$(e,t,n){var r;if(function(e,t,n){if(!e.desc.typeName.startsWith("google.protobuf."))return!1;switch(e.desc.typeName){case"google.protobuf.Any":return function(e,t,n){var r,a,i,s,o;if(null===t||Array.isArray(t)||"object"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: expected object but got ${og(t)}`);if(0==Object.keys(t).length)return;let l=t["@type"];if("string"!=typeof l||""==l)throw Error(`cannot decode message ${e.$typeName} from JSON: "@type" is empty`);let u=l.includes("/")?l.substring(l.lastIndexOf("/")+1):l;if(!u.length)throw Error(`cannot decode message ${e.$typeName} from JSON: "@type" is invalid`);let c=null===(r=n.registry)||void 0===r?void 0:r.getMessage(u);if(!c)throw Error(`cannot decode message ${e.$typeName} from JSON: ${l} is not in the type registry`);let d=ow(c);if(u.startsWith("google.protobuf.")&&Object.prototype.hasOwnProperty.call(t,"value"))l$(d,t.value,n);else{let e=Object.assign({},t);delete e["@type"],l$(d,e,n)}a=d.desc,i=d.message,(s=e)||(s=s4(lA)),s.value=lx(a,i),s.typeUrl=(o=i.$typeName,`type.googleapis.com/${o}`)}(e.message,t,n),!0;case"google.protobuf.Timestamp":return function(e,t){if("string"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: ${og(t)}`);let n=t.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:\.([0-9]{1,9}))?(?:Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw Error(`cannot decode message ${e.$typeName} from JSON: invalid RFC 3339 string`);let r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw Error(`cannot decode message ${e.$typeName} from JSON: invalid RFC 3339 string`);if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw Error(`cannot decode message ${e.$typeName} from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive`);e.seconds=sG.parse(r/1e3),e.nanos=0,n[7]&&(e.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9)}(e.message,t),!0;case"google.protobuf.Duration":return function(e,t){if("string"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: ${og(t)}`);let n=t.match(/^(-?[0-9]+)(?:\.([0-9]+))?s/);if(null===n)throw Error(`cannot decode message ${e.$typeName} from JSON: ${og(t)}`);let r=Number(n[1]);if(r>315576e6||r<-315576e6)throw Error(`cannot decode message ${e.$typeName} from JSON: ${og(t)}`);if(e.seconds=sG.parse(r),"string"!=typeof n[2])return;let a=n[2]+"0".repeat(9-n[2].length);e.nanos=parseInt(a),(r<0||Object.is(r,-0))&&(e.nanos=-e.nanos)}(e.message,t),!0;case"google.protobuf.FieldMask":return function(e,t){if("string"!=typeof t)throw Error(`cannot decode message ${e.$typeName} from JSON: ${og(t)}`);""!==t&&(e.paths=t.split(",").map(function(t){if(t.includes("_"))throw Error(`cannot decode message ${e.$typeName} from JSON: path names must be lowerCamelCase`);let n=t.replace(/[A-Z]/g,e=>"_"+e.toLowerCase());return"_"===n[0]?n.substring(1):n}))}(e.message,t),!0;case"google.protobuf.Struct":return lJ(e.message,t),!0;case"google.protobuf.Value":return lz(e.message,t),!0;case"google.protobuf.ListValue":return lq(e.message,t),!0;default:if(s3(e.desc)){let n=e.desc.fields[0];return null===t?e.clear(n):e.set(n,lY(n,t,!0)),!0}return!1}}(e,t,n))return;if(null==t||Array.isArray(t)||"object"!=typeof t)throw Error(`cannot decode ${e.desc} from JSON: ${og(t)}`);let a=new Map,i=new Map;for(let t of e.desc.fields)i.set(t.name,t).set(t.jsonName,t);for(let[s,o]of Object.entries(t)){let t=i.get(s);if(t){if(t.oneof){if(null===o&&"scalar"==t.fieldKind)continue;let e=a.get(t.oneof);if(void 0!==e)throw new oa(t.oneof,`oneof set multiple times by ${e.name} and ${t.name}`);a.set(t.oneof,t)}lB(e,t,o,n)}else{let t;if(s.startsWith("[")&&s.endsWith("]")&&(t=null===(r=n.registry)||void 0===r?void 0:r.getExtension(s.substring(1,s.length-1)))&&t.extendee.typeName===e.desc.typeName){let[r,a,i]=lF(t);lB(r,a,o,n),function(e,t,n){var r;lV(t,e);let a=(null!==(r=e.$unknown)&&void 0!==r?r:[]).filter(e=>e.no!==t.number),[i,s]=lF(t,n),o=new oo;lN(o,{writeUnknownFields:!0},i,s);let l=new ol(o.finish());for(;l.pos<l.len;){let[e,t]=l.tag(),n=l.skip(t,e);a.push({no:e,wireType:t,data:n})}e.$unknown=a}(e.message,t,i())}if(!t&&!n.ignoreUnknownFields)throw Error(`cannot decode ${e.desc} from JSON: key "${s}" is unknown`)}}}function lB(e,t,n,r){switch(t.fieldKind){case"scalar":(function(e,t,n){let r=lY(t,n,!1);r===lK?e.clear(t):e.set(t,r)})(e,t,n);break;case"enum":(function(e,t,n,r){let a=lW(t.enum,n,r.ignoreUnknownFields,!1);a===lK?e.clear(t):a!==lG&&e.set(t,a)})(e,t,n,r);break;case"message":(function(e,t,n,r){if(null===n&&"google.protobuf.Value"!=t.message.typeName){e.clear(t);return}let a=e.isSet(t)?e.get(t):ow(t.message);l$(a,n,r),e.set(t,a)})(e,t,n,r);break;case"list":(function(e,t,n){if(null===t)return;let r=e.field();if(!Array.isArray(t))throw new oa(r,"expected Array, got "+og(t));for(let a of t){if(null===a&&!lZ(r))throw new oa(r,"list item must not be null");switch(r.listKind){case"message":let t=ow(r.message);l$(t,a,n),e.add(t);break;case"enum":let i=lW(r.enum,a,n.ignoreUnknownFields,!0);i!==lG&&e.add(i);break;case"scalar":e.add(lY(r,a,!0))}}})(e.get(t),n,r);break;case"map":(function(e,t,n){if(null===t)return;let r=e.field();if("object"!=typeof t||Array.isArray(t))throw new oa(r,"expected object, got "+og(t));for(let[a,i]of Object.entries(t)){let t;if(null===i&&!lZ(r))throw new oa(r,"map value must not be null");switch(r.mapKind){case"message":let s=ow(r.message);l$(s,i,n),t=s;break;case"enum":if((t=lW(r.enum,i,n.ignoreUnknownFields,!0))===lG)return;break;case"scalar":t=lY(r,i,!0)}let o=function(e,t){switch(e){case K.BOOL:switch(t){case"true":return!0;case"false":return!1}return t;case K.INT32:case K.FIXED32:case K.UINT32:case K.SFIXED32:case K.SINT32:return lX(t);default:return t}}(r.mapKey,a);e.set(o,t)}})(e.get(t),n,r)}}function lZ(e){var t,n;return(null===(t=e.message)||void 0===t?void 0:t.typeName)=="google.protobuf.Value"||(null===(n=e.enum)||void 0===n?void 0:n.typeName)=="google.protobuf.NullValue"}let lG=Symbol();function lW(e,t,n,r){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:r?e.values[0].number:lK;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":let a=e.values.find(e=>e.name===t);if(void 0!==a)return a.number;if(n)return lG}throw Error(`cannot decode ${e} from JSON: ${og(t)}`)}let lK=Symbol();function lY(e,t,n){if(null===t)return n?sY(e.scalar,!1):lK;switch(e.scalar){case K.DOUBLE:case K.FLOAT:if("NaN"===t)return NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if("number"==typeof t){if(Number.isNaN(t))throw new oa(e,"unexpected NaN number");if(!Number.isFinite(t))throw new oa(e,"unexpected infinite number");break}if("string"==typeof t){if(""===t||t.trim().length!==t.length)break;let e=Number(t);if(!Number.isFinite(e))break;return e}break;case K.INT32:case K.FIXED32:case K.SFIXED32:case K.SINT32:case K.UINT32:return lX(t);case K.BYTES:if("string"==typeof t){if(""===t)return new Uint8Array(0);try{return o6(t)}catch(t){throw new oa(e,t instanceof Error?t.message:String(t))}}}return t}function lX(e){if("string"==typeof e){if(""===e||e.trim().length!==e.length)return e;let t=Number(e);return Number.isNaN(t)?e:t}return e}function lJ(e,t){if("object"!=typeof t||null==t||Array.isArray(t))throw Error(`cannot decode message ${e.$typeName} from JSON ${og(t)}`);for(let[n,r]of Object.entries(t)){let t=s4(lM);lz(t,r),e.fields[n]=t}}function lz(e,t){switch(typeof t){case"number":e.kind={case:"numberValue",value:t};break;case"string":e.kind={case:"stringValue",value:t};break;case"boolean":e.kind={case:"boolValue",value:t};break;case"object":if(null===t)e.kind={case:"nullValue",value:eh.NULL_VALUE};else if(Array.isArray(t)){let n=s4(lj);lq(n,t),e.kind={case:"listValue",value:n}}else{let n=s4(lD);lJ(n,t),e.kind={case:"structValue",value:n}}break;default:throw Error(`cannot decode message ${e.$typeName} from JSON ${og(t)}`)}return e}function lq(e,t){if(!Array.isArray(t))throw Error(`cannot decode message ${e.$typeName} from JSON ${og(t)}`);for(let n of t){let t=s4(lM);lz(t,n),e.values.push(t)}}function lH(){return{get(e){return e.id in this?this[e.id]:e.defaultValue},set(e,t){return this[e.id]=t,this},delete(e){return delete this[e.id],this}}}let lQ={alwaysEmitImplicit:!1,enumAsInteger:!1,useProtoFieldName:!1};function l0(e,t){var n;let r=function(e,t){if(e.desc.typeName.startsWith("google.protobuf."))switch(e.desc.typeName){case"google.protobuf.Any":return function(e,t){let n,r;if(""===e.typeUrl)return{};let{registry:a}=t;if(a&&(n=function(e,t){if(""===e.typeUrl)return;let n="message"==t.kind?t:t.getMessage(lC(e.typeUrl));if(n&&""!==e.typeUrl&&("string"==typeof n?n:n.typeName)===lC(e.typeUrl))return oj(n,e.value)}(e,a))&&(r=a.getMessage(n.$typeName)),!r||!n)throw Error(`cannot encode message ${e.$typeName} to JSON: "${e.typeUrl}" is not in the type registry`);let i=l0(ow(r,n),t);return(r.typeName.startsWith("google.protobuf.")||null===i||Array.isArray(i)||"object"!=typeof i)&&(i={value:i}),i["@type"]=e.typeUrl,i}(e.message,t);case"google.protobuf.Timestamp":return function(e){let t=1e3*Number(e.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw Error(`cannot encode message ${e.$typeName} to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive`);if(e.nanos<0)throw Error(`cannot encode message ${e.$typeName} to JSON: nanos must not be negative`);if(e.nanos>999999999)throw Error(`cannot encode message ${e.$typeName} to JSON: nanos must not be greater than 99999999`);let n="Z";if(e.nanos>0){let t=(e.nanos+1e9).toString().substring(1);n="000000"===t.substring(3)?"."+t.substring(0,3)+"Z":"000"===t.substring(6)?"."+t.substring(0,6)+"Z":"."+t+"Z"}return new Date(t).toISOString().replace(".000Z",n)}(e.message);case"google.protobuf.Duration":return function(e){let t=Number(e.seconds),n=e.nanos;if(t>315576e6||t<-315576e6)throw Error(`cannot encode message ${e.$typeName} to JSON: value out of range`);if(t>0&&n<0||t<0&&n>0)throw Error(`cannot encode message ${e.$typeName} to JSON: nanos sign must match seconds sign`);let r=e.seconds.toString();if(0!==n){let e=Math.abs(n).toString();"000000"===(e="0".repeat(9-e.length)+e).substring(3)?e=e.substring(0,3):"000"===e.substring(6)&&(e=e.substring(0,6)),r+="."+e,n<0&&0==t&&(r="-"+r)}return r+"s"}(e.message);case"google.protobuf.FieldMask":var n;return(n=e.message).paths.map(e=>{if(e.match(/_[0-9]?_/g)||e.match(/[A-Z]/g))throw Error(`cannot encode message ${n.$typeName} to JSON: lowerCamelCase of path name "`+e+'" is irreversible');return le(e)}).join(",");case"google.protobuf.Struct":return l9(e.message);case"google.protobuf.Value":return l4(e.message);case"google.protobuf.ListValue":return l5(e.message);default:if(s3(e.desc)){let t=e.desc.fields[0];return l3(t,e.get(t))}return}}(e,t);if(void 0!==r)return r;let a={};for(let n of e.sortedFields){if(!e.isSet(n)){if(3==n.presence)throw Error(`cannot encode ${n} to JSON: required field not set`);if(!t.alwaysEmitImplicit||2!==n.presence)continue}let r=l1(n,e.get(n),t);void 0!==r&&(a[t.useProtoFieldName?n.name:n.jsonName]=r)}if(t.registry){let r=new Set;for(let{no:i}of null!==(n=e.getUnknown())&&void 0!==n?n:[])if(!r.has(i)){r.add(i);let n=t.registry.getExtensionFor(e.desc,i);if(!n)continue;let s=function(e,t){lV(t,e);let n=function(e,t){if(void 0===e)return[];if("enum"===t.fieldKind||"scalar"===t.fieldKind){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.number)return[e[n]];return[]}return e.filter(e=>e.no===t.number)}(e.$unknown,t),[r,a,i]=lF(t);for(let e of n)oV(r,new ol(e.data),a,e.wireType,{readUnknownFields:!0});return i()}(e.message,n),[o,l]=lF(n,s),u=l1(l,o.get(l),t);void 0!==u&&(a[n.jsonName]=u)}}return a}function l1(e,t,n){switch(e.fieldKind){case"scalar":return l3(e,t);case"message":return l0(t,n);case"enum":return l2(e.enum,t,n.enumAsInteger);case"list":return function(e,t){let n=e.field(),r=[];switch(n.listKind){case"scalar":for(let t of e)r.push(l3(n,t));break;case"enum":for(let a of e)r.push(l2(n.enum,a,t.enumAsInteger));break;case"message":for(let n of e)r.push(l0(n,t))}return t.alwaysEmitImplicit||r.length>0?r:void 0}(t,n);case"map":return function(e,t){let n=e.field(),r={};switch(n.mapKind){case"scalar":for(let[t,a]of e)r[t]=l3(n,a);break;case"message":for(let[n,a]of e)r[n]=l0(a,t);break;case"enum":for(let[a,i]of e)r[a]=l2(n.enum,i,t.enumAsInteger)}return t.alwaysEmitImplicit||e.size>0?r:void 0}(t,n)}}function l2(e,t,n){var r;if("number"!=typeof t)throw Error(`cannot encode ${e} to JSON: expected number, got ${og(t)}`);if("google.protobuf.NullValue"==e.typeName)return null;if(n)return t;let a=e.value[t];return null!==(r=null==a?void 0:a.name)&&void 0!==r?r:t}function l3(e,t){var n,r,a,i,s,o;switch(e.scalar){case K.INT32:case K.SFIXED32:case K.SINT32:case K.FIXED32:case K.UINT32:if("number"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null===(n=od(e,t))||void 0===n?void 0:n.message}`);return t;case K.FLOAT:case K.DOUBLE:if("number"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null===(r=od(e,t))||void 0===r?void 0:r.message}`);if(Number.isNaN(t))return"NaN";if(t===Number.POSITIVE_INFINITY)return"Infinity";if(t===Number.NEGATIVE_INFINITY)return"-Infinity";return t;case K.STRING:if("string"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null===(a=od(e,t))||void 0===a?void 0:a.message}`);return t;case K.BOOL:if("boolean"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null===(i=od(e,t))||void 0===i?void 0:i.message}`);return t;case K.UINT64:case K.FIXED64:case K.INT64:case K.SFIXED64:case K.SINT64:if("bigint"!=typeof t&&"string"!=typeof t)throw Error(`cannot encode ${e} to JSON: ${null===(s=od(e,t))||void 0===s?void 0:s.message}`);return t.toString();case K.BYTES:if(t instanceof Uint8Array)return o8(t);throw Error(`cannot encode ${e} to JSON: ${null===(o=od(e,t))||void 0===o?void 0:o.message}`)}}function l9(e){let t={};for(let[n,r]of Object.entries(e.fields))t[n]=l4(r);return t}function l4(e){switch(e.kind.case){case"nullValue":return null;case"numberValue":if(!Number.isFinite(e.kind.value))throw Error(`${e.$typeName} cannot be NaN or Infinity`);return e.kind.value;case"boolValue":case"stringValue":return e.kind.value;case"structValue":return l9(e.kind.value);case"listValue":return l5(e.kind.value);default:throw Error(`${e.$typeName} must have a value`)}}function l5(e){return e.values.map(l4)}function l6(e){var t;let n=Object.assign({},e);return null!==(t=n.ignoreUnknownFields)&&void 0!==t||(n.ignoreUnknownFields=!0),n}function l8(e,t,n,r){let a=t?l7(e.input,r):ue(e.input,n);return{parse:(t?l7(e.output,r):ue(e.output,n)).parse,serialize:a.serialize}}function l7(e,t){return{parse(n){try{return oj(e,n,t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new oB(`parse binary: ${e}`,W.Internal)}},serialize(n){try{return lx(e,n,t)}catch(t){let e=t instanceof Error?t.message:String(t);throw new oB(`serialize binary: ${e}`,W.Internal)}}}}function ue(e,t){var n,r;let a=null!==(n=null==t?void 0:t.textEncoder)&&void 0!==n?n:new TextEncoder,i=null!==(r=null==t?void 0:t.textDecoder)&&void 0!==r?r:new TextDecoder,s=l6(t);return{parse(t){try{let n=i.decode(t);return lL(e,function(e,t){try{return JSON.parse(e)}catch(n){let e=n instanceof Error?n.message:String(n);throw Error(`cannot decode message ${t} from JSON: ${e}`,{cause:n})}}(n,e.typeName),s)}catch(e){throw oB.from(e,W.InvalidArgument)}},serialize(t){try{var n;let r=JSON.stringify(l0(ow(e,t),s?Object.assign(Object.assign({},lQ),s):lQ),null,null!==(n=null==s?void 0:s.prettySpaces)&&void 0!==n?n:0);return a.encode(r)}catch(e){throw oB.from(e,W.Internal)}}}}function ut(e,t){var n;return null!==(n=null==t?void 0:t.concat().reverse().reduce((e,t)=>t(e),e))&&void 0!==n?n:e}function un(e){if(!e.aborted)return;if(void 0!==e.reason)return e.reason;let t=Error("This operation was aborted");return t.name="AbortError",t}function ur(e){let{signal:t,cleanup:n}=function(e){let t;let n=new AbortController,r=()=>{n.abort(new oB("the operation timed out",W.DeadlineExceeded))};return void 0!==e&&(e<=0?r():t=setTimeout(r,e)),{signal:n.signal,cleanup:()=>clearTimeout(t)}}(e.timeoutMs),r=function(...e){let t=new AbortController,n=e.filter(e=>void 0!==e).concat(t.signal);for(let e of n){if(e.aborted){r.apply(e);break}e.addEventListener("abort",r)}function r(){for(let e of(t.signal.aborted||t.abort(un(this)),n))e.removeEventListener("abort",r)}return t}(e.signal,t);return[r.signal,function(e){let a=oB.from(t.aborted?un(t):e);return r.abort(a),n(),Promise.reject(a)},function(){n(),r.abort()}]}function ua(e,t){return e.toString().replace(/\/?$/,`/${t.parent.typeName}/${t.name}`)}let ui="Content-Type",us="Content-Encoding",uo="Connect-Protocol-Version",ul="User-Agent",uu=/^application\/(connect\+)?(?:(json)(?:; ?charset=utf-?8)?|(proto))$/i;function uc(e,t,n,r,a){let i=new Headers(null!=r?r:{});return void 0!==n&&i.set("Connect-Timeout-Ms",`${n}`),i.set(ui,"unary"==e?t?"application/proto":"application/json":t?"application/connect+proto":"application/connect+json"),i.set(uo,"1"),!i.has(ul)&&a&&i.set(ul,"connect-es/2.0.0-rc.3"),i}let ud="application/";function up(e,t,n,r){let a=r.get(ui),i=function(e){let t=null==e?void 0:e.match(uu);if(t)return{stream:!!t[1],binary:!!t[3]}}(a);if(200!==n){let t=new oB(`HTTP ${n}`,function(e){switch(e){case 400:return W.Internal;case 401:return W.Unauthenticated;case 403:return W.PermissionDenied;case 404:return W.Unimplemented;case 429:case 502:case 503:case 504:return W.Unavailable;default:return W.Unknown}}(n),r);if("unary"==e&&i&&!i.binary)return{isUnaryError:!0,unaryError:t};throw t}let s={binary:t,stream:"unary"!==e};if((null==i?void 0:i.binary)!==s.binary||i.stream!==s.stream)throw new oB(`unsupported content type ${a}`,void 0===i?W.Unknown:W.Internal,r);return{isUnaryError:!1}}function um(e,t,n){var r;if(t&&new Headers(t).forEach((e,t)=>n.metadata.append(t,e)),"object"!=typeof e||null==e||Array.isArray(e))throw n;let i=n.code;"code"in e&&"string"==typeof e.code&&(i=null!==(r=function(e){if(!a)for(let e of(a={},Object.values(W)))"string"!=typeof e&&(a[o$(e)]=e);return a[e]}(e.code))&&void 0!==r?r:i);let s=e.message;if(null!=s&&"string"!=typeof s)throw n;let o=new oB(null!=s?s:"",i,t);if("details"in e&&Array.isArray(e.details))for(let t of e.details){if(null===t||"object"!=typeof t||Array.isArray(t)||"string"!=typeof t.type||"string"!=typeof t.value)throw n;try{o.details.push({type:t.type,value:o6(t.value),debug:t.debug})}catch(e){throw n}}return o}function uh(e){let t=new Headers,n=new Headers;return e.forEach((e,r)=>{r.toLowerCase().startsWith("trailer-")?n.append(r.substring(8),e):t.append(r,e)}),[t,n]}var uf=function(e){return this instanceof uf?(this.v=e,this):new uf(e)},ug=function(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,a=n.apply(e,t||[]),i=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function s(e,t){a[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||o(e,t)})},t&&(r[e]=t(r[e])))}function o(e,t){try{var n;(n=a[e](t)).value instanceof uf?Promise.resolve(n.value.v).then(l,u):c(i[0][2],n)}catch(e){c(i[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),i.shift(),i.length&&o(i[0][0],i[0][1])}};let uy={redirect:"error"},ub=(e=0)=>t=>`\u001B[${t+e}m`,uv=(e=0)=>t=>`\u001B[${38+e};5;${t}m`,uw=(e=0)=>(t,n,r)=>`\u001B[${38+e};2;${t};${n};${r}m`,u_={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(u_.modifier),[...Object.keys(u_.color),...Object.keys(u_.bgColor)];let uE=function(){let e=new Map;for(let[t,n]of Object.entries(u_)){for(let[t,r]of Object.entries(n))u_[t]={open:`\u001B[${r[0]}m`,close:`\u001B[${r[1]}m`},n[t]=u_[t],e.set(r[0],r[1]);Object.defineProperty(u_,t,{value:n,enumerable:!1})}return Object.defineProperty(u_,"codes",{value:e,enumerable:!1}),u_.color.close="\x1b[39m",u_.bgColor.close="\x1b[49m",u_.color.ansi=ub(),u_.color.ansi256=uv(),u_.color.ansi16m=uw(),u_.bgColor.ansi=ub(10),u_.bgColor.ansi256=uv(10),u_.bgColor.ansi16m=uw(10),Object.defineProperties(u_,{rgbToAnsi256:{value:(e,t,n)=>e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5),enumerable:!1},hexToRgb:{value(e){let t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!t)return[0,0,0];let[n]=t;3===n.length&&(n=[...n].map(e=>e+e).join(""));let r=Number.parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},enumerable:!1},hexToAnsi256:{value:e=>u_.rgbToAnsi256(...u_.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){let t,n,r;if(e<8)return 30+e;if(e<16)return 90+(e-8);if(e>=232)n=t=((e-232)*10+8)/255,r=t;else{let a=(e-=16)%36;t=Math.floor(e/36)/5,n=Math.floor(a/6)/5,r=a%6/5}let a=2*Math.max(t,n,r);if(0===a)return 30;let i=30+(Math.round(r)<<2|Math.round(n)<<1|Math.round(t));return 2===a&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(e,t,n)=>u_.ansi256ToAnsi(u_.rgbToAnsi256(e,t,n)),enumerable:!1},hexToAnsi:{value:e=>u_.ansi256ToAnsi(u_.hexToAnsi256(e)),enumerable:!1}}),u_}(),uT=require("node:process"),uA=require("node:os"),uI=require("node:tty");function ux(e,t=globalThis.Deno?globalThis.Deno.args:uT.argv){let n=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(n+e),a=t.indexOf("--");return -1!==r&&(-1===a||r<a)}let{env:uS}=uT;function uN(e,t={}){var n;return 0!==(n=function(e,{streamIsTTY:t,sniffFlags:n=!0}={}){let r=function(){if("FORCE_COLOR"in uS)return"true"===uS.FORCE_COLOR?1:"false"===uS.FORCE_COLOR?0:0===uS.FORCE_COLOR.length?1:Math.min(Number.parseInt(uS.FORCE_COLOR,10),3)}();void 0!==r&&(l=r);let a=n?l:r;if(0===a)return 0;if(n){if(ux("color=16m")||ux("color=full")||ux("color=truecolor"))return 3;if(ux("color=256"))return 2}if("TF_BUILD"in uS&&"AGENT_NAME"in uS)return 1;if(e&&!t&&void 0===a)return 0;let i=a||0;if("dumb"===uS.TERM)return i;if("win32"===uT.platform){let e=uA.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in uS)return["GITHUB_ACTIONS","GITEA_ACTIONS","CIRCLECI"].some(e=>e in uS)?3:["TRAVIS","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(e=>e in uS)||"codeship"===uS.CI_NAME?1:i;if("TEAMCITY_VERSION"in uS)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(uS.TEAMCITY_VERSION)?1:0;if("truecolor"===uS.COLORTERM||"xterm-kitty"===uS.TERM||"xterm-ghostty"===uS.TERM||"wezterm"===uS.TERM)return 3;if("TERM_PROGRAM"in uS){let e=Number.parseInt((uS.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(uS.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(uS.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(uS.TERM)||"COLORTERM"in uS?1:i}(e,{streamIsTTY:e&&e.isTTY,...t}))&&{level:n,hasBasic:!0,has256:n>=2,has16m:n>=3}}ux("no-color")||ux("no-colors")||ux("color=false")||ux("color=never")?l=0:(ux("color")||ux("colors")||ux("color=true")||ux("color=always"))&&(l=1);let{stdout:uk,stderr:uR}={stdout:uN({isTTY:uI.isatty(1)}),stderr:uN({isTTY:uI.isatty(2)})},uO=Symbol("GENERATOR"),uC=Symbol("STYLER"),uP=Symbol("IS_EMPTY"),uD=["ansi","ansi","ansi256","ansi16m"],uM=Object.create(null),uj=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw Error("The `level` option should be an integer from 0 to 3");let n=uk?uk.level:0;e.level=void 0===t.level?n:t.level},uF=e=>{let t=(...e)=>e.join(" ");return uj(t,e),Object.setPrototypeOf(t,uV.prototype),t};function uV(e){return uF(e)}for(let[e,t]of(Object.setPrototypeOf(uV.prototype,Function.prototype),Object.entries(uE)))uM[e]={get(){let n=uB(this,u$(t.open,t.close,this[uC]),this[uP]);return Object.defineProperty(this,e,{value:n}),n}};uM.visible={get(){let e=uB(this,this[uC],!0);return Object.defineProperty(this,"visible",{value:e}),e}};let uU=(e,t,n,...r)=>"rgb"===e?"ansi16m"===t?uE[n].ansi16m(...r):"ansi256"===t?uE[n].ansi256(uE.rgbToAnsi256(...r)):uE[n].ansi(uE.rgbToAnsi(...r)):"hex"===e?uU("rgb",t,n,...uE.hexToRgb(...r)):uE[n][e](...r);for(let e of["rgb","hex","ansi256"])uM[e]={get(){let{level:t}=this;return function(...n){return uB(this,u$(uU(e,uD[t],"color",...n),uE.color.close,this[uC]),this[uP])}}},uM["bg"+e[0].toUpperCase()+e.slice(1)]={get(){let{level:t}=this;return function(...n){return uB(this,u$(uU(e,uD[t],"bgColor",...n),uE.bgColor.close,this[uC]),this[uP])}}};let uL=Object.defineProperties(()=>{},{...uM,level:{enumerable:!0,get(){return this[uO].level},set(e){this[uO].level=e}}}),u$=(e,t,n)=>{let r,a;return void 0===n?(r=e,a=t):(r=n.openAll+e,a=t+n.closeAll),{open:e,close:t,openAll:r,closeAll:a,parent:n}},uB=(e,t,n)=>{let r=(...e)=>uZ(r,1===e.length?""+e[0]:e.join(" "));return Object.setPrototypeOf(r,uL),r[uO]=e,r[uC]=t,r[uP]=n,r},uZ=(e,t)=>{if(e.level<=0||!t)return e[uP]?"":t;let n=e[uC];if(void 0===n)return t;let{openAll:r,closeAll:a}=n;if(t.includes("\x1b"))for(;void 0!==n;)t=function(e,t,n){let r=e.indexOf(t);if(-1===r)return e;let a=t.length,i=0,s="";do s+=e.slice(i,r)+t+n,i=r+a,r=e.indexOf(t,i);while(-1!==r);return s+e.slice(i)}(t,n.close,n.open),n=n.parent;let i=t.indexOf("\n");return -1!==i&&(t=function(e,t,n,r){let a=0,i="";do{let s="\r"===e[r-1];i+=e.slice(a,s?r-1:r)+t+(s?"\r\n":"\n")+n,a=r+1,r=e.indexOf("\n",a)}while(-1!==r);return i+e.slice(a)}(t,a,r,i)),r+t+a};Object.defineProperties(uV.prototype,uM);let uG=uF(void 0);uF({level:uR?uR.level:0});let uW=require("node:crypto"),uK=require("node:fs"),uY=require("node:path");var uX=n(7911),uJ=Object.defineProperty,uz=Object.defineProperties,uq=Object.getOwnPropertyDescriptors,uH=Object.getOwnPropertySymbols,uQ=Object.prototype.hasOwnProperty,u0=Object.prototype.propertyIsEnumerable,u1=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),u2=(e,t,n)=>t in e?uJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u3=(e,t)=>{for(var n in t||(t={}))uQ.call(t,n)&&u2(e,n,t[n]);if(uH)for(var n of uH(t))u0.call(t,n)&&u2(e,n,t[n]);return e},u9=(e,t)=>uz(e,uq(t)),u4=(c=function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(c,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):c),u5=function(e,t){this[0]=e,this[1]=t},u6=(e,t,n)=>{var r=(e,t,a,i)=>{try{var s=n[e](t),o=(t=s.value)instanceof u5,l=s.done;Promise.resolve(o?t[0]:t).then(n=>o?r("return"===e?e:"next",t[1]?{done:n.done,value:n.value}:n,a,i):a({value:n,done:l})).catch(e=>r("throw",e,a,i))}catch(e){i(e)}},a=e=>i[e]=t=>new Promise((n,a)=>r(e,t,n,a)),i={};return n=n.apply(e,t),i[u1("asyncIterator")]=()=>i,a("next"),a("throw"),a("return"),i},u8=(e,t,n)=>(t=e[u1("asyncIterator")])?t.call(e):(e=e[u1("iterator")](),t={},(n=(n,r)=>(r=e[n])&&(t[n]=t=>new Promise((n,a,i)=>(i=(t=r.call(e,t)).done,Promise.resolve(t.value).then(e=>n({value:e,done:i}),a)))))("next"),n("return"),t),u7="2.9.0",{runtime:ce,version:ct}=function(){var e,t,n;return globalThis.Bun?{runtime:"bun",version:globalThis.Bun.version}:globalThis.Deno?{runtime:"deno",version:globalThis.Deno.version.deno}:(null==(t=null==(e=globalThis.process)?void 0:e.release)?void 0:t.name)==="node"?{runtime:"node",version:sP.version||"unknown"}:"string"==typeof EdgeRuntime?{runtime:"vercel-edge",version:"unknown"}:(null==(n=globalThis.navigator)?void 0:n.userAgent)==="Cloudflare-Workers"?{runtime:"cloudflare-worker",version:"unknown"}:"undefined"!=typeof window?{runtime:"browser",version:sP.version||"unknown"}:{runtime:"unknown",version:"unknown"}}();async function cn(e){if("undefined"!=typeof crypto){let t=new TextEncoder().encode(e);return btoa(String.fromCharCode(...new Uint8Array(await crypto.subtle.digest("SHA-256",t))))}let{createHash:t}=u4("node:crypto");return t("sha256").update(e,"utf8").digest().toString("base64")}function cr(e){return Math.ceil(e/1e3)}async function ca(e){if("browser"===ce)throw Error("Browser runtime is not supported for dynamic import");return await n(2199)(e)}function ci(e){return e.replace(function({onlyFirst:e=!1}={}){let t=`(?:\\u001B\\][\\s\\S]*?(?:\\u0007|\\u001B\\u005C|\\u009C))`;return RegExp(`${t}|[\\u001B\\u009B][[\\]()#;?]*(?:\\d{1,4}(?:[;:]\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]`,e?void 0:"g")}(),"")}var cs={browser:"undefined"!=typeof window&&sP.name||"unknown",lang:"js",lang_version:ct,package_version:u7,publisher:"e2b",sdk_runtime:ce,system:(null==(ef=sP.os)?void 0:ef.family)||"unknown"};function co(e){return"deno"===ce?Deno.env.get(e):"undefined"==typeof process?"":process.env[e]}function cl(e){return new cc(`${e}: This error is likely due to sandbox timeout. You can modify the sandbox timeout by passing 'timeoutMs' when starting the sandbox or calling '.setTimeout' on the sandbox with the desired timeout.`)}var cu=class extends Error{constructor(e,t){super(e),this.name="SandboxError",t&&(this.stack=t)}},cc=class extends cu{constructor(e,t){super(e,t),this.name="TimeoutError"}},cd=class extends cu{constructor(e,t){super(e,t),this.name="InvalidArgumentError"}},cp=class extends cu{constructor(e,t){super(e,t),this.name="NotEnoughSpaceError"}},cm=class extends cu{constructor(e,t){super(e,t),this.name="NotFoundError"}},ch=class extends Error{constructor(e){super(e),this.name="AuthenticationError"}},cf=class extends cu{constructor(e,t){super(e,t),this.name="TemplateError"}},cg=class extends cu{constructor(e){super(e),this.name="RateLimitError"}},cy=class extends Error{constructor(e,t){super(e),this.name="BuildError",t&&(this.stack=t)}},cb=class extends cy{constructor(e,t){super(e,t),this.name="FileUploadError"}};function cv(e){return JSON.parse(JSON.stringify(e))}function cw(e){return{async onRequest({request:t}){var n;return null==(n=e.info)||n.call(e,`Request ${t.method} ${t.url}`),t},async onResponse({response:t}){var n,r;return t.status>=400?null==(n=e.error)||n.call(e,"Response:",t.status,t.statusText):null==(r=e.info)||r.call(e,"Response:",t.status,t.statusText),t}}}function c_(e,t=cu,n){var r,a,i,s,o,l;if(!e.error)return;if(401===e.response.status){let t="Unauthorized, please check your credentials.",n=null!=(a=null==(r=e.error)?void 0:r.message)?a:e.error;return new ch(n?`${t} - ${n}`:t)}if(429===e.response.status){let t="Rate limit exceeded, please try again later",n=null!=(s=null==(i=e.error)?void 0:i.message)?s:e.error;return new cg(n?`${t} - ${n}`:t)}let u=null!=(l=null==(o=e.error)?void 0:o.message)?l:e.error;return new t(`${e.response.status}: ${u}`,n)}var cE=class{constructor(e,t={requireAccessToken:!1,requireApiKey:!1}){if((null==t?void 0:t.requireApiKey)&&!e.apiKey)throw new ch("API key is required, please visit the Team tab at https://e2b.dev/dashboard to get your API key. You can either set the environment variable `E2B_API_KEY` or you can pass it directly to the sandbox like Sandbox.create({ apiKey: 'e2b_...' })");if((null==t?void 0:t.requireAccessToken)&&!e.accessToken)throw new ch("Access token is required, please visit the Personal tab at https://e2b.dev/dashboard to get your access token. You can set the environment variable `E2B_ACCESS_TOKEN` or pass the `accessToken` in options.");this.api=sI({baseUrl:e.apiUrl,headers:u3(u3(u3(u3({},cs),e.apiKey&&{"X-API-KEY":e.apiKey}),e.accessToken&&{Authorization:`Bearer ${e.accessToken}`}),e.headers),querySerializer:{array:{style:"form",explode:!1}}}),e.logger&&this.api.use(cw(e.logger))}},cT="Keepalive-Ping-Interval",cA=class e{constructor(t){var n;this.apiKey=(null==t?void 0:t.apiKey)||e.apiKey,this.debug=(null==t?void 0:t.debug)||e.debug,this.domain=(null==t?void 0:t.domain)||e.domain,this.accessToken=(null==t?void 0:t.accessToken)||e.accessToken,this.requestTimeoutMs=null!=(n=null==t?void 0:t.requestTimeoutMs)?n:6e4,this.logger=null==t?void 0:t.logger,this.headers=(null==t?void 0:t.headers)||{},this.headers["User-Agent"]=`e2b-js-sdk/${u7}`,this.apiUrl=(null==t?void 0:t.apiUrl)||e.apiUrl||(this.debug?"http://localhost:3000":`https://api.${this.domain}`),this.sandboxUrl=(null==t?void 0:t.sandboxUrl)||e.sandboxUrl}static get domain(){return co("E2B_DOMAIN")||"e2b.app"}static get apiUrl(){return co("E2B_API_URL")}static get sandboxUrl(){return co("E2B_SANDBOX_URL")}static get debug(){return"true"===(co("E2B_DEBUG")||"false").toLowerCase()}static get apiKey(){return co("E2B_API_KEY")}static get accessToken(){return co("E2B_ACCESS_TOKEN")}getSignal(e){let t=null!=e?e:this.requestTimeoutMs;return t?AbortSignal.timeout(t):void 0}getSandboxUrl(e,t){return this.sandboxUrl?this.sandboxUrl:`${this.debug?"http":"https"}://${this.getHost(e,t.envdPort,t.sandboxDomain)}`}getHost(e,t,n){return this.debug?`localhost:${t}`:`${t}-${e}.${null!=n?n:this.domain}`}};cA.envdPort=49983;var cI="user";async function cx({path:e,operation:t,user:n,expirationInSeconds:r,envdAccessToken:a}){let i;if(!a)throw Error("Access token is not set and signature cannot be generated!");let s=r?Math.floor(Date.now()/1e3)+r:null;return void 0==n&&(n=""),i=null===s?`${e}:${t}:${n}:${a}`:`${e}:${t}:${n}:${a}:${s.toString()}`,{signature:"v1_"+(await cn(i)).replace(/=+$/,""),expiration:s}}async function cS(e){var t;if(!e.error)return;let n="string"==typeof e.error?e.error:(null==(t=e.error)?void 0:t.message)||await e.response.text();switch(e.response.status){case 400:return new cd(n);case 401:return new ch(n);case 404:return new cm(n);case 429:return new cu(`${e.response.status}: ${n}: The requests are being rate limited.`);case 502:return cl(n);case 507:return new cp(n);default:return new cu(`${e.response.status}: ${n}`)}}async function cN(e){var t;let n;try{n=(await e[Symbol.asyncIterator]().next()).value}catch(e){if(e instanceof oB&&e.code===W.Unavailable)throw new cm("Sandbox is probably not running anymore");throw e}if((null==(t=n.event)?void 0:t.event.case)!=="start")throw Error("Expected start event");return n.event.event.value.pid}async function ck(e){var t;let n;try{n=(await e[Symbol.asyncIterator]().next()).value}catch(e){if(e instanceof oB&&e.code===W.Unavailable)throw new cm("Sandbox is probably not running anymore");throw e}if((null==(t=n.event)?void 0:t.case)!=="start")throw Error("Expected start event");return n.event.value}var cR=class{constructor(e,t){this.api=sI({baseUrl:e.apiUrl,fetch:null==e?void 0:e.fetch,headers:null==e?void 0:e.headers}),this.version=t.version,e.logger&&this.api.use(cw(e.logger))}},cO="99.99.99",cC="0.4.0";function cP(e){if(e instanceof oB)switch(e.code){case W.InvalidArgument:return new cd(e.message);case W.Unauthenticated:return new ch(e.message);case W.NotFound:return new cm(e.message);case W.Unavailable:return cl(e.message);case W.Canceled:return new cc(`${e.message}: This error is likely due to exceeding 'requestTimeoutMs'. You can pass the request timeout value as an option when making the request.`);case W.DeadlineExceeded:return new cc(`${e.message}: This error is likely due to exceeding 'timeoutMs' \u2014 the total time a long running request (like command execution or directory watch) can be active. It can be modified by passing 'timeoutMs' when making the request. Use '0' to disable the timeout.`);default:return new cu(`${e.code}: ${e.message}`)}return e}function cD(e,t){if(void 0==t&&0>o5(e,cC)&&(t=cI),!t)return{};let n=function(e){switch(ce){case"deno":default:return btoa(e);case"node":case"bun":return Buffer.from(e).toString("base64")}}(`${t}:`);return{Authorization:`Basic ${n}`}}var cM=lE(l_("ChtmaWxlc3lzdGVtL2ZpbGVzeXN0ZW0ucHJvdG8SCmZpbGVzeXN0ZW0iMgoLTW92ZVJlcXVlc3QSDgoGc291cmNlGAEgASgJEhMKC2Rlc3RpbmF0aW9uGAIgASgJIjQKDE1vdmVSZXNwb25zZRIkCgVlbnRyeRgBIAEoCzIVLmZpbGVzeXN0ZW0uRW50cnlJbmZvIh4KDk1ha2VEaXJSZXF1ZXN0EgwKBHBhdGgYASABKAkiNwoPTWFrZURpclJlc3BvbnNlEiQKBWVudHJ5GAEgASgLMhUuZmlsZXN5c3RlbS5FbnRyeUluZm8iHQoNUmVtb3ZlUmVxdWVzdBIMCgRwYXRoGAEgASgJIhAKDlJlbW92ZVJlc3BvbnNlIhsKC1N0YXRSZXF1ZXN0EgwKBHBhdGgYASABKAkiNAoMU3RhdFJlc3BvbnNlEiQKBWVudHJ5GAEgASgLMhUuZmlsZXN5c3RlbS5FbnRyeUluZm8i/QEKCUVudHJ5SW5mbxIMCgRuYW1lGAEgASgJEiIKBHR5cGUYAiABKA4yFC5maWxlc3lzdGVtLkZpbGVUeXBlEgwKBHBhdGgYAyABKAkSDAoEc2l6ZRgEIAEoAxIMCgRtb2RlGAUgASgNEhMKC3Blcm1pc3Npb25zGAYgASgJEg0KBW93bmVyGAcgASgJEg0KBWdyb3VwGAggASgJEjEKDW1vZGlmaWVkX3RpbWUYCSABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wEhsKDnN5bWxpbmtfdGFyZ2V0GAogASgJSACIAQFCEQoPX3N5bWxpbmtfdGFyZ2V0Ii0KDkxpc3REaXJSZXF1ZXN0EgwKBHBhdGgYASABKAkSDQoFZGVwdGgYAiABKA0iOQoPTGlzdERpclJlc3BvbnNlEiYKB2VudHJpZXMYASADKAsyFS5maWxlc3lzdGVtLkVudHJ5SW5mbyIyCg9XYXRjaERpclJlcXVlc3QSDAoEcGF0aBgBIAEoCRIRCglyZWN1cnNpdmUYAiABKAgiRAoPRmlsZXN5c3RlbUV2ZW50EgwKBG5hbWUYASABKAkSIwoEdHlwZRgCIAEoDjIVLmZpbGVzeXN0ZW0uRXZlbnRUeXBlIuABChBXYXRjaERpclJlc3BvbnNlEjgKBXN0YXJ0GAEgASgLMicuZmlsZXN5c3RlbS5XYXRjaERpclJlc3BvbnNlLlN0YXJ0RXZlbnRIABIxCgpmaWxlc3lzdGVtGAIgASgLMhsuZmlsZXN5c3RlbS5GaWxlc3lzdGVtRXZlbnRIABI7CglrZWVwYWxpdmUYAyABKAsyJi5maWxlc3lzdGVtLldhdGNoRGlyUmVzcG9uc2UuS2VlcEFsaXZlSAAaDAoKU3RhcnRFdmVudBoLCglLZWVwQWxpdmVCBwoFZXZlbnQiNwoUQ3JlYXRlV2F0Y2hlclJlcXVlc3QSDAoEcGF0aBgBIAEoCRIRCglyZWN1cnNpdmUYAiABKAgiKwoVQ3JlYXRlV2F0Y2hlclJlc3BvbnNlEhIKCndhdGNoZXJfaWQYASABKAkiLQoXR2V0V2F0Y2hlckV2ZW50c1JlcXVlc3QSEgoKd2F0Y2hlcl9pZBgBIAEoCSJHChhHZXRXYXRjaGVyRXZlbnRzUmVzcG9uc2USKwoGZXZlbnRzGAEgAygLMhsuZmlsZXN5c3RlbS5GaWxlc3lzdGVtRXZlbnQiKgoUUmVtb3ZlV2F0Y2hlclJlcXVlc3QSEgoKd2F0Y2hlcl9pZBgBIAEoCSIXChVSZW1vdmVXYXRjaGVyUmVzcG9uc2UqUgoIRmlsZVR5cGUSGQoVRklMRV9UWVBFX1VOU1BFQ0lGSUVEEAASEgoORklMRV9UWVBFX0ZJTEUQARIXChNGSUxFX1RZUEVfRElSRUNUT1JZEAIqmAEKCUV2ZW50VHlwZRIaChZFVkVOVF9UWVBFX1VOU1BFQ0lGSUVEEAASFQoRRVZFTlRfVFlQRV9DUkVBVEUQARIUChBFVkVOVF9UWVBFX1dSSVRFEAISFQoRRVZFTlRfVFlQRV9SRU1PVkUQAxIVChFFVkVOVF9UWVBFX1JFTkFNRRAEEhQKEEVWRU5UX1RZUEVfQ0hNT0QQBTKfBQoKRmlsZXN5c3RlbRI5CgRTdGF0EhcuZmlsZXN5c3RlbS5TdGF0UmVxdWVzdBoYLmZpbGVzeXN0ZW0uU3RhdFJlc3BvbnNlEkIKB01ha2VEaXISGi5maWxlc3lzdGVtLk1ha2VEaXJSZXF1ZXN0GhsuZmlsZXN5c3RlbS5NYWtlRGlyUmVzcG9uc2USOQoETW92ZRIXLmZpbGVzeXN0ZW0uTW92ZVJlcXVlc3QaGC5maWxlc3lzdGVtLk1vdmVSZXNwb25zZRJCCgdMaXN0RGlyEhouZmlsZXN5c3RlbS5MaXN0RGlyUmVxdWVzdBobLmZpbGVzeXN0ZW0uTGlzdERpclJlc3BvbnNlEj8KBlJlbW92ZRIZLmZpbGVzeXN0ZW0uUmVtb3ZlUmVxdWVzdBoaLmZpbGVzeXN0ZW0uUmVtb3ZlUmVzcG9uc2USRwoIV2F0Y2hEaXISGy5maWxlc3lzdGVtLldhdGNoRGlyUmVxdWVzdBocLmZpbGVzeXN0ZW0uV2F0Y2hEaXJSZXNwb25zZTABElQKDUNyZWF0ZVdhdGNoZXISIC5maWxlc3lzdGVtLkNyZWF0ZVdhdGNoZXJSZXF1ZXN0GiEuZmlsZXN5c3RlbS5DcmVhdGVXYXRjaGVyUmVzcG9uc2USXQoQR2V0V2F0Y2hlckV2ZW50cxIjLmZpbGVzeXN0ZW0uR2V0V2F0Y2hlckV2ZW50c1JlcXVlc3QaJC5maWxlc3lzdGVtLkdldFdhdGNoZXJFdmVudHNSZXNwb25zZRJUCg1SZW1vdmVXYXRjaGVyEiAuZmlsZXN5c3RlbS5SZW1vdmVXYXRjaGVyUmVxdWVzdBohLmZpbGVzeXN0ZW0uUmVtb3ZlV2F0Y2hlclJlc3BvbnNlQmkKDmNvbS5maWxlc3lzdGVtQg9GaWxlc3lzdGVtUHJvdG9QAaICA0ZYWKoCCkZpbGVzeXN0ZW3KAgpGaWxlc3lzdGVt4gIWRmlsZXN5c3RlbVxHUEJNZXRhZGF0YeoCCkZpbGVzeXN0ZW1iBnByb3RvMw",[lT]),0),cj=((d=cj||{}).CHMOD="chmod",d.CREATE="create",d.REMOVE="remove",d.RENAME="rename",d.WRITE="write",d),cF=class{constructor(e,t,n,r){this.handleStop=e,this.events=t,this.onEvent=n,this.onExit=r,this.handleEvents()}async stop(){this.handleStop()}iterateEvents(){return u6(this,null,function*(){try{try{for(var e,t,n,r=u8(this.events);e=!(t=yield new u5(r.next())).done;e=!1){let e=t.value;"filesystem"===e.event.case&&(yield e.event)}}catch(e){n=[e]}finally{try{e&&(t=r.return)&&(yield new u5(t.call(r)))}finally{if(n)throw n[0]}}}catch(e){throw cP(e)}})}async handleEvents(){var e,t,n;try{try{for(var r,a,i,s=u8(this.iterateEvents());r=!(a=await s.next()).done;r=!1){let t=a.value,n=function(e){switch(e){case 5:return"chmod";case 1:return"create";case 3:return"remove";case 4:return"rename";case 2:return"write"}}(t.value.type);void 0!==n&&(null==(e=this.onEvent)||e.call(this,{name:t.value.name,type:n}))}}catch(e){i=[e]}finally{try{r&&(a=s.return)&&await a.call(s)}finally{if(i)throw i[0]}}null==(t=this.onExit)||t.call(this)}catch(e){null==(n=this.onExit)||n.call(this,e)}}},cV=((p=cV||{}).FILE="file",p.DIR="dir",p);function cU(e){switch(e){case 2:return"dir";case 1:return"file"}}function cL(e){if(e)return new Date(1e3*Number(e.seconds)+Math.floor(e.nanos/1e6))}var c$=class{constructor(e,t,n){this.envdApi=t,this.connectionConfig=n,this.defaultWatchTimeout=6e4,this.defaultWatchRecursive=!1,this.rpc=oq(cM,e)}async read(e,t){var n;let r=null!=(n=null==t?void 0:t.format)?n:"text",a=null==t?void 0:t.user;void 0==a&&0>o5(this.envdApi.version,cC)&&(a=cI);let i=await this.envdApi.api.GET("/files",{params:{query:{path:e,username:a}},parseAs:"bytes"===r?"arrayBuffer":r,signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)}),s=await cS(i);if(s)throw s;return"bytes"===r?new Uint8Array(i.data):"0"===i.response.headers.get("content-length")?"":i.data}async write(e,t,n){if("string"!=typeof e&&!Array.isArray(e))throw Error("Path or files are required");if("string"==typeof e&&Array.isArray(t))throw Error("Cannot specify both path and array of files. You have to specify either path and data for a single file or an array for multiple files.");let{path:r,writeOpts:a,writeFiles:i}="string"==typeof e?{path:e,writeOpts:n,writeFiles:[{data:t}]}:{path:void 0,writeOpts:t,writeFiles:e};if(0===i.length)return[];let s=await Promise.all(i.map(e=>new Response(e.data).blob())),o=null==a?void 0:a.user;void 0==o&&0>o5(this.envdApi.version,cC)&&(o=cI);let l=await this.envdApi.api.POST("/files",{params:{query:{path:r,username:o}},bodySerializer:()=>s.reduce((e,t,n)=>(e.append("file",t,i[n].path),e),new FormData),signal:this.connectionConfig.getSignal(null==n?void 0:n.requestTimeoutMs),body:{}}),u=await cS(l);if(u)throw u;let c=l.data;if(!c)throw Error("Expected to receive information about written file");return 1===c.length&&r?c[0]:c}async list(e,t){var n;if("number"==typeof(null==t?void 0:t.depth)&&t.depth<1)throw new cd("depth should be at least one");try{let r=await this.rpc.listDir({path:e,depth:null!=(n=null==t?void 0:t.depth)?n:1},{headers:cD(this.envdApi.version,null==t?void 0:t.user),signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)}),a=[];for(let e of r.entries){let t=cU(e.type);t&&a.push({name:e.name,type:t,path:e.path,size:Number(e.size),mode:e.mode,permissions:e.permissions,owner:e.owner,group:e.group,modifiedTime:cL(e.modifiedTime),symlinkTarget:e.symlinkTarget})}return a}catch(e){throw cP(e)}}async makeDir(e,t){try{return await this.rpc.makeDir({path:e},{headers:cD(this.envdApi.version,null==t?void 0:t.user),signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)}),!0}catch(e){if(e instanceof oB&&e.code===W.AlreadyExists)return!1;throw cP(e)}}async rename(e,t,n){try{let r=(await this.rpc.move({source:e,destination:t},{headers:cD(this.envdApi.version,null==n?void 0:n.user),signal:this.connectionConfig.getSignal(null==n?void 0:n.requestTimeoutMs)})).entry;if(!r)throw Error("Expected to receive information about moved object");return{name:r.name,type:cU(r.type),path:r.path,size:Number(r.size),mode:r.mode,permissions:r.permissions,owner:r.owner,group:r.group,modifiedTime:cL(r.modifiedTime),symlinkTarget:r.symlinkTarget}}catch(e){throw cP(e)}}async remove(e,t){try{await this.rpc.remove({path:e},{headers:cD(this.envdApi.version,null==t?void 0:t.user),signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)})}catch(e){throw cP(e)}}async exists(e,t){try{return await this.rpc.stat({path:e},{headers:cD(this.envdApi.version,null==t?void 0:t.user),signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)}),!0}catch(e){if(e instanceof oB&&e.code===W.NotFound)return!1;throw cP(e)}}async getInfo(e,t){try{let n=await this.rpc.stat({path:e},{headers:cD(this.envdApi.version,null==t?void 0:t.user),signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)});if(!n.entry)throw Error("Expected to receive information about the file or directory");return{name:n.entry.name,type:cU(n.entry.type),path:n.entry.path,size:Number(n.entry.size),mode:n.entry.mode,permissions:n.entry.permissions,owner:n.entry.owner,group:n.entry.group,modifiedTime:cL(n.entry.modifiedTime),symlinkTarget:n.entry.symlinkTarget}}catch(e){throw cP(e)}}async watchDir(e,t,n){var r,a,i;if((null==n?void 0:n.recursive)&&this.envdApi.version&&0>o5(this.envdApi.version,"0.1.4"))throw new cf("You need to update the template to use recursive watching. You can do this by running `e2b template build` in the directory with the template.");let s=null!=(r=null==n?void 0:n.requestTimeoutMs)?r:this.connectionConfig.requestTimeoutMs,o=new AbortController,l=s?setTimeout(()=>{o.abort()},s):void 0,u=this.rpc.watchDir({path:e,recursive:null!=(a=null==n?void 0:n.recursive)?a:this.defaultWatchRecursive},{headers:u9(u3({},cD(this.envdApi.version,null==n?void 0:n.user)),{[cT]:"50"}),signal:o.signal,timeoutMs:null!=(i=null==n?void 0:n.timeoutMs)?i:this.defaultWatchTimeout});try{return await ck(u),clearTimeout(l),new cF(()=>o.abort(),u,t,null==n?void 0:n.onExit)}catch(e){throw cP(e)}}},cB=class extends cu{constructor(e){super(e.error),this.result=e,this.name="CommandExitError"}get exitCode(){return this.result.exitCode}get error(){return this.result.error}get stdout(){return this.result.stdout}get stderr(){return this.result.stderr}},cZ=class{constructor(e,t,n,r,a,i,s){this.pid=e,this.handleDisconnect=t,this.handleKill=n,this.events=r,this.onStdout=a,this.onStderr=i,this.onPty=s,this._stdout="",this._stderr="",this._wait=this.handleEvents()}get exitCode(){var e;return null==(e=this.result)?void 0:e.exitCode}get error(){var e;return null==(e=this.result)?void 0:e.error}get stderr(){return this._stderr}get stdout(){return this._stdout}async wait(){if(await this._wait,this.iterationError)throw this.iterationError;if(!this.result)throw new cu("Process exited without a result");if(0!==this.result.exitCode)throw new cB(this.result);return this.result}async disconnect(){this.handleDisconnect()}async kill(){return await this.handleKill()}iterateEvents(){return u6(this,null,function*(){var e;try{for(var t,n,r,a=u8(this.events);t=!(n=yield new u5(a.next())).done;t=!1){let t;let r=n.value,a=null==(e=null==r?void 0:r.event)?void 0:e.event;switch(null==a?void 0:a.case){case"data":switch(a.value.output.case){case"stdout":t=new TextDecoder().decode(a.value.output.value),this._stdout+=t,yield[t,null,null];break;case"stderr":t=new TextDecoder().decode(a.value.output.value),this._stderr+=t,yield[null,t,null];break;case"pty":yield[null,null,a.value.output.value]}break;case"end":this.result={exitCode:a.value.exitCode,error:a.value.error,stdout:this.stdout,stderr:this.stderr}}}}catch(e){r=[e]}finally{try{t&&(n=a.return)&&(yield new u5(n.call(a)))}finally{if(r)throw r[0]}}})}async handleEvents(){var e,t,n;try{try{for(var r,a,i,s=u8(this.iterateEvents());r=!(a=await s.next()).done;r=!1){let[r,i,s]=a.value;null!==r?null==(e=this.onStdout)||e.call(this,r):null!==i?null==(t=this.onStderr)||t.call(this,i):s&&(null==(n=this.onPty)||n.call(this,s))}}catch(e){i=[e]}finally{try{r&&(a=s.return)&&await a.call(s)}finally{if(i)throw i[0]}}}catch(e){this.iterationError=cP(e)}}},cG=lE(l_("ChVwcm9jZXNzL3Byb2Nlc3MucHJvdG8SB3Byb2Nlc3MiSgoDUFRZEh8KBHNpemUYASABKAsyES5wcm9jZXNzLlBUWS5TaXplGiIKBFNpemUSDAoEY29scxgBIAEoDRIMCgRyb3dzGAIgASgNIqEBCg1Qcm9jZXNzQ29uZmlnEgsKA2NtZBgBIAEoCRIMCgRhcmdzGAIgAygJEi4KBGVudnMYAyADKAsyIC5wcm9jZXNzLlByb2Nlc3NDb25maWcuRW52c0VudHJ5EhAKA2N3ZBgEIAEoCUgAiAEBGisKCUVudnNFbnRyeRILCgNrZXkYASABKAkSDQoFdmFsdWUYAiABKAk6AjgBQgYKBF9jd2QiDQoLTGlzdFJlcXVlc3QiXAoLUHJvY2Vzc0luZm8SJgoGY29uZmlnGAEgASgLMhYucHJvY2Vzcy5Qcm9jZXNzQ29uZmlnEgsKA3BpZBgCIAEoDRIQCgN0YWcYAyABKAlIAIgBAUIGCgRfdGFnIjcKDExpc3RSZXNwb25zZRInCglwcm9jZXNzZXMYASADKAsyFC5wcm9jZXNzLlByb2Nlc3NJbmZvIpcBCgxTdGFydFJlcXVlc3QSJwoHcHJvY2VzcxgBIAEoCzIWLnByb2Nlc3MuUHJvY2Vzc0NvbmZpZxIeCgNwdHkYAiABKAsyDC5wcm9jZXNzLlBUWUgAiAEBEhAKA3RhZxgDIAEoCUgBiAEBEhIKBXN0ZGluGAQgASgISAKIAQFCBgoEX3B0eUIGCgRfdGFnQggKBl9zdGRpbiJiCg1VcGRhdGVSZXF1ZXN0EikKB3Byb2Nlc3MYASABKAsyGC5wcm9jZXNzLlByb2Nlc3NTZWxlY3RvchIeCgNwdHkYAiABKAsyDC5wcm9jZXNzLlBUWUgAiAEBQgYKBF9wdHkiEAoOVXBkYXRlUmVzcG9uc2UirwMKDFByb2Nlc3NFdmVudBIxCgVzdGFydBgBIAEoCzIgLnByb2Nlc3MuUHJvY2Vzc0V2ZW50LlN0YXJ0RXZlbnRIABIvCgRkYXRhGAIgASgLMh8ucHJvY2Vzcy5Qcm9jZXNzRXZlbnQuRGF0YUV2ZW50SAASLQoDZW5kGAMgASgLMh4ucHJvY2Vzcy5Qcm9jZXNzRXZlbnQuRW5kRXZlbnRIABI0CglrZWVwYWxpdmUYBCABKAsyHy5wcm9jZXNzLlByb2Nlc3NFdmVudC5LZWVwQWxpdmVIABoZCgpTdGFydEV2ZW50EgsKA3BpZBgBIAEoDRpICglEYXRhRXZlbnQSEAoGc3Rkb3V0GAEgASgMSAASEAoGc3RkZXJyGAIgASgMSAASDQoDcHR5GAMgASgMSABCCAoGb3V0cHV0GlsKCEVuZEV2ZW50EhEKCWV4aXRfY29kZRgBIAEoERIOCgZleGl0ZWQYAiABKAgSDgoGc3RhdHVzGAMgASgJEhIKBWVycm9yGAQgASgJSACIAQFCCAoGX2Vycm9yGgsKCUtlZXBBbGl2ZUIHCgVldmVudCI1Cg1TdGFydFJlc3BvbnNlEiQKBWV2ZW50GAEgASgLMhUucHJvY2Vzcy5Qcm9jZXNzRXZlbnQiNwoPQ29ubmVjdFJlc3BvbnNlEiQKBWV2ZW50GAEgASgLMhUucHJvY2Vzcy5Qcm9jZXNzRXZlbnQiYwoQU2VuZElucHV0UmVxdWVzdBIpCgdwcm9jZXNzGAEgASgLMhgucHJvY2Vzcy5Qcm9jZXNzU2VsZWN0b3ISJAoFaW5wdXQYAiABKAsyFS5wcm9jZXNzLlByb2Nlc3NJbnB1dCITChFTZW5kSW5wdXRSZXNwb25zZSI3CgxQcm9jZXNzSW5wdXQSDwoFc3RkaW4YASABKAxIABINCgNwdHkYAiABKAxIAEIHCgVpbnB1dCLCAgoSU3RyZWFtSW5wdXRSZXF1ZXN0EjcKBXN0YXJ0GAEgASgLMiYucHJvY2Vzcy5TdHJlYW1JbnB1dFJlcXVlc3QuU3RhcnRFdmVudEgAEjUKBGRhdGEYAiABKAsyJS5wcm9jZXNzLlN0cmVhbUlucHV0UmVxdWVzdC5EYXRhRXZlbnRIABI6CglrZWVwYWxpdmUYAyABKAsyJS5wcm9jZXNzLlN0cmVhbUlucHV0UmVxdWVzdC5LZWVwQWxpdmVIABo3CgpTdGFydEV2ZW50EikKB3Byb2Nlc3MYASABKAsyGC5wcm9jZXNzLlByb2Nlc3NTZWxlY3RvchoxCglEYXRhRXZlbnQSJAoFaW5wdXQYAiABKAsyFS5wcm9jZXNzLlByb2Nlc3NJbnB1dBoLCglLZWVwQWxpdmVCBwoFZXZlbnQiFQoTU3RyZWFtSW5wdXRSZXNwb25zZSJfChFTZW5kU2lnbmFsUmVxdWVzdBIpCgdwcm9jZXNzGAEgASgLMhgucHJvY2Vzcy5Qcm9jZXNzU2VsZWN0b3ISHwoGc2lnbmFsGAIgASgOMg8ucHJvY2Vzcy5TaWduYWwiFAoSU2VuZFNpZ25hbFJlc3BvbnNlIjsKDkNvbm5lY3RSZXF1ZXN0EikKB3Byb2Nlc3MYASABKAsyGC5wcm9jZXNzLlByb2Nlc3NTZWxlY3RvciI7Cg9Qcm9jZXNzU2VsZWN0b3ISDQoDcGlkGAEgASgNSAASDQoDdGFnGAIgASgJSABCCgoIc2VsZWN0b3IqSAoGU2lnbmFsEhYKElNJR05BTF9VTlNQRUNJRklFRBAAEhIKDlNJR05BTF9TSUdURVJNEA8SEgoOU0lHTkFMX1NJR0tJTEwQCTLKAwoHUHJvY2VzcxIzCgRMaXN0EhQucHJvY2Vzcy5MaXN0UmVxdWVzdBoVLnByb2Nlc3MuTGlzdFJlc3BvbnNlEj4KB0Nvbm5lY3QSFy5wcm9jZXNzLkNvbm5lY3RSZXF1ZXN0GhgucHJvY2Vzcy5Db25uZWN0UmVzcG9uc2UwARI4CgVTdGFydBIVLnByb2Nlc3MuU3RhcnRSZXF1ZXN0GhYucHJvY2Vzcy5TdGFydFJlc3BvbnNlMAESOQoGVXBkYXRlEhYucHJvY2Vzcy5VcGRhdGVSZXF1ZXN0GhcucHJvY2Vzcy5VcGRhdGVSZXNwb25zZRJKCgtTdHJlYW1JbnB1dBIbLnByb2Nlc3MuU3RyZWFtSW5wdXRSZXF1ZXN0GhwucHJvY2Vzcy5TdHJlYW1JbnB1dFJlc3BvbnNlKAESQgoJU2VuZElucHV0EhkucHJvY2Vzcy5TZW5kSW5wdXRSZXF1ZXN0GhoucHJvY2Vzcy5TZW5kSW5wdXRSZXNwb25zZRJFCgpTZW5kU2lnbmFsEhoucHJvY2Vzcy5TZW5kU2lnbmFsUmVxdWVzdBobLnByb2Nlc3MuU2VuZFNpZ25hbFJlc3BvbnNlQlcKC2NvbS5wcm9jZXNzQgxQcm9jZXNzUHJvdG9QAaICA1BYWKoCB1Byb2Nlc3PKAgdQcm9jZXNz4gITUHJvY2Vzc1xHUEJNZXRhZGF0YeoCB1Byb2Nlc3NiBnByb3RvMw"),0),cW=class{constructor(e,t,n){this.transport=e,this.connectionConfig=t,this.defaultPtyConnectionTimeout=6e4,this.rpc=oq(cG,this.transport),this.envdVersion=n.version}async create(e){var t,n,r;let a=null!=(t=null==e?void 0:e.requestTimeoutMs)?t:this.connectionConfig.requestTimeoutMs,i=null!=(n=null==e?void 0:e.envs)?n:{};i.TERM="xterm-256color";let s=new AbortController,o=setTimeout(()=>{s.abort()},a),l=this.rpc.start({process:{cmd:"/bin/bash",args:["-i","-l"],envs:i,cwd:null==e?void 0:e.cwd},pty:{size:{cols:e.cols,rows:e.rows}}},{headers:u9(u3({},cD(this.envdVersion,null==e?void 0:e.user)),{[cT]:"50"}),signal:s.signal,timeoutMs:null!=(r=null==e?void 0:e.timeoutMs)?r:this.defaultPtyConnectionTimeout});try{let t=await cN(l);return clearTimeout(o),new cZ(t,()=>s.abort(),()=>this.kill(t),l,void 0,void 0,e.onData)}catch(e){throw cP(e)}}async connect(e,t){var n,r;let a=null!=(n=null==t?void 0:t.requestTimeoutMs)?n:this.connectionConfig.requestTimeoutMs,i=new AbortController,s=a?setTimeout(()=>{i.abort()},a):void 0,o=this.rpc.connect({process:{selector:{case:"pid",value:e}}},{signal:i.signal,headers:{[cT]:"50"},timeoutMs:null!=(r=null==t?void 0:t.timeoutMs)?r:this.defaultPtyConnectionTimeout});try{let e=await cN(o);return clearTimeout(s),new cZ(e,()=>i.abort(),()=>this.kill(e),o,void 0,void 0,null==t?void 0:t.onData)}catch(e){throw cP(e)}}async sendInput(e,t,n){try{await this.rpc.sendInput({input:{input:{case:"pty",value:t}},process:{selector:{case:"pid",value:e}}},{signal:this.connectionConfig.getSignal(null==n?void 0:n.requestTimeoutMs)})}catch(e){throw cP(e)}}async resize(e,t,n){try{await this.rpc.update({process:{selector:{case:"pid",value:e}},pty:{size:t}},{signal:this.connectionConfig.getSignal(null==n?void 0:n.requestTimeoutMs)})}catch(e){throw cP(e)}}async kill(e,t){try{return await this.rpc.sendSignal({process:{selector:{case:"pid",value:e}},signal:9},{signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)}),!0}catch(e){if(e instanceof oB&&e.code===W.NotFound)return!1;throw cP(e)}}},cK=class{constructor(e,t,n){this.connectionConfig=t,this.defaultProcessConnectionTimeout=6e4,this.rpc=oq(cG,e),this.envdVersion=n.version}async list(e){try{return(await this.rpc.list({},{signal:this.connectionConfig.getSignal(null==e?void 0:e.requestTimeoutMs)})).processes.map(e=>u3(u9(u3({pid:e.pid},e.tag&&{tag:e.tag}),{args:e.config.args,envs:e.config.envs,cmd:e.config.cmd}),e.config.cwd&&{cwd:e.config.cwd}))}catch(e){throw cP(e)}}async sendStdin(e,t,n){try{await this.rpc.sendInput({process:{selector:{case:"pid",value:e}},input:{input:{case:"stdin",value:new TextEncoder().encode(t)}}},{signal:this.connectionConfig.getSignal(null==n?void 0:n.requestTimeoutMs)})}catch(e){throw cP(e)}}async kill(e,t){try{return await this.rpc.sendSignal({process:{selector:{case:"pid",value:e}},signal:9},{signal:this.connectionConfig.getSignal(null==t?void 0:t.requestTimeoutMs)}),!0}catch(e){if(e instanceof oB&&e.code===W.NotFound)return!1;throw cP(e)}}async connect(e,t){var n,r;let a=null!=(n=null==t?void 0:t.requestTimeoutMs)?n:this.connectionConfig.requestTimeoutMs,i=new AbortController,s=a?setTimeout(()=>{i.abort()},a):void 0,o=this.rpc.connect({process:{selector:{case:"pid",value:e}}},{signal:i.signal,headers:{[cT]:"50"},timeoutMs:null!=(r=null==t?void 0:t.timeoutMs)?r:this.defaultProcessConnectionTimeout});try{let e=await cN(o);return clearTimeout(s),new cZ(e,()=>i.abort(),()=>this.kill(e),o,null==t?void 0:t.onStdout,null==t?void 0:t.onStderr,void 0)}catch(e){throw cP(e)}}async run(e,t){let n=await this.start(e,t);return(null==t?void 0:t.background)?n:n.wait()}async start(e,t){var n,r;let a=null!=(n=null==t?void 0:t.requestTimeoutMs)?n:this.connectionConfig.requestTimeoutMs,i=new AbortController,s=a?setTimeout(()=>{i.abort()},a):void 0;if((null==t?void 0:t.stdin)===!1&&0>o5(this.envdVersion,"0.3.0"))throw new cu(`Sandbox envd version ${this.envdVersion} can't specify stdin, it's always turned on. Please rebuild your template if you need this feature.`);let o=this.rpc.start({process:{cmd:"/bin/bash",cwd:null==t?void 0:t.cwd,envs:null==t?void 0:t.envs,args:["-l","-c",e]},stdin:(null==t?void 0:t.stdin)||!1},{headers:u9(u3({},cD(this.envdVersion,null==t?void 0:t.user)),{[cT]:"50"}),signal:i.signal,timeoutMs:null!=(r=null==t?void 0:t.timeoutMs)?r:this.defaultProcessConnectionTimeout});try{let e=await cN(o);return clearTimeout(s),new cZ(e,()=>i.abort(),()=>this.kill(e),o,null==t?void 0:t.onStdout,null==t?void 0:t.onStderr,void 0)}catch(e){throw cP(e)}}},cY=class{constructor(){}static async kill(e,t){var n;let r=new cA(t),a=new cE(r),i=await a.api.DELETE("/sandboxes/{sandboxID}",{params:{path:{sandboxID:e}},signal:r.getSignal(null==t?void 0:t.requestTimeoutMs)});if((null==(n=i.error)?void 0:n.code)===404)return!1;let s=c_(i);if(s)throw s;return!0}static async getInfo(e,t){let n=await this.getFullInfo(e,t);return delete n.envdAccessToken,delete n.sandboxDomain,n}static async getMetrics(e,t){var n,r;let a=new cA(t),i=new cE(a),s=await i.api.GET("/sandboxes/{sandboxID}/metrics",{params:{path:{sandboxID:e,start:null==t?void 0:t.start,end:null==t?void 0:t.end}},signal:a.getSignal(null==t?void 0:t.requestTimeoutMs)}),o=c_(s);if(o)throw o;return null!=(r=null==(n=s.data)?void 0:n.map(e=>({timestamp:new Date(e.timestamp),cpuUsedPct:e.cpuUsedPct,cpuCount:e.cpuCount,memUsed:e.memUsed,memTotal:e.memTotal,diskUsed:e.diskUsed,diskTotal:e.diskTotal})))?r:[]}static async setTimeout(e,t,n){var r;let a=new cA(n),i=new cE(a),s=await i.api.POST("/sandboxes/{sandboxID}/timeout",{params:{path:{sandboxID:e}},body:{timeout:cr(t)},signal:a.getSignal(null==n?void 0:n.requestTimeoutMs)});if((null==(r=s.error)?void 0:r.code)===404)throw new cm(`Sandbox ${e} not found`);let o=c_(s);if(o)throw o}static async getFullInfo(e,t){var n,r;let a=new cA(t),i=new cE(a),s=await i.api.GET("/sandboxes/{sandboxID}",{params:{path:{sandboxID:e}},signal:a.getSignal(null==t?void 0:t.requestTimeoutMs)});if((null==(n=s.error)?void 0:n.code)===404)throw new cm(`Sandbox ${e} not found`);let o=c_(s);if(o)throw o;if(!s.data)throw Error("Sandbox not found");return u9(u3({sandboxId:s.data.sandboxID,templateId:s.data.templateID},s.data.alias&&{name:s.data.alias}),{metadata:null!=(r=s.data.metadata)?r:{},envdVersion:s.data.envdVersion,envdAccessToken:s.data.envdAccessToken,startedAt:new Date(s.data.startedAt),endAt:new Date(s.data.endAt),state:s.data.state,cpuCount:s.data.cpuCount,memoryMB:s.data.memoryMB,sandboxDomain:s.data.domain||void 0})}static async betaPause(e,t){var n,r;let a=new cA(t),i=new cE(a),s=await i.api.POST("/sandboxes/{sandboxID}/pause",{params:{path:{sandboxID:e}},signal:a.getSignal(null==t?void 0:t.requestTimeoutMs)});if((null==(n=s.error)?void 0:n.code)===404)throw new cm(`Sandbox ${e} not found`);if((null==(r=s.error)?void 0:r.code)===409)return!1;let o=c_(s);if(o)throw o;return!0}static async createSandbox(e,t,n){var r,a,i;let s=new cA(n),o=new cE(s),l=await o.api.POST("/sandboxes",{body:{autoPause:null!=(r=null==n?void 0:n.autoPause)&&r,templateID:e,metadata:null==n?void 0:n.metadata,mcp:null==n?void 0:n.mcp,envVars:null==n?void 0:n.envs,timeout:cr(t),secure:null==(a=null==n?void 0:n.secure)||a,allow_internet_access:null==(i=null==n?void 0:n.allowInternetAccess)||i,network:null==n?void 0:n.network},signal:s.getSignal(null==n?void 0:n.requestTimeoutMs)}),u=c_(l);if(u)throw u;if(0>o5(l.data.envdVersion,"0.1.0"))throw await this.kill(l.data.sandboxID,n),new cf("You need to update the template to use the new SDK. You can do this by running `e2b template build` in the directory with the template.");return{sandboxId:l.data.sandboxID,sandboxDomain:l.data.domain||void 0,envdVersion:l.data.envdVersion,envdAccessToken:l.data.envdAccessToken,trafficAccessToken:l.data.trafficAccessToken||void 0}}static async connectSandbox(e,t){var n,r;let a=null!=(n=null==t?void 0:t.timeoutMs)?n:3e5,i=new cA(t),s=new cE(i),o=await s.api.POST("/sandboxes/{sandboxID}/connect",{params:{path:{sandboxID:e}},body:{timeout:cr(a)},signal:i.getSignal(null==t?void 0:t.requestTimeoutMs)});if((null==(r=o.error)?void 0:r.code)===404)throw new cm(`Paused sandbox ${e} not found`);let l=c_(o);if(l)throw l;return{sandboxId:o.data.sandboxID,sandboxDomain:o.data.domain||void 0,envdVersion:o.data.envdVersion,envdAccessToken:o.data.envdAccessToken,trafficAccessToken:o.data.trafficAccessToken||void 0}}},cX=class{constructor(e){this.config=new cA(e),this.client=new cE(this.config),this._hasNext=!0,this._nextToken=null==e?void 0:e.nextToken,this.query=null==e?void 0:e.query,this.limit=null==e?void 0:e.limit}get hasNext(){return this._hasNext}get nextToken(){return this._nextToken}async nextItems(){var e,t,n;let r;if(!this.hasNext)throw Error("No more items to fetch");(null==(e=this.query)?void 0:e.metadata)&&(r=new URLSearchParams(Object.fromEntries(Object.entries(this.query.metadata).map(([e,t])=>[encodeURIComponent(e),encodeURIComponent(t)]))).toString());let a=await this.client.api.GET("/v2/sandboxes",{params:{query:{metadata:r,state:null==(t=this.query)?void 0:t.state,limit:this.limit,nextToken:this.nextToken}},signal:this.config.getSignal()}),i=c_(a);if(i)throw i;return this._nextToken=a.response.headers.get("x-next-token")||void 0,this._hasNext=!!this._nextToken,(null!=(n=a.data)?n:[]).map(e=>{var t;return u9(u3({sandboxId:e.sandboxID,templateId:e.templateID},e.alias&&{name:e.alias}),{metadata:null!=(t=e.metadata)?t:{},startedAt:new Date(e.startedAt),endAt:new Date(e.endAt),state:e.state,cpuCount:e.cpuCount,memoryMB:e.memoryMB,envdVersion:e.envdVersion})})}},cJ=class extends cY{constructor(e){var t;super(),this.envdPort=49983,this.mcpPort=50005,this.connectionConfig=new cA(e),this.sandboxId=e.sandboxId,this.sandboxDomain=null!=(t=e.sandboxDomain)?t:this.connectionConfig.domain,this.envdAccessToken=e.envdAccessToken,this.trafficAccessToken=e.trafficAccessToken,this.envdApiUrl=this.connectionConfig.getSandboxUrl(this.sandboxId,{sandboxDomain:this.sandboxDomain,envdPort:this.envdPort});let n={"E2b-Sandbox-Id":this.sandboxId,"E2b-Sandbox-Port":this.envdPort.toString()},r=function(e){var t;!function(){try{new Headers}catch(e){throw Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}();let n=null!==(t=e.useBinaryFormat)&&void 0!==t&&t;return{async unary(t,r,a,i,s,o){let{serialize:l,parse:u}=l8(t,n,e.jsonOptions,e.binaryOptions);return a=void 0===a?e.defaultTimeoutMs:a<=0?void 0:a,await function(e){let t=ut(e.next,e.interceptors),[n,r,a]=ur(e);return t(Object.assign(Object.assign({},e.req),{message:s4(e.req.method.input,e.req.message),signal:n})).then(e=>(a(),e),r)}({interceptors:e.interceptors,signal:r,timeoutMs:a,req:{stream:!1,service:t.parent,method:t,requestMethod:"POST",url:ua(e.baseUrl,t),header:uc(t.methodKind,n,a,i,!1),contextValues:null!=o?o:lH(),message:s},next:async r=>{var a;let i=!0===e.useHttpGet&&t.idempotency===en.NO_SIDE_EFFECTS,s=null;i?r=function(e,t,n){let r="?connect=v1",a=e.header.get(ui);(null==a?void 0:a.indexOf(ud))===0&&(r+="&encoding="+encodeURIComponent(a.slice(ud.length)));let i=e.header.get(us);null!==i&&"identity"!==i&&(r+="&compression="+encodeURIComponent(i),n=!0),n&&(r+="&base64=1"),r+="&message="+(n?o8(t,"url"):encodeURIComponent(new TextDecoder().decode(t)));let s=e.url+r,o=new Headers(e.header);return[uo,ui,"Content-Length",us,"Accept-Encoding"].forEach(e=>o.delete(e)),Object.assign(Object.assign({},e),{requestMethod:"GET",url:s,header:o})}(r,l(r.message),n):s=l(r.message);let o=null!==(a=e.fetch)&&void 0!==a?a:globalThis.fetch,c=await o(r.url,Object.assign(Object.assign({},uy),{method:r.requestMethod,headers:r.header,signal:r.signal,body:s})),{isUnaryError:d,unaryError:p}=up(t.methodKind,n,c.status,c.headers);if(d)throw um(await c.json(),function(...e){let t=new Headers;for(let n of e)n.forEach((e,n)=>{t.append(n,e)});return t}(...uh(c.headers)),p);let[m,h]=uh(c.headers);return{stream:!1,service:t.parent,method:t,header:m,message:n?u(new Uint8Array(await c.arrayBuffer())):lL(t.output,await c.json(),l6(e.jsonOptions)),trailer:h}}})},async stream(t,r,a,i,s,o){let{serialize:l,parse:u}=l8(t,n,e.jsonOptions,e.binaryOptions);async function c(e){if("server_streaming"!=t.methodKind)throw"The fetch API does not support streaming request bodies";let n=await e[Symbol.asyncIterator]().next();if(!0==n.done)throw"missing request message";return function(e,t){let n=new Uint8Array(t.length+5);n.set(t,5);let r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.setUint8(0,0),r.setUint32(1,t.length),n}(0,l(n.value))}return a=void 0===a?e.defaultTimeoutMs:a<=0?void 0:a,await function(e){let t=ut(e.next,e.interceptors),[n,r,a]=ur(e),i=Object.assign(Object.assign({},e.req),{message:function(e,t){function n(t){return!0===t.done?t:{done:t.done,value:s4(e,t.value)}}return{[Symbol.asyncIterator](){let e=t[Symbol.asyncIterator](),r={next:()=>e.next().then(n)};return void 0!==e.throw&&(r.throw=t=>e.throw(t).then(n)),void 0!==e.return&&(r.return=t=>e.return(t).then(n)),r}}}(e.req.method.input,e.req.message),signal:n}),s=!1;return n.addEventListener("abort",function(){var t,n;let r=e.req.message[Symbol.asyncIterator]();s||null===(t=r.throw)||void 0===t||t.call(r,this.reason).catch(()=>{}),null===(n=r.return)||void 0===n||n.call(r).catch(()=>{})}),t(i).then(e=>Object.assign(Object.assign({},e),{message:{[Symbol.asyncIterator](){let t=e.message[Symbol.asyncIterator]();return{next:()=>t.next().then(e=>(!0==e.done&&(s=!0,a()),e),r)}}}}),r)}({interceptors:e.interceptors,timeoutMs:a,signal:r,req:{stream:!0,service:t.parent,method:t,requestMethod:"POST",url:ua(e.baseUrl,t),header:uc(t.methodKind,n,a,i,!1),contextValues:null!=o?o:lH(),message:s},next:async r=>{var a;let i=null!==(a=e.fetch)&&void 0!==a?a:globalThis.fetch,s=await i(r.url,Object.assign(Object.assign({},uy),{method:r.requestMethod,headers:r.header,signal:r.signal,body:await c(r.message)}));if(up(t.methodKind,n,s.status,s.headers),null===s.body)throw"missing response body";let o=new Headers;return Object.assign(Object.assign({},r),{header:s.headers,trailer:o,message:function(e,t,n,r){return ug(this,arguments,function*(){let a,i;let s=(i=new Uint8Array(0),new ReadableStream({start(){a=e.getReader()},async pull(e){let t;for(;;){if(void 0===t&&i.byteLength>=5){let e=0;for(let t=1;t<5;t++)e=(e<<8)+i[t];t={flags:i[0],length:e}}if(void 0!==t&&i.byteLength>=t.length+5)break;let e=await a.read();if(e.done)break;!function(e){let t=new Uint8Array(i.length+e.length);t.set(i),t.set(e,i.length),i=t}(e.value)}if(void 0===t){if(0==i.byteLength){e.close();return}e.error(new oB("premature end of stream",W.DataLoss));return}let n=i.subarray(5,5+t.length);i=i.subarray(5+t.length),e.enqueue({flags:t.flags,data:n})}})).getReader(),o=!1;for(;;){let e=yield uf(s.read());if(e.done)break;let{flags:r,data:a}=e.value;if((1&r)==1)throw new oB("protocol error: received unsupported compressed output",W.Internal);if((2&r)==2){o=!0;let e=function(e){let t;let n=new oB("invalid end stream",W.Unknown);try{t=JSON.parse("string"==typeof e?e:new TextDecoder().decode(e))}catch(e){throw n}if("object"!=typeof t||null==t||Array.isArray(t))throw n;let r=new Headers;if("metadata"in t){if("object"!=typeof t.metadata||null==t.metadata||Array.isArray(t.metadata))throw n;for(let[e,a]of Object.entries(t.metadata)){if(!Array.isArray(a)||a.some(e=>"string"!=typeof e))throw n;for(let t of a)r.append(e,t)}}let a="error"in t&&null!=t.error?um(t.error,r,n):void 0;return{metadata:r,error:a}}(a);if(e.error){let t=e.error;throw n.forEach((e,n)=>{t.metadata.append(n,e)}),t}e.metadata.forEach((e,n)=>t.set(n,e));continue}yield yield uf(u(a))}if("throwIfAborted"in r&&r.throwIfAborted(),!o)throw"missing EndStreamResponse"})}(s.body,o,s.headers,r.signal)})}})}}}({baseUrl:this.envdApiUrl,useBinaryFormat:!1,interceptors:(null==e?void 0:e.logger)?[function(e){return t=>async n=>{var r,a;null==(r=e.info)||r.call(e,`Request: POST ${n.url}`);let i=await t(n);return i.stream?u9(u3({},i),{message:function(t){return u6(this,null,function*(){var n;try{for(var r,a,i,s=u8(t);r=!(a=yield new u5(s.next())).done;r=!1){let t=a.value;null==(n=e.debug)||n.call(e,"Response stream:",cv(t)),yield t}}catch(e){i=[e]}finally{try{r&&(a=s.return)&&(yield new u5(a.call(s)))}finally{if(i)throw i[0]}}})}(i.message)}):(null==(a=e.info)||a.call(e,"Response:",cv(i.message)),i)}}(e.logger)]:void 0,fetch:(e,t)=>{let r=new Headers(this.connectionConfig.headers);return new Headers(null==t?void 0:t.headers).forEach((e,t)=>r.append(t,e)),new Headers(n).forEach((e,t)=>r.append(t,e)),this.envdAccessToken&&r.append("X-Access-Token",this.envdAccessToken),fetch(e,t=u9(u3({},null!=t?t:{}),{headers:r,redirect:"follow"}))}});this.envdApi=new cR({apiUrl:this.envdApiUrl,logger:null==e?void 0:e.logger,accessToken:this.envdAccessToken,headers:this.envdAccessToken?{"X-Access-Token":this.envdAccessToken}:{}},{version:e.envdVersion}),this.files=new c$(r,this.envdApi,this.connectionConfig),this.commands=new cK(r,this.connectionConfig,{version:e.envdVersion}),this.pty=new cW(r,this.connectionConfig,{version:e.envdVersion})}static list(e){return new cX(e)}static async create(e,t){var n,r;let{template:a,sandboxOpts:i}="string"==typeof e?{template:e,sandboxOpts:t}:{template:(null==e?void 0:e.mcp)?this.defaultMcpTemplate:this.defaultTemplate,sandboxOpts:e},s=new cA(i);if(s.debug)return new this(u3({sandboxId:"debug_sandbox_id",envdVersion:cO},s));let o=new this(u3(u3({},await cY.createSandbox(a,null!=(n=null==i?void 0:i.timeoutMs)?n:this.defaultSandboxTimeoutMs,i)),s));if(null==i?void 0:i.mcp){o.mcpToken=crypto.randomUUID();let e=await o.commands.run(`mcp-gateway --config '${JSON.stringify(null==i?void 0:i.mcp)}'`,{user:"root",envs:{GATEWAY_ACCESS_TOKEN:null!=(r=o.mcpToken)?r:""}});if(0!==e.exitCode)throw Error(`Failed to start MCP gateway: ${e.stderr}`)}return o}static async betaCreate(e,t){var n,r;let{template:a,sandboxOpts:i}="string"==typeof e?{template:e,sandboxOpts:t}:{template:(null==e?void 0:e.mcp)?this.defaultMcpTemplate:this.defaultTemplate,sandboxOpts:e},s=new cA(i);if(s.debug)return new this(u3({sandboxId:"debug_sandbox_id",envdVersion:cO},s));let o=new this(u3(u3({},await cY.createSandbox(a,null!=(n=null==i?void 0:i.timeoutMs)?n:this.defaultSandboxTimeoutMs,i)),s));if(null==i?void 0:i.mcp){o.mcpToken=crypto.randomUUID();let e=await o.commands.run(`mcp-gateway --config '${JSON.stringify(null==i?void 0:i.mcp)}'`,{user:"root",envs:{GATEWAY_ACCESS_TOKEN:null!=(r=o.mcpToken)?r:""}});if(0!==e.exitCode)throw Error(`Failed to start MCP gateway: ${e.stderr}`)}return o}static async connect(e,t){let n=await cY.connectSandbox(e,t),r=new cA(t);return new this(u3({sandboxId:e,sandboxDomain:n.sandboxDomain,envdAccessToken:n.envdAccessToken,trafficAccessToken:n.trafficAccessToken,envdVersion:n.envdVersion},r))}async connect(e){return await cY.connectSandbox(this.sandboxId,e),this}getHost(e){return this.connectionConfig.getHost(this.sandboxId,e,this.sandboxDomain)}async isRunning(e){let t=this.connectionConfig.getSignal(null==e?void 0:e.requestTimeoutMs),n=await this.envdApi.api.GET("/health",{signal:t});if(502==n.response.status)return!1;let r=await cS(n);if(r)throw r;return!0}async setTimeout(e,t){this.connectionConfig.debug||await cY.setTimeout(this.sandboxId,e,u3(u3({},this.connectionConfig),t))}async kill(e){this.connectionConfig.debug||await cY.kill(this.sandboxId,u3(u3({},this.connectionConfig),e))}async betaPause(e){return await cY.betaPause(this.sandboxId,e)}getMcpUrl(){return`https://${this.getHost(this.mcpPort)}/mcp`}async getMcpToken(){return this.mcpToken||(this.mcpToken=await this.files.read("/etc/mcp-gateway/.token",{user:"root"})),this.mcpToken}async uploadUrl(e,t){t=null!=t?t:{};let n=!!this.envdAccessToken;if(!n&&void 0!=t.useSignatureExpiration)throw Error("Signature expiration can be used only when sandbox is created as secured.");let r=t.user;void 0==r&&0>o5(this.envdApi.version,cC)&&(r=cI);let a=null!=e?e:"",i=this.fileUrl(a,r);if(n){let e=new URL(i),n=await cx({path:a,operation:"write",user:r,expirationInSeconds:t.useSignatureExpiration,envdAccessToken:this.envdAccessToken});return e.searchParams.set("signature",n.signature),n.expiration&&e.searchParams.set("signature_expiration",n.expiration.toString()),e.toString()}return i}async downloadUrl(e,t){t=null!=t?t:{};let n=!!this.envdAccessToken;if(!n&&void 0!=t.useSignatureExpiration)throw Error("Signature expiration can be used only when sandbox is created as secured.");let r=t.user;void 0==r&&0>o5(this.envdApi.version,cC)&&(r=cI);let a=this.fileUrl(e,r);if(n){let n=new URL(a),i=await cx({path:e,operation:"read",user:r,expirationInSeconds:t.useSignatureExpiration,envdAccessToken:this.envdAccessToken});return n.searchParams.set("signature",i.signature),i.expiration&&n.searchParams.set("signature_expiration",i.expiration.toString()),n.toString()}return a}async getInfo(e){return await cY.getInfo(this.sandboxId,u3(u3({},this.connectionConfig),e))}async getMetrics(e){var t,n;if(this.envdApi.version){if(0>o5(this.envdApi.version,"0.1.5"))throw new cu("You need to update the template to use the new SDK. You can do this by running `e2b template build` in the directory with the template.");0>o5(this.envdApi.version,"0.2.4")&&(null==(n=null==(t=this.connectionConfig.logger)?void 0:t.warn)||n.call(t,"Disk metrics are not supported in this version of the sandbox, please rebuild the template to get disk metrics."))}return await cY.getMetrics(this.sandboxId,u3(u3({},this.connectionConfig),e))}fileUrl(e,t){let n=new URL("/files",this.envdApiUrl);return t&&n.searchParams.set("username",t),e&&n.searchParams.set("path",e),n.toString()}};cJ.defaultTemplate="base",cJ.defaultMcpTemplate="mcp-gateway",cJ.defaultSandboxTimeoutMs=3e5;var cz=class{constructor(e,t,n){this.timestamp=e,this.level=t,this.message=n}toString(){return`[${this.timestamp.toISOString()}] [${this.level}] ${ci(this.message)}`}},cq=class extends cz{constructor(e,t){super(e,"debug",t)}},cH=class extends cz{constructor(e,t){super(e,"debug",t)}};function cQ(e){let t=uY.join(e,".dockerignore");return uK.existsSync(t)?uK.readFileSync(t,"utf-8").split("\n").map(e=>e.trim()).filter(e=>e&&!e.startsWith("#")):[]}async function c0(e,t,n,r=!0){let{glob:a}=await ca("glob"),i=new Map;for(let s of(await a(e,{ignore:n,withFileTypes:!0,cwd:t})))if(s.isDirectory()){r&&i.set(s.fullpath(),s);let e=uY.join(s.relative()||".","**/*").replace(/\\/g,"/");(await a(e,{ignore:n,withFileTypes:!0,cwd:t})).forEach(e=>i.set(e.fullpath(),e))}else i.set(s.fullpath(),s);return Array.from(i.values()).sort()}async function c1(e,t,n,r,a,i){let s=uY.join(n,e),o=uW.createHash("sha256"),l=`COPY ${e} ${t}`;o.update(l);let u=await c0(e,n,r,!0);if(0===u.length){let e=Error(`No files found in ${s}`);throw i&&(e.stack=i),e}let c=e=>{o.update(e.mode.toString()),o.update(e.size.toString())};for(let e of u){let t=e.relativePosix();if(o.update(t),e.isSymbolicLink()){let t=uK.statSync(e.fullpath(),{throwIfNoEntry:!1});if(!(a&&((null==t?void 0:t.isFile())||(null==t?void 0:t.isDirectory())))){c(uK.lstatSync(e.fullpath()));let t=uK.readlinkSync(e.fullpath());o.update(t);continue}}let n=uK.statSync(e.fullpath());if(c(n),n.isFile()){let t=uK.readFileSync(e.fullpath());o.update(new Uint8Array(t))}}return o.digest("hex")}function c2(e){let t=Error().stack;if(!t)return;let n=t.split("\n").slice(1);if(!(n.length<e+1))return n.slice(e).join("\n")}function c3(e){return e.toString(8).padStart(4,"0")}async function c9(e,t,n,r){let{create:a}=await ca("tar"),i=(await c0(e,t,n,!0)).map(e=>e.relativePosix());return a({gzip:!0,cwd:t,follow:r,noDirRecurse:!0},i)}async function c4(e,t,n,r){let a=await c9(e,t,n,r),i=0;try{for(var s,o,l,u=u8(a);s=!(o=await u.next()).done;s=!1){let e=o.value;i+=e.length}}catch(e){l=[e]}finally{try{s&&(o=u.return)&&await o.call(u)}finally{if(l)throw l[0]}}return{contentLength:i,uploadStream:await c9(e,t,n,r)}}async function c5(e,{alias:t,cpuCount:n,memoryMB:r}){let a=await e.api.POST("/v3/templates",{body:{alias:t,cpuCount:n,memoryMB:r}}),i=c_(a,cy);if(i)throw i;if(!a.data)throw new cy("Failed to request build");return a.data}async function c6(e,{templateID:t,filesHash:n},r){let a=await e.api.GET("/templates/{templateID}/files/{hash}",{params:{path:{templateID:t,hash:n}}}),i=c_(a,cb,r);if(i)throw i;if(!a.data)throw new cb("Failed to get file upload link",r);return a.data}async function c8(e,t){let{fileName:n,url:r,fileContextPath:a,ignorePatterns:i,resolveSymlinks:s}=e;try{let{contentLength:e,uploadStream:o}=await c4(n,a,i,s),l=await fetch(r,{method:"PUT",body:o,headers:{"Content-Length":e.toString()},duplex:"half"});if(!l.ok)throw new cb(`Failed to upload file: ${l.statusText}`,t)}catch(e){if(e instanceof cb)throw e;throw new cb(`Failed to upload file: ${e}`,t)}}async function c7(e,{templateID:t,buildID:n,template:r}){let a=c_(await e.api.POST("/v2/templates/{templateID}/builds/{buildID}",{params:{path:{templateID:t,buildID:n}},body:r}),cy);if(a)throw a}async function de(e,{templateID:t,buildID:n,logsOffset:r}){let a=await e.api.GET("/templates/{templateID}/builds/{buildID}/status",{params:{path:{templateID:t,buildID:n},query:{logsOffset:r}}}),i=c_(a,cy);if(i)throw i;if(!a.data)throw new cy("Failed to get build status");return a.data}async function dt(e,{templateID:t,buildID:n,onBuildLogs:r,logsRefreshFrequency:a,stackTraces:i}){var s,o,l,u,c;let d=0,p="building";for(;"building"===p||"waiting"===p;){let m=await de(e,{templateID:t,buildID:n,logsOffset:d});switch(d+=m.logEntries.length,m.logEntries.forEach(e=>null==r?void 0:r(new cz(new Date(e.timestamp),e.level,ci(e.message)))),p=m.status){case"ready":return;case"waiting":break;case"error":{let e;if((null==(s=m.reason)?void 0:s.step)!==void 0){let t=(u=m.reason.step,c=i.length,"base"===u?0:"finalize"===u?c-1:Number(u));e=i[t]}throw new cy(null!=(l=null==(o=null==m?void 0:m.reason)?void 0:o.message)?l:"Unknown error",e)}}await new Promise(e=>setTimeout(e,a))}throw new cy("Unknown build error occurred.")}uG.red("ERROR"),uG.hex("#FF4400")("WARN "),uG.hex("#FF8800")("INFO "),uG.gray("DEBUG");var dn=class{constructor(e){this.cmd=e}getCmd(){return this.cmd}},dr=class{constructor(e){var t,n;this.defaultBaseImage="e2bdev/base",this.baseImage=this.defaultBaseImage,this.baseTemplate=void 0,this.registryConfig=void 0,this.startCmd=void 0,this.readyCmd=void 0,this.force=!1,this.forceNextLayer=!1,this.instructions=[],this.fileContextPath="browser"===ce?".":null!=(eg=function(e){let t=function(e){let t=Error.prepareStackTrace;try{let e=[];return Error.prepareStackTrace=(t,n)=>{let r=n.slice(4);return e=r,r},Error().stack,e}finally{Error.prepareStackTrace=t}}(0);if(0===t.length)return;let n=t[0].getFileName();if(n){if(n.startsWith("file:")){let{fileURLToPath:e}=function(e){if("browser"===ce)throw Error("Browser runtime is not supported for require");return u4(e)}("node:url");n=e(n)}return uY.dirname(n)}}(0))?eg:".",this.fileIgnorePatterns=[],this.logsRefreshFrequency=200,this.stackTraces=[],this.stackTracesEnabled=!0,this.stackTracesOverride=void 0,this.fileContextPath=null!=(t=null==e?void 0:e.fileContextPath)?t:this.fileContextPath,this.fileIgnorePatterns=null!=(n=null==e?void 0:e.fileIgnorePatterns)?n:this.fileIgnorePatterns}static toJSON(e,t=!0){return e.toJSON(t)}static toDockerfile(e){return e.toDockerfile()}static async build(e,t){var n,r,a;try{null==(n=t.onBuildLogs)||n.call(t,new cq(new Date,"Build started"));let a=new cA({domain:t.domain,apiKey:t.apiKey}),i=new cE(a),s=await e.build(i,t);return null==(r=t.onBuildLogs)||r.call(t,new cz(new Date,"info","Waiting for logs...")),await dt(i,{templateID:s.templateId,buildID:s.buildId,onBuildLogs:t.onBuildLogs,logsRefreshFrequency:e.logsRefreshFrequency,stackTraces:e.stackTraces}),s}finally{null==(a=t.onBuildLogs)||a.call(t,new cH(new Date,"Build finished"))}}static async buildInBackground(e,t){let n=new cE(new cA({domain:t.domain,apiKey:t.apiKey}));return await e.build(n,t)}static async getBuildStatus(e,t){let n=new cE(new cA({domain:null==t?void 0:t.domain,apiKey:null==t?void 0:t.apiKey}));return await de(n,{templateID:e.templateId,buildID:e.buildId,logsOffset:null==t?void 0:t.logsOffset})}fromDebianImage(e="stable"){return this.fromImage(`debian:${e}`)}fromUbuntuImage(e="latest"){return this.fromImage(`ubuntu:${e}`)}fromPythonImage(e="3"){return this.fromImage(`python:${e}`)}fromNodeImage(e="lts"){return this.fromImage(`node:${e}`)}fromBunImage(e="latest"){return this.fromImage(`oven/bun:${e}`)}fromBaseImage(){return this.fromImage(this.defaultBaseImage)}fromImage(e,t){return this.baseImage=e,this.baseTemplate=void 0,t&&(this.registryConfig={type:"registry",username:t.username,password:t.password}),this.forceNextLayer&&(this.force=!0),this.collectStackTrace(),this}fromTemplate(e){return this.baseTemplate=e,this.baseImage=void 0,this.forceNextLayer&&(this.force=!0),this.collectStackTrace(),this}fromDockerfile(e){let{baseImage:t}=this.runInStackTraceOverrideContext(()=>(function(e,t){let n;try{n=uK.existsSync(e)&&uK.statSync(e).isFile()?uK.readFileSync(e,"utf-8"):e}catch(t){n=e}let r=uX.DockerfileParser.parse(n).getInstructions(),a=r.filter(e=>"FROM"===e.getKeyword());if(a.length>1)throw Error("Multi-stage Dockerfiles are not supported");if(0===a.length)throw Error("Dockerfile must contain a FROM instruction");let i=a[0].getArguments(),s="e2bdev/base",o=!1,l=!1;for(let e of(i&&i.length>0&&(s=i[0].getValue()),t.setUser("root"),t.setWorkdir("/"),r)){let n=e.getKeyword();switch(n){case"FROM":case"EXPOSE":case"VOLUME":break;case"RUN":(function(e,t){let n=e.getArguments();if(n&&n.length>0){let e=n.map(e=>e.getValue()).join(" ");t.runCmd(e)}})(e,t);break;case"COPY":case"ADD":(function(e,t){let n=e.getArguments();if(n&&n.length>=2){let e=n[0].getValue(),r=n[n.length-1].getValue();t.copy(e,r)}})(e,t);break;case"WORKDIR":(function(e,t){let n=e.getArguments();if(n&&n.length>0){let e=n[0].getValue();t.setWorkdir(e)}})(e,t),l=!0;break;case"USER":(function(e,t){let n=e.getArguments();if(n&&n.length>0){let e=n[0].getValue();t.setUser(e)}})(e,t),o=!0;break;case"ENV":case"ARG":(function(e,t){let n=e.getArguments(),r=e.getKeyword();if(n&&n.length>=1){let e={};if(2===n.length){let t=n[0].getValue(),r=n[1].getValue();if(t.includes("=")&&r.includes("="))for(let t of n){let n=t.getValue(),r=n.indexOf("=");if(r>0){let t=n.substring(0,r),a=n.substring(r+1);e[t]=a}}else e[t]=r}else if(1===n.length){let t=n[0].getValue(),a=t.indexOf("=");if(a>0){let n=t.substring(0,a),r=t.substring(a+1);e[n]=r}else"ARG"===r&&t.trim()&&(e[t.trim()]="")}else for(let t of n){let n=t.getValue(),a=n.indexOf("=");if(a>0){let t=n.substring(0,a),r=n.substring(a+1);e[t]=r}else"ARG"===r&&(e[n]="")}Object.keys(e).length>0&&t.setEnvs(e)}})(e,t);break;case"CMD":case"ENTRYPOINT":(function(e,t){let n=e.getArguments();if(n&&n.length>0){let e=n.map(e=>e.getValue()).join(" ");try{let t=JSON.parse(e);Array.isArray(t)&&(e=t.join(" "))}catch(e){}t.setStartCmd(e,new dn(`sleep ${Math.max(1,Math.floor(20))}`))}})(e,t);break;default:console.warn(`Unsupported instruction: ${n}`)}}return o||t.setUser("user"),l||t.setWorkdir("/home/user"),{baseImage:s}})(e,this),c2(2));return this.baseImage=t,this.baseTemplate=void 0,this.forceNextLayer&&(this.force=!0),this.collectStackTrace(),this}fromAWSRegistry(e,t){return this.baseImage=e,this.baseTemplate=void 0,this.registryConfig={type:"aws",awsAccessKeyId:t.accessKeyId,awsSecretAccessKey:t.secretAccessKey,awsRegion:t.region},this.forceNextLayer&&(this.force=!0),this.collectStackTrace(),this}fromGCPRegistry(e,t){var n,r;return this.baseImage=e,this.baseTemplate=void 0,this.registryConfig={type:"gcp",serviceAccountJson:(n=this.fileContextPath.toString(),"string"==typeof(r=t.serviceAccountJSON)?uK.readFileSync(uY.join(n,r),"utf-8"):JSON.stringify(r))},this.forceNextLayer&&(this.force=!0),this.collectStackTrace(),this}copy(e,t,n){var r;if("browser"===ce)throw Error("Browser runtime is not supported for copy");for(let a of Array.isArray(e)?e:[e]){let e=[a.toString(),t.toString(),null!=(r=null==n?void 0:n.user)?r:"",(null==n?void 0:n.mode)?c3(n.mode):""];this.instructions.push({type:"COPY",args:e,force:(null==n?void 0:n.forceUpload)||this.forceNextLayer,forceUpload:null==n?void 0:n.forceUpload,resolveSymlinks:null==n?void 0:n.resolveSymlinks})}return this.collectStackTrace(),this}copyItems(e){if("browser"===ce)throw Error("Browser runtime is not supported for copyItems");return this.runInNewStackTraceContext(()=>{for(let t of e)this.copy(t.src,t.dest,{forceUpload:t.forceUpload,user:t.user,mode:t.mode,resolveSymlinks:t.resolveSymlinks})}),this}remove(e,t){let n=Array.isArray(e)?e:[e],r=["rm"];return(null==t?void 0:t.recursive)&&r.push("-r"),(null==t?void 0:t.force)&&r.push("-f"),r.push(...n.map(e=>e.toString())),this.runInNewStackTraceContext(()=>this.runCmd(r.join(" "),{user:null==t?void 0:t.user}))}rename(e,t,n){let r=["mv",e.toString(),t.toString()];return(null==n?void 0:n.force)&&r.push("-f"),this.runInNewStackTraceContext(()=>this.runCmd(r.join(" "),{user:null==n?void 0:n.user}))}makeDir(e,t){let n=Array.isArray(e)?e:[e],r=["mkdir","-p"];return(null==t?void 0:t.mode)&&r.push(`-m ${c3(t.mode)}`),r.push(...n.map(e=>e.toString())),this.runInNewStackTraceContext(()=>this.runCmd(r.join(" "),{user:null==t?void 0:t.user}))}makeSymlink(e,t,n){let r=["ln","-s"];return(null==n?void 0:n.force)&&r.push("-f"),r.push(e.toString(),t.toString()),this.runInNewStackTraceContext(()=>this.runCmd(r.join(" "),{user:null==n?void 0:n.user}))}runCmd(e,t){let n=[(Array.isArray(e)?e:[e]).join(" && ")];return(null==t?void 0:t.user)&&n.push(t.user),this.instructions.push({type:"RUN",args:n,force:this.forceNextLayer}),this.collectStackTrace(),this}setWorkdir(e){return this.instructions.push({type:"WORKDIR",args:[e.toString()],force:this.forceNextLayer}),this.collectStackTrace(),this}setUser(e){return this.instructions.push({type:"USER",args:[e],force:this.forceNextLayer}),this.collectStackTrace(),this}pipInstall(e,t){var n;let r=null==(n=null==t?void 0:t.g)||n,a=["pip","install"],i=e?Array.isArray(e)?e:[e]:void 0;return!1===r&&a.push("--user"),i?a.push(...i):a.push("."),this.runInNewStackTraceContext(()=>this.runCmd(a.join(" "),{user:r?"root":void 0}))}npmInstall(e,t){let n=["npm","install"],r=e?Array.isArray(e)?e:[e]:void 0;return(null==t?void 0:t.g)&&n.push("-g"),(null==t?void 0:t.dev)&&n.push("--save-dev"),r&&n.push(...r),this.runInNewStackTraceContext(()=>this.runCmd(n.join(" "),{user:(null==t?void 0:t.g)?"root":void 0}))}bunInstall(e,t){let n=["bun","install"],r=e?Array.isArray(e)?e:[e]:void 0;return(null==t?void 0:t.g)&&n.push("-g"),(null==t?void 0:t.dev)&&n.push("--dev"),r&&n.push(...r),this.runInNewStackTraceContext(()=>this.runCmd(n.join(" "),{user:(null==t?void 0:t.g)?"root":void 0}))}aptInstall(e,t){let n=Array.isArray(e)?e:[e];return this.runInNewStackTraceContext(()=>this.runCmd(["apt-get update",`DEBIAN_FRONTEND=noninteractive DEBCONF_NOWARNINGS=yes apt-get install -y ${(null==t?void 0:t.noInstallRecommends)?"--no-install-recommends ":""}${n.join(" ")}`],{user:"root"}))}addMcpServer(e){if("mcp-gateway"!==this.baseTemplate)throw new cy("MCP servers can only be added to mcp-gateway template",c2(2));let t=Array.isArray(e)?e:[e];return this.runInNewStackTraceContext(()=>this.runCmd(`mcp-gateway pull ${t.join(" ")}`,{user:"root"}))}gitClone(e,t,n){let r=["git","clone",e];return(null==n?void 0:n.branch)&&(r.push(`--branch ${n.branch}`),r.push("--single-branch")),(null==n?void 0:n.depth)&&r.push(`--depth ${n.depth}`),t&&r.push(t.toString()),this.runInNewStackTraceContext(()=>this.runCmd(r.join(" "),{user:null==n?void 0:n.user}))}setStartCmd(e,t){return this.startCmd=e,t instanceof dn?this.readyCmd=t.getCmd():this.readyCmd=t,this.collectStackTrace(),this}setReadyCmd(e){return e instanceof dn?this.readyCmd=e.getCmd():this.readyCmd=e,this.collectStackTrace(),this}setEnvs(e){return 0===Object.keys(e).length||(this.instructions.push({type:"ENV",args:Object.entries(e).flatMap(([e,t])=>[e,t]),force:this.forceNextLayer}),this.collectStackTrace()),this}skipCache(){return this.forceNextLayer=!0,this}betaDevContainerPrebuild(e){if("devcontainer"!==this.baseTemplate)throw new cy("Devcontainers can only used in the devcontainer template",c2(2));return this.runInNewStackTraceContext(()=>this.runCmd(`devcontainer build --workspace-folder ${e}`,{user:"root"}))}betaSetDevContainerStart(e){if("devcontainer"!==this.baseTemplate)throw new cy("Devcontainers can only used in the devcontainer template",c2(2));return this.runInNewStackTraceContext(()=>{var t;return this.setStartCmd(`sudo devcontainer up --workspace-folder ${e} && sudo /prepare-exec.sh ${e} | sudo tee /devcontainer.sh > /dev/null && sudo chmod +x /devcontainer.sh && sudo touch /devcontainer.up`,(t="/devcontainer.up",new dn(`[ -f ${t} ]`)))})}collectStackTrace(e=3){return this.stackTracesEnabled&&(this.stackTracesOverride?this.stackTraces.push(this.stackTracesOverride):this.stackTraces.push(c2(e))),this}disableStackTrace(){return this.stackTracesEnabled=!1,this}enableStackTrace(){return this.stackTracesEnabled=!0,this}runInNewStackTraceContext(e){this.disableStackTrace();let t=e();return this.enableStackTrace(),this.collectStackTrace(4),t}runInStackTraceOverrideContext(e,t){this.stackTracesOverride=t;let n=e();return this.stackTracesOverride=void 0,n}async toJSON(e){let t=this.instructions;return e&&(t=await this.instructionsWithHashes()),JSON.stringify(this.serialize(t),void 0,2)}toDockerfile(){if(void 0!==this.baseTemplate)throw Error("Cannot convert template built from another template to Dockerfile. Templates based on other templates can only be built using the E2B API.");if(void 0===this.baseImage)throw Error("No base image specified for template");let e=`FROM ${this.baseImage}
`;for(let t of this.instructions){if("RUN"===t.type){e+=`RUN ${t.args[0]}
`;continue}if("COPY"===t.type){e+=`COPY ${t.args[0]} ${t.args[1]}
`;continue}if("ENV"===t.type){let n=[];for(let e=0;e<t.args.length;e+=2)n.push(`${t.args[e]}=${t.args[e+1]}`);e+=`ENV ${n.join(" ")}
`;continue}e+=`${t.type} ${t.args.join(" ")}
`}return this.startCmd&&(e+=`ENTRYPOINT ${this.startCmd}
`),e}async build(e,t){var n,r,a,i,s,o;t.skipCache&&(this.force=!0),null==(n=t.onBuildLogs)||n.call(t,new cz(new Date,"info",`Requesting build for template: ${t.alias}`));let{templateID:l,buildID:u}=await c5(e,{alias:t.alias,cpuCount:null!=(r=t.cpuCount)?r:2,memoryMB:null!=(a=t.memoryMB)?a:1024});null==(i=t.onBuildLogs)||i.call(t,new cz(new Date,"info",`Template created with ID: ${l}, Build ID: ${u}`));let c=await this.instructionsWithHashes(),d=c.map(async(n,r)=>{var a,i,s,o;let u;if("COPY"!==n.type)return;let c=n.args.length>0?n.args[0]:null,d=null!=(a=n.filesHash)?a:null;if(null===c||null===d)throw Error("Source path and files hash are required");let p=n.forceUpload;r+1>=0&&r+1<this.stackTraces.length&&(u=this.stackTraces[r+1]);let{present:m,url:h}=await c6(e,{templateID:l,filesHash:d},u);p&&null!=h||!1===m&&null!=h?(await c8({fileName:c,fileContextPath:this.fileContextPath.toString(),url:h,ignorePatterns:[...this.fileIgnorePatterns,...cQ(this.fileContextPath.toString())],resolveSymlinks:null!=(i=n.resolveSymlinks)&&i},u),null==(s=t.onBuildLogs)||s.call(t,new cz(new Date,"info",`Uploaded '${c}'`))):null==(o=t.onBuildLogs)||o.call(t,new cz(new Date,"info",`Skipping upload of '${c}', already cached`))});return await Promise.all(d),null==(s=t.onBuildLogs)||s.call(t,new cz(new Date,"info","All file uploads completed")),null==(o=t.onBuildLogs)||o.call(t,new cz(new Date,"info","Starting building...")),await c7(e,{templateID:l,buildID:u,template:this.serialize(c)}),{alias:t.alias,templateId:l,buildId:u}}async instructionsWithHashes(){return Promise.all(this.instructions.map(async(e,t)=>{var n;let r;if("COPY"!==e.type)return e;let a=e.args.length>0?e.args[0]:null,i=e.args.length>1?e.args[1]:null;if(null===a||null===i)throw Error("Source path and destination path are required");return t+1>=0&&t+1<this.stackTraces.length&&(r=this.stackTraces[t+1]),u9(u3({},e),{filesHash:await c1(a,i,this.fileContextPath.toString(),[...this.fileIgnorePatterns,..."browser"===ce?[]:cQ(this.fileContextPath.toString())],null!=(n=e.resolveSymlinks)&&n,r)})}))}serialize(e){let t={startCmd:this.startCmd,readyCmd:this.readyCmd,steps:e,force:this.force};return void 0!==this.baseImage&&(t.fromImage=this.baseImage),void 0!==this.baseTemplate&&(t.fromTemplate=this.baseTemplate),void 0!==this.registryConfig&&(t.fromImageRegistry=this.registryConfig),t}};function da(e){return new dr(e)}da.build=dr.build,da.buildInBackground=dr.buildInBackground,da.getBuildStatus=dr.getBuildStatus,da.toJSON=dr.toJSON,da.toDockerfile=dr.toDockerfile;var di=Object.defineProperty,ds=Object.defineProperties,dl=Object.getOwnPropertyDescriptors,du=Object.getOwnPropertySymbols,dc=Object.prototype.hasOwnProperty,dd=Object.prototype.propertyIsEnumerable,dp=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),dm=(e,t,n)=>t in e?di(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,dh=(e,t)=>{for(var n in t||(t={}))dc.call(t,n)&&dm(e,n,t[n]);if(du)for(var n of du(t))dd.call(t,n)&&dm(e,n,t[n]);return e},df=(e,t)=>ds(e,dl(t)),dg=function(e,t){this[0]=e,this[1]=t},dy=(e,t,n)=>{var r=(e,t,a,i)=>{try{var s=n[e](t),o=(t=s.value)instanceof dg,l=s.done;Promise.resolve(o?t[0]:t).then(n=>o?r("return"===e?e:"next",t[1]?{done:n.done,value:n.value}:n,a,i):a({value:n,done:l})).catch(e=>r("throw",e,a,i))}catch(e){i(e)}},a=e=>i[e]=t=>new Promise((n,a)=>r(e,t,n,a)),i={};return n=n.apply(e,t),i[dp("asyncIterator")]=()=>i,a("next"),a("throw"),a("return"),i},db=(e,t,n)=>(t=e[dp("asyncIterator")])?t.call(e):(e=e[dp("iterator")](),t={},(n=(n,r)=>(r=e[n])&&(t[n]=t=>new Promise((n,a,i)=>(i=(t=r.call(e,t)).done,Promise.resolve(t.value).then(e=>n({value:e,done:i}),a)))))("next"),n("return"),t);async function dv(e){if(!e.ok)switch(e.status){case 502:return new cc(`${await e.text()}: This error is likely due to sandbox timeout. You can modify the sandbox timeout by passing 'timeoutMs' when starting the sandbox or calling '.setTimeout' on the sandbox with the desired timeout.`);case 404:return new cm(await e.text());default:return new cu(`${e.status} ${e.statusText}`)}}var dw=class{constructor(e,t,n){this.name=e,this.value=t,this.traceback=n}},d_=class{constructor(e,t){this.isMainResult=t;let n=dh({},e);for(let e of(delete n.type,delete n.is_main_result,this.text=n.text,this.html=n.html,this.markdown=n.markdown,this.svg=n.svg,this.png=n.png,this.jpeg=n.jpeg,this.pdf=n.pdf,this.latex=n.latex,this.json=n.json,this.javascript=n.javascript,this.isMainResult=t,this.raw=n,this.data=n.data,this.chart=n.chart,this.extra={},Object.keys(n)))["plain","html","markdown","svg","png","jpeg","pdf","latex","json","javascript","data","chart","extra","text"].includes(e)||(this.extra[e]=n[e])}formats(){let e=[];for(let t of(this.html&&e.push("html"),this.markdown&&e.push("markdown"),this.svg&&e.push("svg"),this.png&&e.push("png"),this.jpeg&&e.push("jpeg"),this.pdf&&e.push("pdf"),this.latex&&e.push("latex"),this.json&&e.push("json"),this.javascript&&e.push("javascript"),this.data&&e.push("data"),Object.keys(this.extra)))e.push(t);return e}toJSON(){return dh({text:this.text,html:this.html,markdown:this.markdown,svg:this.svg,png:this.png,jpeg:this.jpeg,pdf:this.pdf,latex:this.latex,json:this.json,javascript:this.javascript},Object.keys(this.extra).length>0?{extra:this.extra}:{})}},dE=class{constructor(e=[],t={stdout:[],stderr:[]},n,r){this.results=e,this.logs=t,this.error=n,this.executionCount=r}get text(){for(let e of this.results)if(e.isMainResult)return e.text}toJSON(){return{results:this.results,logs:this.logs,error:this.error}}};async function dT(e,t,n,r,a,i){let s=JSON.parse(t);switch(s.type){case"result":{let t=new d_(df(dh({},s),{type:void 0,is_main_result:void 0}),s.is_main_result);e.results.push(t),a&&await a(t);break}case"stdout":e.logs.stdout.push(s.text),n&&await n({error:!1,line:s.text,timestamp:1e3*new Date().getTime()});break;case"stderr":e.logs.stderr.push(s.text),r&&await r({error:!0,line:s.text,timestamp:1e3*new Date().getTime()});break;case"error":e.error=new dw(s.name,s.value,s.traceback),i&&await i(e.error);break;case"number_of_executions":e.executionCount=s.execution_count}}function dA(e){return e instanceof Error&&"AbortError"===e.name?new cc("Request timed out  the 'requestTimeoutMs' option can be used to increase this timeout"):e}var dI=class extends cJ{get jupyterUrl(){return`${this.connectionConfig.debug?"http":"https"}://${this.getHost(49999)}`}async runCode(e,t){var n,r,a;if((null==t?void 0:t.context)&&(null==t?void 0:t.language))throw new cd("You can provide context or language, but not both at the same time.");let i=new AbortController,s=null!=(n=null==t?void 0:t.requestTimeoutMs)?n:this.connectionConfig.requestTimeoutMs,o=s?setTimeout(()=>{i.abort()},s):void 0,l={"Content-Type":"application/json"};this.trafficAccessToken&&(l["E2B-Traffic-Access-Token"]=this.trafficAccessToken),this.envdAccessToken&&(l["X-Access-Token"]=this.envdAccessToken);try{let n=await fetch(`${this.jupyterUrl}/execute`,{method:"POST",headers:l,body:JSON.stringify({code:e,context_id:null==(r=null==t?void 0:t.context)?void 0:r.id,language:null==t?void 0:t.language,env_vars:null==t?void 0:t.envs}),signal:i.signal,keepalive:!0}),s=await dv(n);if(s)throw s;if(!n.body)throw Error(`Not response body: ${n.statusText} ${await (null==n?void 0:n.text())}`);clearTimeout(o);let m=null!=(a=null==t?void 0:t.timeoutMs)?a:6e4,h=m?setTimeout(()=>{i.abort()},m):void 0,f=new dE;try{try{for(var u,c,d,p=db(function(e){return dy(this,null,function*(){let t=e.getReader(),n="";try{for(;;){let{done:e,value:r}=yield new dg(t.read());if(void 0!==r&&(n+=new TextDecoder().decode(r)),e){n.length>0&&(yield n);break}let a=-1;do a=n.indexOf("\n"),-1!==a&&(yield n.slice(0,a),n=n.slice(a+1));while(-1!==a)}}finally{t.releaseLock()}})}(n.body));u=!(c=await p.next()).done;u=!1){let e=c.value;await dT(f,e,null==t?void 0:t.onStdout,null==t?void 0:t.onStderr,null==t?void 0:t.onResult,null==t?void 0:t.onError)}}catch(e){d=[e]}finally{try{u&&(c=p.return)&&await c.call(p)}finally{if(d)throw d[0]}}}catch(e){throw e instanceof Error&&"AbortError"===e.name?new cc("Execution timed out  the 'timeoutMs' option can be used to increase this timeout"):e}finally{clearTimeout(h)}return f}catch(e){throw dA(e)}}async createCodeContext(e){try{let t={"Content-Type":"application/json"};this.trafficAccessToken&&(t["E2B-Traffic-Access-Token"]=this.trafficAccessToken);let n=await fetch(`${this.jupyterUrl}/contexts`,{method:"POST",headers:t,body:JSON.stringify({language:null==e?void 0:e.language,cwd:null==e?void 0:e.cwd}),keepalive:!0,signal:this.connectionConfig.getSignal(null==e?void 0:e.requestTimeoutMs)}),r=await dv(n);if(r)throw r;return await n.json()}catch(e){throw dA(e)}}async removeCodeContext(e){try{let t="string"==typeof e?e:e.id,n={"Content-Type":"application/json"};this.trafficAccessToken&&(n["E2B-Traffic-Access-Token"]=this.trafficAccessToken);let r=await fetch(`${this.jupyterUrl}/contexts/${t}`,{method:"DELETE",headers:n,keepalive:!0,signal:this.connectionConfig.getSignal(this.connectionConfig.requestTimeoutMs)}),a=await dv(r);if(a)throw a}catch(e){throw dA(e)}}async listCodeContexts(){try{let e={"Content-Type":"application/json"};this.trafficAccessToken&&(e["E2B-Traffic-Access-Token"]=this.trafficAccessToken);let t=await fetch(`${this.jupyterUrl}/contexts`,{method:"GET",headers:e,keepalive:!0,signal:this.connectionConfig.getSignal(this.connectionConfig.requestTimeoutMs)}),n=await dv(t);if(n)throw n;return await t.json()}catch(e){throw dA(e)}}async restartCodeContext(e){try{let t="string"==typeof e?e:e.id,n={"Content-Type":"application/json"};this.trafficAccessToken&&(n["E2B-Traffic-Access-Token"]=this.trafficAccessToken);let r=await fetch(`${this.jupyterUrl}/contexts/${t}/restart`,{method:"POST",headers:n,keepalive:!0,signal:this.connectionConfig.getSignal(this.connectionConfig.requestTimeoutMs)}),a=await dv(r);if(a)throw a}catch(e){throw dA(e)}}};dI.defaultTemplate="code-interpreter-v1";let dx=null;async function dS(){if(!dx){let e=process.env.E2B_API_KEY;if(!e)throw Error("E2B_API_KEY is not set in environment variables");dx=await dI.create({apiKey:e})}return dx}let dN=rk({baseURL:"https://api.groq.com/openai/v1",apiKey:process.env.GROQ_API_KEY});async function dk(e){let{messages:t}=await e.json();try{return(await function({model:e,tools:t,toolChoice:n,system:r,prompt:a,messages:i,maxRetries:s,abortSignal:o,headers:l,maxSteps:u=1,experimental_generateMessageId:c=i3,experimental_output:d,experimental_continueSteps:p=!1,experimental_telemetry:m,experimental_providerMetadata:h,providerOptions:f=h,experimental_toolCallStreaming:g=!1,toolCallStreaming:y=g,experimental_activeTools:b,experimental_repairToolCall:v,experimental_transform:w,onChunk:_,onError:E,onFinish:T,onStepFinish:A,_internal:{now:I=function(){var e,t;return null!=(t=null==(e=null==globalThis?void 0:globalThis.performance)?void 0:e.now())?t:Date.now()},generateId:x=i2,currentDate:S=()=>new Date}={},...N}){if("string"==typeof e||"v1"!==e.specificationVersion)throw new af;return new i9({model:e,telemetry:m,headers:l,settings:N,maxRetries:s,abortSignal:o,system:r,prompt:a,messages:i,tools:t,toolChoice:n,toolCallStreaming:y,transforms:void 0===w?[]:Array.isArray(w)?w:[w],activeTools:b,repairToolCall:v,maxSteps:u,output:d,continueSteps:p,providerOptions:f,onChunk:_,onError:E,onFinish:T,onStepFinish:A,now:I,currentDate:S,generateId:x,generateMessageId:c})}({model:dN("llama-3.3-70b-versatile"),messages:t,tools:{execute_python:{description:"Execute Python code in a secure sandbox environment. Use this for calculations, data analysis, visualizations, or any code that needs to be run.",parameters:nq({code:nG().describe("The Python code to execute")}),execute:async({code:e})=>{try{let t=await dS(),n=await t.runCode(e),r="",a="";return n.logs.stdout&&n.logs.stdout.length>0&&(r=n.logs.stdout.join("\n")),n.logs.stderr&&n.logs.stderr.length>0&&(a=n.logs.stderr.join("\n")),n.error&&(a=String(n.error)),{code:e,stdout:r,stderr:a,success:!n.error}}catch(t){return console.error("E2B Execution Error:",t),{code:e,stdout:"",stderr:t instanceof Error?t.message:"Unknown execution error",success:!1}}}}}})).toDataStreamResponse()}catch(e){return console.error("Chat API Error:",e),new Response(JSON.stringify({error:e instanceof Error?e.message:"An error occurred during processing"}),{status:500,headers:{"Content-Type":"application/json"}})}}let dR=new eb.AppRouteRouteModule({definition:{kind:ev.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"/workspace/codevibe-chat/src/app/api/chat/route.ts",nextConfigOutput:"export",userland:ey}),{requestAsyncStorage:dO,staticGenerationAsyncStorage:dC,serverHooks:dP}=dR,dD="/api/chat/route";function dM(){return(0,ew.patchFetch)({serverHooks:dP,staticGenerationAsyncStorage:dC})}},2981:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Argument=void 0;class n{constructor(e,t){this.value=e,this.range=t}toString(){return this.value}getRange(){return this.range}getValue(){return this.value}isAfter(e){return!(this.range.end.line<e.line)&&(this.range.start.line>e.line||this.range.start.character>e.character)}isBefore(e){return this.range.start.line<e.line||!(this.range.end.line>e.line)&&this.range.end.character<e.character}}t.Argument=n},6003:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Comment=void 0;let r=n(5993),a=n(1738),i=n(2255);class s extends a.Line{constructor(e,t){super(e,t)}toString(){let e=this.getContent();return e?"# "+e:"#"}getContent(){let e=this.getContentRange();return null===e?"":this.document.getText().substring(this.document.offsetAt(e.start),this.document.offsetAt(e.end))}getContentRange(){let e=this.getRange(),t=this.document.offsetAt(e.start),n=this.document.getText().substring(t,this.document.offsetAt(e.end)),a=-1,s=-1;for(let e=1;e<n.length;e++)if(!i.Util.isWhitespace(n.charAt(e))){a=e;break}if(-1===a)return null;for(let e=n.length-1;e>=1;e--)if(!i.Util.isWhitespace(n.charAt(e))){s=e+1;break}return r.Range.create(this.document.positionAt(t+a),this.document.positionAt(t+s))}}t.Comment=s},8299:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dockerfile=void 0;let r=n(5993),a=n(7911),i=n(1975),s=n(6578),o=n(2255),l=n(7911);class u extends i.ImageTemplate{constructor(e){super(),this.initialInstructions=new i.ImageTemplate,this.buildStages=[],this.directives=[],this.foundFrom=!1,this.document=e}getEscapeCharacter(){for(let e of this.directives)if(e.getDirective()===a.Directive.escape){let t=e.getValue();if("\\"===t||"`"===t)return t}return"\\"}getInitialARGs(){return this.initialInstructions.getARGs()}getContainingImage(e){let t=r.Range.create(r.Position.create(0,0),this.document.positionAt(this.document.getText().length));if(!o.Util.isInsideRange(e,t))return null;if((this.initialInstructions.getComments().length>0||this.initialInstructions.getInstructions().length>0)&&o.Util.isInsideRange(e,this.initialInstructions.getRange()))return this.initialInstructions;for(let t of this.buildStages)if(o.Util.isInsideRange(e,t.getRange()))return t;return this}addInstruction(e){e.getKeyword()===l.Keyword.FROM?(this.currentBuildStage=new i.ImageTemplate,this.buildStages.push(this.currentBuildStage),this.foundFrom=!0):this.foundFrom||this.initialInstructions.addInstruction(e),this.foundFrom&&this.currentBuildStage.addInstruction(e),super.addInstruction(e)}setDirectives(e){this.directives=e}getDirective(){return 0===this.directives.length?null:this.directives[0]}getDirectives(){return this.directives}resolveVariable(e,t){for(let n of this.getFROMs()){let r=n.getRange();if(r.start.line<=t&&t<=r.end.line){let n=new i.ImageTemplate;for(let e of this.initialInstructions.getARGs())n.addInstruction(e);return n.resolveVariable(e,t)}}let n=this.getContainingImage(r.Position.create(t,0));if(null===n)return;let a=n.resolveVariable(e,t);if(null===a){let n=new i.ImageTemplate;for(let e of this.initialInstructions.getARGs())n.addInstruction(e);return n.resolveVariable(e,t)}return a}getAvailableVariables(e){if(this.getInstructionAt(e) instanceof s.From){let e=[];for(let t of this.getInitialARGs()){let n=t.getProperty();n&&e.push(n.getName())}return e}let t=this.getContainingImage(r.Position.create(e,0));return t?t.getAvailableVariables(e):[]}getParentStage(e){let t=e.getFROM(),n=null===t?null:t.getImageName();if(null===n)return null;for(let e of this.getFROMs())if(e.getBuildStage()===n){let n=e.getRange();if(n.start.line===t.getRange().start.line)return null;return this.getContainingImage(n.start)}return null}getStageHierarchy(e){let t=this.getContainingImage(r.Position.create(e,0));if(null===t)return[];let n=[t],a=this.getParentStage(t);for(;null!==a;)n.splice(0,0,a),a=this.getParentStage(a);return n}getAvailableWorkingDirectories(e){let t=new Set;for(let n of this.getStageHierarchy(e))for(let r of n.getWORKDIRs())if(r.getRange().end.line<e){let e=r.getAbsolutePath();null!=e&&(e.endsWith("/")||(e+="/"),t.add(e))}return Array.from(t)}organizeComments(){let e=this.getComments();for(let t=0;t<e.length;t++)if(o.Util.isInsideRange(e[t].getRange().end,this.initialInstructions.getRange()))this.initialInstructions.addComment(e[t]);else for(let n of this.buildStages)o.Util.isInsideRange(e[t].getRange().start,n.getRange())&&n.addComment(e[t])}getRange(){let e=this.getComments(),t=this.getInstructions(),n=null;if(0===e.length)t.length>0&&(n=r.Range.create(t[0].getRange().start,t[t.length-1].getRange().end));else if(0===t.length)n=r.Range.create(e[0].getRange().start,e[e.length-1].getRange().end);else{let a=e[0].getRange().start,i=e[e.length-1].getRange().end,s=t[0].getRange().start,o=t[t.length-1].getRange().end;a.line<s.line?(i.line<o.line&&(n=r.Range.create(a,o)),n=r.Range.create(a,i)):n=i.line<o.line?r.Range.create(s,o):r.Range.create(s,i)}return null===n?0===this.directives.length?null:this.directives[0].getRange():0===this.directives.length?n:r.Range.create(this.directives[0].getRange().start,n.end)}}t.Dockerfile=u},7085:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Flag=void 0;let r=n(5993),a=n(7644);class i{constructor(e,t,n,r,a,i){if(this.options=[],this.range=t,this.name=n,this.nameRange=r,this.value=a,this.valueRange=i,null!==this.value){let t=e.offsetAt(i.start),n=-1,r=-1,s=!1;for(let i=0;i<a.length;i++)switch(a.charAt(i)){case"=":s=!0,-1===r&&(r=i+1);break;case",":this.options.push(this.createFlagOption(e,a,t,n,r,i)),n=-1,r=-1;break;default:-1===n&&(n=i)}s&&-1!==n&&this.options.push(this.createFlagOption(e,a,t,n,r,a.length))}}createFlagOption(e,t,n,i,s,o){let l=r.Range.create(e.positionAt(n+i),e.positionAt(n+o));return -1===s?new a.FlagOption(l,t.substring(i,o),l,null,null):new a.FlagOption(l,t.substring(i,s-1),r.Range.create(e.positionAt(n+i),e.positionAt(n+s-1)),t.substring(s,o),r.Range.create(e.positionAt(n+s),e.positionAt(n+o)))}toString(){return this.valueRange?"--"+this.name+"="+this.value:"--"+this.name}getRange(){return this.range}getName(){return this.name}getNameRange(){return this.nameRange}getValue(){return this.value}getValueRange(){return this.valueRange}getOption(e){for(let t of this.options)if(t.getName()===e)return t;return null}getOptions(){return this.options}hasOptions(){return this.options.length>0}}t.Flag=i},7644:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlagOption=void 0;class n{constructor(e,t,n,r,a){this.range=e,this.name=t,this.nameRange=n,this.value=r,this.valueRange=a}toString(){return null!==this.valueRange?this.name+"="+this.value:this.name}getRange(){return this.range}getName(){return this.name}getNameRange(){return this.nameRange}getValue(){return this.value}getValueRange(){return this.valueRange}}t.FlagOption=n},1847:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Heredoc=void 0;class n{constructor(e,t,n,r,a){this.startRange=e,this.name=t,this.nameRange=n,this.contentRange=r,this.endRange=a}getName(){return this.name}getStartRange(){return this.startRange}getNameRange(){return this.nameRange}getContentRange(){return this.contentRange}getDelimiterRange(){return this.endRange}}t.Heredoc=n},1975:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageTemplate=void 0;let r=n(5993),a=n(8767),i=n(4343),s=n(1704),o=n(9375),l=n(8944),u=n(6578),c=n(6512),d=n(2906),p=n(2255),m=n(9676);class h{constructor(){this.comments=[],this.instructions=[]}addComment(e){this.comments.push(e)}getComments(){return this.comments}addInstruction(e){this.instructions.push(e)}getInstructions(){return this.instructions}getInstructionAt(e){for(let t of this.instructions)if(p.Util.isInsideRange(r.Position.create(e,0),t.getRange()))return t;return null}getARGs(){let e=[];for(let t of this.instructions)t instanceof a.Arg&&e.push(t);return e}getCMDs(){let e=[];for(let t of this.instructions)t instanceof i.Cmd&&e.push(t);return e}getCOPYs(){let e=[];for(let t of this.instructions)t instanceof s.Copy&&e.push(t);return e}getENTRYPOINTs(){let e=[];for(let t of this.instructions)t instanceof l.Entrypoint&&e.push(t);return e}getENVs(){let e=[];for(let t of this.instructions)t instanceof o.Env&&e.push(t);return e}getFROM(){for(let e of this.instructions)if(e instanceof u.From)return e;return null}getFROMs(){let e=[];for(let t of this.instructions)t instanceof u.From&&e.push(t);return e}getHEALTHCHECKs(){let e=[];for(let t of this.instructions)t instanceof c.Healthcheck&&e.push(t);return e}getWORKDIRs(){let e=[];for(let t of this.instructions)t instanceof m.Workdir&&e.push(t);return e}getOnbuildTriggers(){let e=[];for(let t of this.instructions)if(t instanceof d.Onbuild){let n=t.getTriggerInstruction();n&&e.push(n)}return e}getAvailableVariables(e){let t=[];for(let n of this.getARGs())if(n.isBefore(e)){let e=n.getProperty();if(e){let n=e.getName();-1===t.indexOf(n)&&t.push(n)}}for(let n of this.getENVs())if(n.isBefore(e))for(let e of n.getProperties()){let n=e.getName();-1===t.indexOf(n)&&t.push(n)}return t}resolveVariable(e,t){let n=this.getENVs();for(let r=n.length-1;r>=0;r--)if(n[r].isBefore(t)){for(let t of n[r].getProperties())if(t.getName()===e)return t.getValue()}let r=this.getARGs();for(let n=r.length-1;n>=0;n--)if(r[n].isBefore(t)){let t=r[n].getProperty();if(t&&t.getName()===e)return t.getValue()}}getRange(){let e=this.getInstructions();if(0===e.length)return r.Range.create(0,0,0,0);let t=e[0].getRange().start,n=e[e.length-1].getRange().end;return r.Range.create(t,n)}contains(e){let t=this.getRange();return null!==t&&p.Util.isInsideRange(e,t)}}t.ImageTemplate=h},8042:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Instruction=void 0;let r=n(5993),a=n(2255),i=n(1738),s=n(2981),o=n(1847),l=n(90),u=n(7911);class c extends i.Line{constructor(e,t,n,r,a,i){super(e,t),this.dockerfile=n,this.escapeChar=r,this.instruction=a,this.instructionRange=i}toString(){let e=this.getKeyword();for(let t of this.getRawArguments())e+=" "+t.getValue();return e}getRangeContent(e){return null===e?null:this.document.getText().substring(this.document.offsetAt(e.start),this.document.offsetAt(e.end))}getInstructionRange(){return this.instructionRange}getInstruction(){return this.instruction}getKeyword(){return this.getInstruction().toUpperCase()}getArgumentsRange(){let e=this.getArguments();return 0===e.length?null:r.Range.create(e[0].getRange().start,e[e.length-1].getRange().end)}getArgumentsRanges(){let e=this.getArguments();if(0===e.length)return[];if(e[0].getRange().start.line===e[e.length-1].getRange().end.line)return[r.Range.create(e[0].getRange().start,e[e.length-1].getRange().end)];let t=[],n=-1,i=e[0].getRange().start,s=this.getInstructionRange(),o=this.document.offsetAt(i)-this.document.offsetAt(s.start),l=this.getTextContent().substring(o,this.document.offsetAt(e[e.length-1].getRange().end)-this.document.offsetAt(s.start)),u=this.document.offsetAt(s.start)+o,c=!1;for(let e=0;e<l.length;e++){let s=l.charAt(e);if(s===this.escapeChar){let a=l.charAt(e+1);if(" "===a||"	"===a)e:for(let a=e+2;a<l.length;a++)switch(l.charAt(a)){case" ":case"	":continue;case"\r":a++;case"\n":null!==i&&t.push(r.Range.create(i,this.document.positionAt(u+n+1))),i=null,c=!1,e=a;break e;default:break e}else"\r"===a?(null!==i&&(t.push(r.Range.create(i,this.document.positionAt(u+n+1))),i=null),c=!1,e+=2):("\n"===a&&(null!==i&&t.push(r.Range.create(i,this.document.positionAt(u+n+1))),i=null,c=!1),e++)}else if(a.Util.isNewline(s))c&&(i=null,c=!1);else if(!c){if(null===i){if("#"===s){c=!0;continue}let t=this.document.positionAt(u+e);0!==t.character&&(i=r.Position.create(t.line,0))}n=e}}return null===i?t.push(r.Range.create(this.document.positionAt(u+n),this.document.positionAt(u+n+1))):t.push(r.Range.create(i,this.document.positionAt(u+n+1))),t}getRawArgumentsContent(){let e=this.getArguments();return 0===e.length?null:this.getRangeContent(r.Range.create(e[0].getRange().start,e[e.length-1].getRange().end))}getArgumentsContent(){if(0===this.getArguments().length)return null;let e="",t=this.getArgumentsRanges(),n=this.document.getText();for(let r of t)e+=n.substring(this.document.offsetAt(r.start),this.document.offsetAt(r.end));return e}getArguments(){return this.getRawArguments()}getRawArguments(){let e=[],t=this.getInstructionRange(),n=this.document.offsetAt(t.end)-this.document.offsetAt(t.start),i=this.getTextContent().substring(n),o=this.document.offsetAt(t.start)+n,l=!1,u=!1,c=-1,d=!1,p=!1,m=-1,h="";for(let t=0;t<i.length;t++){let n=i.charAt(t);if(a.Util.isWhitespace(n)){if(p){d=!0,a.Util.isNewline(n)&&(d=!1,u&&(u=!1,l=!0));continue}-1!==c&&(-1===m?e.push(new s.Argument(h,r.Range.create(this.document.positionAt(o+c),this.document.positionAt(o+t)))):e.push(new s.Argument(h,r.Range.create(this.document.positionAt(o+c),this.document.positionAt(o+m)))),m=-1,h="",c=-1)}else if(n===this.escapeChar){let a=i.charAt(t+1);if(" "===a||"	"===a)e:for(let e=t+2;e<i.length;e++)switch(i.charAt(e)){case" ":case"	":continue;case"\r":e++;case"\n":u=!1,p=!0,l=!0,-1!==c&&(m=t),t=e;break e;default:m=t,-1===c&&(t=e-1);break e}else if("\r"===a)u=!1,p=!0,l=!0,-1!==c&&-1===m&&(m=t),t+=2;else if("\n"===a)u=!1,p=!0,l=!0,-1!==c&&-1===m&&(m=t),t++;else{if(d&&-1!==m&&(e.push(new s.Argument(h,r.Range.create(this.document.positionAt(o+c),this.document.positionAt(o+m)))),h="",c=-1),m=-1,d=!1,p=!1,"$"===a)h=h+n+a;else if(""===a)break;else h+=a;-1===c&&(c=t),t++}}else u||(l&&"#"===n?u=!0:(d&&-1!==m&&(e.push(new s.Argument(h,r.Range.create(this.document.positionAt(o+c),this.document.positionAt(o+m)))),h="",c=-1),d=!1,p=!1,m=-1,h+=n,-1===c&&(c=t)),l=!1)}return -1!==c&&(-1===m?e.push(new s.Argument(h,r.Range.create(this.document.positionAt(o+c),this.document.positionAt(o+i.length)))):e.push(new s.Argument(h,r.Range.create(this.document.positionAt(o+c),this.document.positionAt(o+m))))),e}getExpandedArguments(){let e=this.getArguments();for(let t=0;t<e.length;t++){let n=e[t].getRange(),r=this.document.offsetAt(n.start),a=this.parseVariables(r,e[t].getValue()),i=[],o=!1;for(let e of a){let t=this.dockerfile.resolveVariable(e.getName(),e.getNameRange().start.line);i.push(t),o=o||void 0!==t}if(o){let o="";for(let e=0;e<i.length;e++){let t=a[e].getRange(),n=this.document.offsetAt(t.start),s=this.document.offsetAt(t.end);i[e]?o+=this.document.getText().substring(r,n)+i[e]:o+=this.document.getText().substring(r,s),r=s}let l=this.document.offsetAt(n.end);l!==r&&(o+=this.document.getText().substring(r,l)),e[t]=new s.Argument(o,n)}}return e}getVariables(){let e=[];for(let t of this.getRawArguments()){let n=t.getRange(),r=this.document.getText().substring(this.document.offsetAt(n.start),this.document.offsetAt(n.end));for(let n of this.parseVariables(this.document.offsetAt(t.getRange().start),r))e.push(n)}return e}parseVariables(e,t){let n=[];t:for(let i=0;i<t.length;i++)switch(t.charAt(i)){case this.escapeChar:"$"===t.charAt(i+1)&&i++;break;case"$":if("{"===t.charAt(i+1)){let a="${",s="",o=-1,u="",c=-1,d=-1,p=-1;n:for(let m=i+2;m<t.length;m++){let h=t.charAt(m);switch(h){case this.escapeChar:for(let e=m+1;e<t.length;e++)switch(t.charAt(e)){case" ":case"	":case"\r":continue;case"\n":m=e;continue n}break;case"}":a+="}";let f=null,g=null,y=-1!==p?u:null,b=null;-1===o?o=m:o+1===m?(f="",g=r.Range.create(this.document.positionAt(e+o+1),this.document.positionAt(e+o+1))):(-1===c?(c=p+1,d=p+1):d+=1,f=t.substring(p,p+1),g=r.Range.create(this.document.positionAt(e+p),this.document.positionAt(e+p+1)),b=r.Range.create(this.document.positionAt(e+c),this.document.positionAt(e+d)));let v=this.document.positionAt(e+i);n.push(new l.Variable(s,r.Range.create(this.document.positionAt(e+i+2),this.document.positionAt(e+o)),r.Range.create(v,this.document.positionAt(e+m+1)),f,g,y,b,void 0!==this.dockerfile.resolveVariable(s,v.line),this.isBuildVariable(s,v.line),a)),i=m;continue t;case":":-1===o?o=m:-1!==p?(-1===c&&(c=m),d=m,u+=":"):p=m,a+=":";break;case"\n":case"\r":case" ":case"	":break;default:-1===o?s+=h:-1!==p?(-1===c&&(c=m),d=m,u+=h):p=m,a+=h}}}else{if(a.Util.isWhitespace(t.charAt(i+1))||i===t.length-1)continue;let s="";n:for(let a=i+1;a<t.length;a++){let o=t.charAt(a);switch(o){case"\r":case"\n":case" ":case"	":continue;case"$":case"'":case'"':let u=this.document.positionAt(e+i);n.push(new l.Variable(s,r.Range.create(this.document.positionAt(e+i+1),this.document.positionAt(e+a)),r.Range.create(u,this.document.positionAt(e+a)),null,null,null,null,void 0!==this.dockerfile.resolveVariable(s,u.line),this.isBuildVariable(s,u.line),"$"+s)),i=a-1;continue t;case this.escapeChar:for(let e=a+1;e<t.length;e++)switch(t.charAt(e)){case" ":case"	":case"\r":continue;case"\n":a=e;continue n}let c=this.document.positionAt(e+i);n.push(new l.Variable(s,r.Range.create(this.document.positionAt(e+i+1),this.document.positionAt(e+a)),r.Range.create(c,this.document.positionAt(e+a)),null,null,null,null,void 0!==this.dockerfile.resolveVariable(s,c.line),this.isBuildVariable(s,c.line),"$"+s));break t}if(null===o.match(/^[a-z0-9_]+$/i)){let t=this.document.positionAt(e+i);n.push(new l.Variable(s,r.Range.create(this.document.positionAt(e+i+1),this.document.positionAt(e+a)),r.Range.create(t,this.document.positionAt(e+a)),null,null,null,null,void 0!==this.dockerfile.resolveVariable(s,t.line),this.isBuildVariable(s,t.line),"$"+s)),i=a-1;continue t}s+=o}let o=this.document.positionAt(e+i);n.push(new l.Variable(s,r.Range.create(this.document.positionAt(e+i+1),this.document.positionAt(e+t.length)),r.Range.create(o,this.document.positionAt(e+t.length)),null,null,null,null,void 0!==this.dockerfile.resolveVariable(s,o.line),this.isBuildVariable(s,o.line),"$"+s))}break t}return n}isBuildVariable(e,t){if(this.getKeyword()===u.Keyword.FROM){for(let t of this.dockerfile.getInitialARGs()){let n=t.getProperty();if(n&&e===n.getName())return!0}return}let n=this.dockerfile.getContainingImage(r.Position.create(t,0)),a=n.getENVs();for(let n=a.length-1;n>=0;n--)if(a[n].isBefore(t)){for(let t of a[n].getProperties())if(t.getName()===e)return!1}let i=n.getARGs();for(let n=i.length-1;n>=0;n--)if(i[n].isBefore(t)){let t=i[n].getProperty();if(t&&t.getName()===e)return!0}}createSingleLineHeredocs(e){let t=[];for(let n of e){let e=n.getValue();if(e.startsWith("<<")&&null!==a.Util.parseHeredocName(e)){let e=n.getRange(),r=this.getNameRange(e),a=this.getName(r);t.push(new o.Heredoc(e,a,r,null,null))}}return t}getName(e){let t=this.document.getText(e),n=!1,r="";n:for(let e=0;e<t.length;e++){let a=t.charAt(e);switch(a){case this.escapeChar:n=!0;for(let n=e+1;n<t.length;n++)switch(t.charAt(n)){case" ":case"	":break;case"\r":e=n+1;continue n;case"\n":e=n;continue n;default:r+=t.charAt(n),e=n;continue n}break;case"#":if(n){for(let n=e+1;n<t.length;n++)if("\n"===t.charAt(n)){e=n;continue n}}case" ":case"	":case"\r":case"\n":if(n)break;default:r+=a}}return r}getNameRange(e){let t=this.document.getText(e),n=!1,a=!1,i=-1,s=-1,o=!1,l=null;r:for(let e=0;e<t.length;e++){let r=t.charAt(e);switch(r){case'"':case"'":if(l===r)break r;l=r;continue;case this.escapeChar:for(let n=e+1;n<t.length;n++)if("\n"===t.charAt(n)){o=!0,n=e;continue r}break;case" ":case"	":case"\r":case"\n":break;case"<":n?a=!0:n=!0;break;case"-":if(a){a=!1;break}case"#":if(o){for(let n=e+1;n<t.length;n++)if("\n"===t.charAt(n)){e=n;continue r}}default:if(-1===i&&(i=e),null!==l){s=e+1;break}break r}}if(-1===i)return r.Range.create(e.end,e.end);let u=this.document.positionAt(this.document.offsetAt(e.start)+i),c=null!==l?this.document.positionAt(this.document.offsetAt(e.start)+s):e.end;return r.Range.create(u,c)}getHeredocs(){let e=this.getArguments();if(0===e.length)return[];let t=[],n=this.getRange();if(n.start.line===n.end.line)return this.createSingleLineHeredocs(e);let a=[],i=!1,s=!1,l=-1,u=-1,c=-1,d=0,p=this.document.offsetAt(e[0].getRange().start),m=this.getRangeContent(r.Range.create(e[0].getRange().start,this.getRange().end));r:for(let n=0;n<m.length;n++)switch(m.charAt(n)){case this.escapeChar:s=!0;for(let e=n+1;e<m.length;e++)switch(m.charAt(e)){case" ":case"	":break;case"\r":e++;default:n=e;continue r}break;case"\r":break;case"\n":if(s)break;if(i){-1===l&&(l=n),u=n;let e=a[d],i=e.getRange(),s=this.getNameRange(i),m=this.getName(s),h=this.getDelimiterRange(e,m,r.Range.create(this.document.positionAt(p+c),this.document.positionAt(p+n)));if(null!==h){let e=r.Range.create(this.document.positionAt(p+l),this.document.positionAt(p+c-1));t.push(new o.Heredoc(i,m,s,e,h)),l=-1,d++}c=-1}else{let t=p+n;for(let n of e)if(this.document.offsetAt(n.getRange().start)<t)n.getValue().startsWith("<<")&&a.push(n);else break;i=!0,c=-1;continue}break;case" ":case"	":if(s)break;case"#":if(s){for(let e=n+1;e<m.length;e++)if("\n"===m.charAt(e)){n=e;continue r}}default:s&&(s=!1),i&&(-1===l&&(l=n),-1===c&&(c=n))}if(!i)return this.createSingleLineHeredocs(e);{let e=a[d],i=e.getRange(),s=this.getNameRange(i),m=this.getName(s),h=null,f=this.getDelimiterRange(e,m,r.Range.create(this.document.positionAt(p+c),n.end));null===f?h=r.Range.create(this.document.positionAt(p+l),n.end):-1!==u&&(h=r.Range.create(this.document.positionAt(p+l),this.document.positionAt(p+u))),t.push(new o.Heredoc(i,m,s,h,f)),d++;for(let e=d;e<a.length;e++){let e=a[d].getRange(),n=this.getNameRange(e),r=this.getName(n);t.push(new o.Heredoc(e,r,n,null,null)),d++}}return t}getDelimiterRange(e,t,n){let a=this.document.getText(n);if(e.getValue().startsWith("<<-")){let e=0;for(;"	"===a.charAt(e);)e++;return a.substring(e)===t?r.Range.create(r.Position.create(n.start.line,e),n.end):null}return a===t?n:null}}t.Instruction=c},4457:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Add=void 0;let r=n(3030);class a extends r.JSONInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}stopSearchingForFlags(e){return -1===e.indexOf("--")}}t.Add=a},8767:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Arg=void 0;let r=n(4521),a=n(7291);class i extends a.PropertyInstruction{constructor(e,t,n,a,i,s){super(e,t,n,a,i,s),this.property=null;let o=this.getPropertyArguments();1===o.length?this.property=new r.Property(this.document,this.escapeChar,o[0]):this.property=null}getProperty(){return this.property}}t.Arg=i},4343:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cmd=void 0;let r=n(3030);class a extends r.JSONInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}}t.Cmd=a},1704:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Copy=void 0;let r=n(3030);class a extends r.JSONInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}stopSearchingForFlags(e){return -1===e.indexOf("--")}getFromFlag(){let e=super.getFlags();return 1===e.length&&"from"===e[0].getName()?e[0]:null}getHeredocs(){return super.getHeredocs()}}t.Copy=a},8944:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Entrypoint=void 0;let r=n(3030);class a extends r.JSONInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}}t.Entrypoint=a},9375:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Env=void 0;let r=n(7291);class a extends r.PropertyInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}getProperties(){return super.getProperties()}}t.Env=a},6578:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.From=void 0;let r=n(5993),a=n(6872);class i extends a.ModifiableInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}stopSearchingForFlags(e){return -1===e.indexOf("--")}getImage(){let e=this.getArguments();return e.length>0?e[0].getValue():null}getImageName(){let e=this.getRangeContent(this.getImageNameRange());if(null===e)return null;let t=!1,n=!1,r="";for(let a=0;a<e.length;a++){let i=e.charAt(a);switch(i){case this.escapeChar:n=!0;break;case"\r":continue;case"\n":t=!1;break;case" ":case"	":break;case"#":n?t=!0:(r+=i,n=!1);break;default:t||(r+=i,n=!1)}}return r}getImageNameRange(){let e=this.getImageRange();if(e){let t=this.getRegistryRange();t&&(e.start=this.document.positionAt(this.document.offsetAt(t.end)+1));let n=this.getImageTagRange(),r=this.getImageDigestRange();return null===n?null!==r&&(e.end=this.document.positionAt(this.document.offsetAt(r.start)-1)):e.end=this.document.positionAt(this.document.offsetAt(n.start)-1),e}return null}getImageRange(){let e=this.getArguments();return 0!==e.length?e[0].getRange():null}getImageTag(){return this.getRangeContent(this.getImageTagRange())}getImageTagRange(){let e=this.getImageRange();if(e){let t=this.document.offsetAt(e.start),n=this.getRangeContent(e),a=this.indexOf(t,n,"@"),i=n.indexOf("/");if(-1===a){let a=this.lastIndexOf(t,n,":");if(a>i)return r.Range.create(this.document.positionAt(t+a+1),e.end)}let s=n.substring(0,a),o=s.indexOf(":");return -1===o?null:-1===i?r.Range.create(this.document.positionAt(t+o+1),this.document.positionAt(t+a)):o<i?null:r.Range.create(this.document.positionAt(t+o+1),this.document.positionAt(t+s.length))}return null}getImageDigest(){return this.getRangeContent(this.getImageDigestRange())}getImageDigestRange(){let e=this.getImageRange();if(e){let t=this.getRangeContent(e),n=this.lastIndexOf(this.document.offsetAt(e.start),t,"@");if(-1!==n)return r.Range.create(e.start.line,e.start.character+n+1,e.end.line,e.end.character)}return null}indexOf(e,t,n){let r=t.indexOf(n),a=this.getVariables();for(let i=0;i<a.length;i++){let s=e+r,o=a[i].getRange();if(this.document.offsetAt(o.start)<s&&s<this.document.offsetAt(o.end)){let a=this.document.offsetAt(o.end)-e,s=t.substring(a).indexOf(n);if(-1===s)return -1;r=s+a,i=-1;continue}}return r}lastIndexOf(e,t,n){let r=t.lastIndexOf(n),a=this.getVariables();for(let i=0;i<a.length;i++){let s=e+r,o=a[i].getRange();if(this.document.offsetAt(o.start)<s&&s<this.document.offsetAt(o.end)){if(-1===(r=t.substring(0,r).lastIndexOf(n)))return -1;i=-1;continue}}return r}getRegistry(){return this.getRangeContent(this.getRegistryRange())}getRegistryRange(){let e=this.getImageRange();if(e){let t=this.getImageTagRange(),n=this.getImageDigestRange();null===t?null!==n&&(e.end=this.document.positionAt(this.document.offsetAt(n.start)-1)):e.end=this.document.positionAt(this.document.offsetAt(t.start)-1);let a=this.getRangeContent(e),i=this.document.offsetAt(e.start),s=this.indexOf(i,a,"/");if(-1===s)return null;let o=this.indexOf(i,a,":"),l=this.indexOf(i,a,".");if(-1!==o||-1!==l||"localhost"===a.substring(0,s))return r.Range.create(e.start,this.document.positionAt(i+s))}return null}getBuildStage(){let e=this.getBuildStageRange();return null===e?null:this.getRangeContent(e)}getBuildStageRange(){let e=this.getArguments();return e.length>2&&"AS"===e[1].getValue().toUpperCase()?e[2].getRange():null}getPlatformFlag(){let e=super.getFlags();return 1===e.length&&"platform"===e[0].getName()?e[0]:null}}t.From=i},6512:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Healthcheck=void 0;let r=n(6872);class a extends r.ModifiableInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}stopSearchingForFlags(e){return"CMD"===(e=e.toUpperCase())||"NONE"===e}getSubcommand(){let e=this.getArguments();return 0!==e.length?e[0]:null}}t.Healthcheck=a},3413:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0;let r=n(7291),a=n(2255);class i extends r.PropertyInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}getVariables(){let e=super.getVariables();for(let t of this.getProperties()){let n=t.getUnescapedValue();if(null!==n&&n.length>2&&"'"===n.charAt(0)&&"'"===n.charAt(n.length-1)){let n=t.getValueRange();for(let t=0;t<e.length;t++)a.Util.isInsideRange(e[t].getRange().start,n)&&(e.splice(t,1),t--)}}return e}getProperties(){return super.getProperties()}}t.Label=i},2906:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Onbuild=void 0;let r=n(5993),a=n(5627),i=n(8042);class s extends i.Instruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}getTrigger(){let e=this.getTriggerWord();return null===e?null:e.toUpperCase()}getTriggerWord(){return this.getRangeContent(this.getTriggerRange())}getTriggerRange(){let e=this.getArguments();return e.length>0?e[0].getRange():null}getTriggerInstruction(){let e=this.getTriggerRange();if(null===e)return null;let t=this.getArguments();return a.Parser.createInstruction(this.document,this.dockerfile,this.escapeChar,r.Range.create(t[0].getRange().start,this.getRange().end),this.getTriggerWord(),e)}}t.Onbuild=s},1736:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Run=void 0;let r=n(3030);class a extends r.JSONInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}stopSearchingForFlags(e){return -1===e.indexOf("--")}getHeredocs(){return super.getHeredocs()}}t.Run=a},5967:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shell=void 0;let r=n(3030);class a extends r.JSONInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}}t.Shell=a},2716:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stopsignal=void 0;let r=n(8042);class a extends r.Instruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}}t.Stopsignal=a},3240:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;let r=n(8042);class a extends r.Instruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}}t.User=a},7135:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Volume=void 0;let r=n(3030);class a extends r.JSONInstruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}}t.Volume=a},9676:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Workdir=void 0;let r=n(8042);class a extends r.Instruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}getPath(){return this.getArgumentsContent()}getAbsolutePath(){let e=this.getPath();if(null===e||e.startsWith("/"))return e;let t=this.getRange().start.line,n=this.dockerfile.getStageHierarchy(t);for(let r=n.length-1;r>=0;r--){let a=n[r].getWORKDIRs();for(let n=a.length-1;n>=0;n--)if(a[n].getRange().start.line<t){let t=a[n].getAbsolutePath();if(null==t)return;return t.endsWith("/")?t+e:t+"/"+e}}}}t.Workdir=a},1590:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONArgument=void 0;let r=n(2981);class a extends r.Argument{constructor(e,t,n){super(e,t),this.jsonRange=n}getJSONRange(){return this.jsonRange}getJSONValue(){let e=super.getValue();return e.substring(1,e.length-1)}}t.JSONArgument=a},3030:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONInstruction=void 0;let r=n(5993),a=n(2981),i=n(1590),s=n(6872);class o extends s.ModifiableInstruction{constructor(e,t,n,s,o,l){super(e,t,n,s,o,l),this.openingBracket=null,this.closingBracket=null,this.jsonStrings=[];let u=this.getRawArgumentsContent();if(null===u)return;let c=this.getArguments();if(1===c.length&&"[]"===c[0].getValue()){let e=c[0].getRange();this.openingBracket=new a.Argument("[",r.Range.create(e.start.line,e.start.character,e.start.line,e.start.character+1)),this.closingBracket=new a.Argument("]",r.Range.create(e.start.line,e.start.character+1,e.end.line,e.end.character));return}if(2===c.length&&"["===c[0].getValue()&&"]"===c[1].getValue()){this.openingBracket=c[0],this.closingBracket=c[1];return}let d=e.offsetAt(this.getArgumentsRange().start),p=-1,m="",h=!1,f="";a:for(let t=0;t<u.length;t++){let n=u.charAt(t);switch(n){case"[":if(""===m)this.openingBracket=new a.Argument("[",r.Range.create(e.positionAt(d+t),e.positionAt(d+t+1))),m="[";else if(h)f+=n;else break a;break;case'"':if("["===m||","===m){p=t,h=!0,m='"',f+=n;continue}if('"'===m){if(h)f+=n,h=!1,this.jsonStrings.push(new i.JSONArgument(f,r.Range.create(e.positionAt(d+p),e.positionAt(d+t+1)),r.Range.create(e.positionAt(d+p+1),e.positionAt(d+t)))),f="";else break a}else break a;break;case",":if(h)f+=n;else if('"'===m)m=",";else break a;break;case"]":if(h)f+=n;else if(""!==m){this.closingBracket=new a.Argument("]",r.Range.create(e.positionAt(d+t),e.positionAt(d+t+1)));break a}break;case" ":case"	":break;case"\\":if(h)switch(u.charAt(t+1)){case'"':case"\\":f+=u.charAt(t+1),t++;continue;case" ":case"	":i:for(let e=t+2;e<u.length;e++)switch(u.charAt(e)){case"\r":e++;case"\n":t=e;continue a;case" ":case"	":break;default:break i}break;case"\r":t++;default:t++;continue}else i:for(let e=t+1;e<u.length;e++)switch(u.charAt(e)){case"\r":e++;case"\n":t=e;continue a;case" ":case"	":break;default:break i}break a;default:if(!h)break a;f+=n}}}stopSearchingForFlags(e){return!0}getOpeningBracket(){return this.openingBracket}getJSONStrings(){return this.jsonStrings}getClosingBracket(){return this.closingBracket}}t.JSONInstruction=o},1738:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Line=void 0;class n{constructor(e,t){this.document=e,this.range=t}getRange(){return this.range}getTextContent(){return this.document.getText().substring(this.document.offsetAt(this.range.start),this.document.offsetAt(this.range.end))}isAfter(e){return this.range.start.line>e.range.start.line}isBefore(e){return this.range.start.line<e}}t.Line=n},7911:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DockerfileParser=t.DefaultVariables=t.Directive=t.Keyword=t.Workdir=t.Volume=t.User=t.Stopsignal=t.Shell=t.Run=t.PropertyInstruction=t.Onbuild=t.ModifiableInstruction=t.Label=t.JSONInstruction=t.Heredoc=t.Healthcheck=t.From=t.Env=t.Entrypoint=t.Copy=t.Cmd=t.Arg=t.Add=t.Variable=t.Property=t.ParserDirective=t.Line=t.Instruction=t.Flag=t.Comment=t.JSONArgument=t.Argument=void 0;var r,a,i,s=n(2981);Object.defineProperty(t,"Argument",{enumerable:!0,get:function(){return s.Argument}});var o=n(1590);Object.defineProperty(t,"JSONArgument",{enumerable:!0,get:function(){return o.JSONArgument}});let l=n(6003);Object.defineProperty(t,"Comment",{enumerable:!0,get:function(){return l.Comment}});let u=n(5627);var c=n(7085);Object.defineProperty(t,"Flag",{enumerable:!0,get:function(){return c.Flag}});let d=n(8042);Object.defineProperty(t,"Instruction",{enumerable:!0,get:function(){return d.Instruction}});var p=n(1738);Object.defineProperty(t,"Line",{enumerable:!0,get:function(){return p.Line}});let m=n(4906);Object.defineProperty(t,"ParserDirective",{enumerable:!0,get:function(){return m.ParserDirective}});var h=n(4521);Object.defineProperty(t,"Property",{enumerable:!0,get:function(){return h.Property}});var f=n(90);Object.defineProperty(t,"Variable",{enumerable:!0,get:function(){return f.Variable}});var g=n(4457);Object.defineProperty(t,"Add",{enumerable:!0,get:function(){return g.Add}});let y=n(8767);Object.defineProperty(t,"Arg",{enumerable:!0,get:function(){return y.Arg}});let b=n(4343);Object.defineProperty(t,"Cmd",{enumerable:!0,get:function(){return b.Cmd}});let v=n(1704);Object.defineProperty(t,"Copy",{enumerable:!0,get:function(){return v.Copy}});let w=n(8944);Object.defineProperty(t,"Entrypoint",{enumerable:!0,get:function(){return w.Entrypoint}});let _=n(9375);Object.defineProperty(t,"Env",{enumerable:!0,get:function(){return _.Env}});let E=n(6578);Object.defineProperty(t,"From",{enumerable:!0,get:function(){return E.From}});let T=n(6512);Object.defineProperty(t,"Healthcheck",{enumerable:!0,get:function(){return T.Healthcheck}});var A=n(1847);Object.defineProperty(t,"Heredoc",{enumerable:!0,get:function(){return A.Heredoc}});var I=n(3030);Object.defineProperty(t,"JSONInstruction",{enumerable:!0,get:function(){return I.JSONInstruction}});var x=n(3413);Object.defineProperty(t,"Label",{enumerable:!0,get:function(){return x.Label}});var S=n(6872);Object.defineProperty(t,"ModifiableInstruction",{enumerable:!0,get:function(){return S.ModifiableInstruction}});var N=n(2906);Object.defineProperty(t,"Onbuild",{enumerable:!0,get:function(){return N.Onbuild}});var k=n(7291);Object.defineProperty(t,"PropertyInstruction",{enumerable:!0,get:function(){return k.PropertyInstruction}});var R=n(1736);Object.defineProperty(t,"Run",{enumerable:!0,get:function(){return R.Run}});var O=n(5967);Object.defineProperty(t,"Shell",{enumerable:!0,get:function(){return O.Shell}});var C=n(2716);Object.defineProperty(t,"Stopsignal",{enumerable:!0,get:function(){return C.Stopsignal}});var P=n(3240);Object.defineProperty(t,"User",{enumerable:!0,get:function(){return P.User}});var D=n(7135);Object.defineProperty(t,"Volume",{enumerable:!0,get:function(){return D.Volume}});let M=n(9676);Object.defineProperty(t,"Workdir",{enumerable:!0,get:function(){return M.Workdir}}),function(e){e.ADD="ADD",e.ARG="ARG",e.CMD="CMD",e.COPY="COPY",e.ENTRYPOINT="ENTRYPOINT",e.ENV="ENV",e.EXPOSE="EXPOSE",e.FROM="FROM",e.HEALTHCHECK="HEALTHCHECK",e.LABEL="LABEL",e.MAINTAINER="MAINTAINER",e.ONBUILD="ONBUILD",e.RUN="RUN",e.SHELL="SHELL",e.STOPSIGNAL="STOPSIGNAL",e.USER="USER",e.VOLUME="VOLUME",e.WORKDIR="WORKDIR"}(r||(t.Keyword=r={})),function(e){e.escape="escape",e.syntax="syntax"}(a||(t.Directive=a={})),t.DefaultVariables=["ALL_PROXY","all_proxy","FTP_PROXY","ftp_proxy","HTTP_PROXY","http_proxy","HTTPS_PROXY","https_proxy","NO_PROXY","no_proxy"],(i||(t.DockerfileParser=i={})).parse=function(e){return new u.Parser().parse(e)}},6872:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiableInstruction=void 0;let r=n(5993),a=n(7085),i=n(8042);class s extends i.Instruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i)}getFlags(){if(!this.flags)for(let e of(this.flags=[],this.getArguments())){let t=e.getValue();if(this.stopSearchingForFlags(t))break;if(0===t.indexOf("--")){let n=e.getRange(),i=this.document.getText().substring(this.document.offsetAt(n.start),this.document.offsetAt(n.end)),s=t.indexOf("="),o=i.indexOf("="),l=!1,u=!1,c=-1;s:for(let e=0;e<i.length;e++)switch(i.charAt(e)){case"\\":case" ":case"	":case"\r":case"\n":break;case"-":if(u){c=e;break s}l?u=!0:l=!0;break;default:c=e;break s}let d=this.document.positionAt(this.document.offsetAt(n.start)+c);if(-1===o)this.flags.push(new a.Flag(this.document,n,t.substring(2),r.Range.create(d,n.end),null,null));else if(o===t.length-1){let e=this.document.positionAt(this.document.offsetAt(n.start)+o);this.flags.push(new a.Flag(this.document,n,t.substring(2,o),r.Range.create(d,e),"",r.Range.create(n.end,n.end)))}else{let e=this.document.positionAt(this.document.offsetAt(n.start)+o);this.flags.push(new a.Flag(this.document,n,t.substring(2,s),r.Range.create(d,e),t.substring(s+1),r.Range.create(this.document.positionAt(this.document.offsetAt(n.start)+o+1),n.end)))}}}return this.flags}getArguments(){let e=super.getArguments(),t=this.getFlags();if(0===t.length)return e;for(let n=0;n<t.length;n++)e.shift();return e}}t.ModifiableInstruction=s},5627:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;let r=n(7665),a=n(5993),i=n(6003),s=n(4906),o=n(8042),l=n(4457),u=n(8767),c=n(4343),d=n(1704),p=n(9375),m=n(8944),h=n(6578),f=n(6512),g=n(3413),y=n(2906),b=n(1736),v=n(5967),w=n(2716),_=n(9676),E=n(3240),T=n(7135),A=n(8299),I=n(2255),x=n(7911);class S{constructor(){this.escapeChar=null}static createInstruction(e,t,n,r,a,i){switch(a.toUpperCase()){case"ADD":return new l.Add(e,r,t,n,a,i);case"ARG":return new u.Arg(e,r,t,n,a,i);case"CMD":return new c.Cmd(e,r,t,n,a,i);case"COPY":return new d.Copy(e,r,t,n,a,i);case"ENTRYPOINT":return new m.Entrypoint(e,r,t,n,a,i);case"ENV":return new p.Env(e,r,t,n,a,i);case"FROM":return new h.From(e,r,t,n,a,i);case"HEALTHCHECK":return new f.Healthcheck(e,r,t,n,a,i);case"LABEL":return new g.Label(e,r,t,n,a,i);case"ONBUILD":return new y.Onbuild(e,r,t,n,a,i);case"RUN":return new b.Run(e,r,t,n,a,i);case"SHELL":return new v.Shell(e,r,t,n,a,i);case"STOPSIGNAL":return new w.Stopsignal(e,r,t,n,a,i);case"WORKDIR":return new _.Workdir(e,r,t,n,a,i);case"USER":return new E.User(e,r,t,n,a,i);case"VOLUME":return new T.Volume(e,r,t,n,a,i)}return new o.Instruction(e,r,t,n,a,i)}getParserDirectives(e,t){let n=[];this.escapeChar="";let r=I.Util.isUTF8BOM(t.substring(0,1))?1:0;o:for(let i=r;i<t.length;i++)switch(t.charAt(i)){case" ":case"	":break;case"\r":case"\n":default:break o;case"#":let r=-1,o=-1;for(let l=i+1;l<t.length;l++){let u=t.charAt(l);switch(u){case" ":case"	":-1!==r&&-1===o&&(o=l);break;case"\r":case"\n":break o;case"=":let c=-1,d=-1;-1===o&&(o=l);let p=t.length;l:for(let e=l+1;e<t.length;e++)switch(u=t.charAt(e)){case"\r":case"\n":-1!==c&&-1===d&&(d=e),p=e;break l;case"	":case" ":-1!==c&&-1===d&&(d=e);continue;default:-1===c&&(c=e)}if(-1===r)break o;-1===c?(c=l+1,d=p):-1===d&&(d=t.length);let m=a.Range.create(e.positionAt(i),e.positionAt(p)),h=a.Range.create(e.positionAt(r),e.positionAt(o)),f=a.Range.create(e.positionAt(c),e.positionAt(d));n.push(new s.ParserDirective(e,m,h,f)),r=-1,i="\r"===t.charAt(d)?d+1:d;continue o;default:-1===r&&(r=l)}}}return n}parse(e){this.document=r.TextDocument.create("","",0,e),this.buffer=e;let t=new A.Dockerfile(this.document),n=this.getParserDirectives(this.document,this.buffer),i=0;this.escapeChar="\\",n.length>0?(t.setDirectives(n),this.escapeChar=t.getEscapeCharacter(),i=this.document.offsetAt(a.Position.create(n.length,0))):I.Util.isUTF8BOM(e.substring(0,1))&&(i=1);for(let e=i;e<this.buffer.length;e++){let n=this.buffer.charAt(e);switch(n){case" ":case"	":case"\r":case"\n":break;case"#":e=this.processComment(t,e);break;default:e=this.processInstruction(t,n,e)}}return t.organizeComments(),t}processInstruction(e,t,n){let r=t,a=-1,i=!1;u:for(let s=n+1;s<this.buffer.length;s++)switch(t=this.buffer.charAt(s)){case this.escapeChar:if(i=!0,"\r"===(t=this.buffer.charAt(s+1))||"\n"===t)-1===a&&(a=s),s++;else if(" "===t||"	"===t){for(let e=s+2;e<this.buffer.length;e++)switch(this.buffer.charAt(e)){case" ":case"	":break;case"\r":case"\n":s=e;continue u;default:a=s+1,r+=this.escapeChar,s=e-2;continue u}a=s+1,r+=this.escapeChar;break u}else a=s+1,r+=this.escapeChar,i=!1;break;case" ":case"	":if(i){i:for(let e=s+1;e<this.buffer.length;e++)switch(this.buffer.charAt(e)){case" ":case"	":break;case"\r":case"\n":s=e;continue u;default:break i}i=!1}return -1===a&&(a=s),s=this.processArguments(e,r,a,n,s),e.addInstruction(this.createInstruction(e,r,n,a,s)),s;case"\r":case"\n":if(i)continue;return -1===a&&(a=s),e.addInstruction(this.createInstruction(e,r,n,s,s)),s;case"#":if(i)continue;default:a=s+1,r+=t,i=!1}return -1===a&&(a=this.buffer.length),e.addInstruction(this.createInstruction(e,r,n,a,this.buffer.length)),this.buffer.length}processHeredocs(e,t){let n=e.getKeyword();if(n===x.Keyword.ONBUILD){if(null===(e=e.getTriggerInstruction()))return t;n=e.getKeyword()}if(n!==x.Keyword.ADD&&n!==x.Keyword.COPY&&n!==x.Keyword.RUN)return t;let r=[],a=!1;for(let t of e.getArguments()){let e=t.getValue();if(e.startsWith("<<")&&e.length>2){e.startsWith("<<-")&&(a=!0);let t=I.Util.parseHeredocName(e);null!==t&&r.push(t)}}if(r.length>0)for(let e of r)t=this.parseHeredoc(e,t,a);return t}processArguments(e,t,n,r,a){let i=!1;c:for(let s=a+1;s<this.buffer.length;s++)switch(this.buffer.charAt(s)){case"\r":case"\n":if(i)continue;return this.processHeredocs(this.createInstruction(e,t,r,n,s),s);case this.escapeChar:let a=this.buffer.charAt(s+1);if("\n"===a||"\r"===a)i=!0,s++;else if(" "===a||"	"===a){for(let e=s+2;e<this.buffer.length;e++)switch(this.buffer.charAt(e)){case" ":case"	":break;case"\r":case"\n":i=!0;default:s=e;continue c}return this.buffer.length}continue;case"#":if(i){s=this.processComment(e,s);continue}break;case" ":case"	":break;default:i&&(i=!1)}return this.buffer.length}processComment(e,t){let n=this.buffer.length;d:for(let e=t+1;e<this.buffer.length;e++)switch(this.buffer.charAt(e)){case"\r":case"\n":n=e;break d}let r=a.Range.create(this.document.positionAt(t),this.document.positionAt(n));return e.addComment(new i.Comment(this.document,r)),n}parseHeredoc(e,t,n){let r=-1,a=!0;for(let i=t;i<this.buffer.length;i++)switch(this.buffer.charAt(i)){case" ":a=!1;break;case"	":n||(a=!1);break;case"\r":case"\n":if(-1!==r&&e===this.buffer.substring(r,i))return i;r=-1,a=!0;break;default:a&&(r=i,a=!1)}return this.buffer.length}createInstruction(e,t,n,r,i){let s=this.document.positionAt(n),o=a.Range.create(s,this.document.positionAt(r)),l=a.Range.create(s,this.document.positionAt(i));return S.createInstruction(this.document,e,this.escapeChar,l,t,o)}}t.Parser=S},4906:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParserDirective=void 0;let r=n(7911),a=n(1738);class i extends a.Line{constructor(e,t,n,r){super(e,t),this.nameRange=n,this.valueRange=r}toString(){return"# "+this.getName()+"="+this.getValue()}getNameRange(){return this.nameRange}getValueRange(){return this.valueRange}getName(){return this.document.getText().substring(this.document.offsetAt(this.nameRange.start),this.document.offsetAt(this.nameRange.end))}getValue(){return this.document.getText().substring(this.document.offsetAt(this.valueRange.start),this.document.offsetAt(this.valueRange.end))}getDirective(){let e=r.Directive[this.getName().toLowerCase()];return void 0===e?null:e}}t.ParserDirective=i},4521:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Property=void 0;let r=n(5993),a=n(2255);class i{constructor(e,t,n,a){this.assignmentOperatorRange=null,this.assignmentOperator=null,this.valueRange=null,this.value=null,this.document=e,this.escapeChar=t,this.nameRange=i.getNameRange(e,n);let s=e.getText().substring(e.offsetAt(this.nameRange.start),e.offsetAt(this.nameRange.end));if(this.name=i.getValue(s,t),a)this.valueRange=a.getRange(),s=e.getText().substring(e.offsetAt(this.valueRange.start),e.offsetAt(this.valueRange.end)),this.value=i.getValue(s,t),this.range=r.Range.create(this.nameRange.start,this.valueRange.end);else{let a=n.getRange();this.nameRange.start.line===a.start.line&&this.nameRange.start.character===a.start.character&&this.nameRange.end.line===a.end.line&&this.nameRange.end.character===a.end.character||(this.valueRange=i.getValueRange(e,n),s=e.getText().substring(e.offsetAt(this.valueRange.start),e.offsetAt(this.valueRange.end)),this.value=i.getValue(s,t),this.assignmentOperatorRange=r.Range.create(this.nameRange.end,this.valueRange.start),this.assignmentOperator="="),this.range=a}}getRange(){return this.range}getName(){return this.name}getNameRange(){return this.nameRange}getValue(){return this.value}getValueRange(){return this.valueRange}getAssignmentOperator(){return this.assignmentOperator}getAssignmentOperatorRange(){return this.assignmentOperatorRange}getUnescapedValue(){if(null===this.valueRange)return null;let e=!1,t="",n=this.document.getText().substring(this.document.offsetAt(this.valueRange.start),this.document.offsetAt(this.valueRange.end));p:for(let r=0;r<n.length;r++){let a=n.charAt(r);switch(a){case this.escapeChar:for(let i=r+1;i<n.length;i++)switch(n.charAt(i)){case"\r":i++;case"\n":e=!0,r=i;continue p;case" ":case"	":break;default:t+=a;continue p}t+=a;break;case"\r":case"\n":break;case" ":case"	":e||(t+=a);break;case"#":if(e)for(let e=r+1;e<n.length;e++)switch(n.charAt(e)){case"\r":e++;case"\n":r=e;continue p}else t+=a;break;default:t+=a,e=!1}}return t}static getNameRange(e,t){let n=t.getValue(),a=n.indexOf("=");if(-1!==a){let i=n.charAt(0),s=n.charAt(a-1);if('"'===i&&'"'===s||"'"===i&&"'"===s||'"'!==i&&"'"!==i)return r.Range.create(t.getRange().start,e.positionAt(e.offsetAt(t.getRange().start)+a))}return t.getRange()}static getValueRange(e,t){return r.Range.create(e.positionAt(e.offsetAt(t.getRange().start)+t.getValue().indexOf("=")+1),e.positionAt(e.offsetAt(t.getRange().end)))}static getValue(e,t){let n=!1,r=a.Util.findLeadingNonWhitespace(e,t);0!==r&&"#"===e.charAt(r)&&(n=!0);let i=(e=e.substring(r)).charAt(0),s=e.charAt(e.length-1),o="'"===i||'"'===i,l="'"===i&&"'"===s,u=!1;if('"'===i)for(let n=1;n<e.length;n++)e.charAt(n)===t?n++:'"'===e.charAt(n)&&n===e.length-1&&(u=!0);(l||u)&&(e=e.substring(1,e.length-1));let c=-1,d="";m:for(let r=0;r<e.length;r++){let a=e.charAt(r);switch(a){case t:if(r+1===e.length){d+=t;break m}if(" "===(a=e.charAt(r+1))||"	"===a)e:for(let i=r+2;i<e.length;i++){let s=e.charAt(i);switch(s){case" ":case"	":break;case"\r":i++;case"\n":n=!0,r=i;continue m;default:if(!u&&!l&&!o){s===t?(d+=a,r+=1):(d=d+a+s,r=i);continue m}break e}}if(u){"\r"===a?(n=!0,r+=2):"\n"===a?(n=!0,r++):'"'!==a&&(a===t&&r++,d+=t);continue}if(l||o){"\r"===a?(n=!0,r+=2):"\n"===a?(n=!0,r++):d+=t;continue}a===t?(d+=t,r++):"\r"===a?(n=!0,r+=2):("\n"===a?n=!0:d+=a,r++);break;case" ":case"	":n&&-1===c&&(c=r),d+=a;break;case"\r":r++;case"\n":n&&-1!==c&&(d=d.substring(0,d.length-(r-c-1)),c=-1);break;case"#":if(n){-1!==c&&(d=d.substring(0,d.length-(r-c)),c=-1);h:for(let t=r+1;t<e.length;t++)switch(e.charAt(t)){case"\r":t++;case"\n":r=t;break h}continue}default:n&&(n=!1,c=-1),d+=a}}return d}}t.Property=i},7291:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyInstruction=void 0;let r=n(5993),a=n(8042),i=n(4521),s=n(2981),o=n(2255);class l extends a.Instruction{constructor(e,t,n,r,a,i){super(e,t,n,r,a,i),this.properties=void 0}getProperties(){if(void 0===this.properties){let e=this.getPropertyArguments();if(0===e.length)this.properties=[];else if(1===e.length)this.properties=[new i.Property(this.document,this.escapeChar,e[0])];else if(2===e.length)-1===e[0].getValue().indexOf("=")?this.properties=[new i.Property(this.document,this.escapeChar,e[0],e[1])]:this.properties=[new i.Property(this.document,this.escapeChar,e[0]),new i.Property(this.document,this.escapeChar,e[1])];else if(-1===e[0].getValue().indexOf("=")){let t=this.document.getText(),n=e[1].getRange().start,a=e[e.length-1].getRange().end;t=t.substring(this.document.offsetAt(n),this.document.offsetAt(a)),this.properties=[new i.Property(this.document,this.escapeChar,e[0],new s.Argument(t,r.Range.create(e[1].getRange().start,e[e.length-1].getRange().end)))]}else{this.properties=[];for(let t=0;t<e.length;t++)this.properties.push(new i.Property(this.document,this.escapeChar,e[t]))}}return this.properties}findTrailingNonWhitespace(e){let t=e.length;e:for(let n=e.length-1;n>=0;n--)switch(e.charAt(n)){case" ":case"	":continue;case"\n":"\r"===e.charAt(n-1)&&(n-=1);case"\r":h:for(let r=n-1;r>=0;r--)switch(e.charAt(r)){case" ":case"	":case"\r":case"\n":case this.escapeChar:continue;default:t=r;break h}break e;default:t=n;break e}return t}getPropertyArguments(){let e=[],t=this.getInstructionRange(),n=this.document.offsetAt(t.end),a=n-this.document.offsetAt(t.start),i=this.getTextContent(),l=i.substring(a),u=o.Util.findLeadingNonWhitespace(l,this.escapeChar);if(-1===u)return[];let c=this.document.positionAt(n+u),d=t.start.line!==c.line,p=!1,m=-1,h=this.findTrailingNonWhitespace(l);i=l.substring(u,h+1);let f=d?-1:0,g=!1;f:for(let t=0;t<i.length;t++){let a=i.charAt(t);switch(a){case this.escapeChar:if(t+1===i.length){p=!0;break f}switch(d||(m=t),i.charAt(t+1)){case" ":case"	":if(!o.Util.isWhitespace(i.charAt(t+2))){t+=1;continue}e:for(let a=t+2;a<i.length;a++)switch(i.charAt(a)){case"\r":a++;case"\n":d=!0,t=a;continue f;case" ":case"	":break;default:e.push(new s.Argument(i.substring(f,t),r.Range.create(this.document.positionAt(n+u+f),this.document.positionAt(n+u+t+2)))),f=a;break e}t=f-1;continue;case"\r":t++;case"\n":d=!0,t+=1;continue;case this.escapeChar:-1===f&&(f=t),t+=1;continue;default:-1===f&&(f=t);continue}case"'":case'"':g&&(this.createSpacedArgument(f,e,i,m,n,u),f=t,g=!1),-1===f&&(f=t);for(let o=t+1;o<i.length;o++)switch(i.charAt(o)){case a:if(" "!==i.charAt(o+1)&&""!==i.charAt(o+1)){t=o;continue f}e.push(new s.Argument(i.substring(f,o+1),r.Range.create(this.document.positionAt(n+u+f),this.document.positionAt(n+u+o+1)))),t=o,f=-1;continue f;case this.escapeChar:o++}break f;case" ":case"	":d?-1!==f&&(g=!0):-1!==f&&(e.push(new s.Argument(i.substring(f,t),r.Range.create(this.document.positionAt(n+u+f),this.document.positionAt(n+u+t)))),f=-1);break;case"\r":t++;case"\n":g=!1;break;case"#":if(d){for(let e=t+1;e<i.length;e++)switch(i.charAt(e)){case"\r":e++;case"\n":t=e,g=!1;continue f}if(-1!==f){let t=i.substring(f,m);e.push(new s.Argument(t,r.Range.create(this.document.positionAt(n+u+f),this.document.positionAt(n+u+m)))),f=-1}break f}-1===f&&(f=t);break;default:if(g&&(this.createSpacedArgument(f,e,i,m,n,u),f=t,g=!1),d=!1,-1===f&&(f=t),"$"===a&&"{"===i.charAt(t+1)){let e=!1,n=!1,r=!1;for(let a=t+1;a<i.length;a++)switch(i.charAt(a)){case this.escapeChar:r=!0;break;case"\r":case"\n":break;case"'":e=!e,r=!1;break;case'"':n=!n,r=!1;break;case" ":case"	":if(r||e||n)break;t=a-1;continue f;case"}":t=a;continue f;default:r=!1}break f}}}if(-1!==f&&f!==i.length){let t=p?i.length-1:i.length,a=i.substring(f,t);e.push(new s.Argument(a,r.Range.create(this.document.positionAt(n+u+f),this.document.positionAt(n+u+t))))}return e}createSpacedArgument(e,t,n,a,i,o){-1!==e&&t.push(new s.Argument(n.substring(e,a),r.Range.create(this.document.positionAt(i+o+e),this.document.positionAt(i+o+a))))}}t.PropertyInstruction=l},2255:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0;class n{static isUTF8BOM(e){let t=Uint8Array.from(Buffer.from(e,"UTF-8"));return 239===t[0]&&187==t[1]&&191==t[2]}static isWhitespace(e){return" "===e||"	"===e||n.isNewline(e)}static isNewline(e){return"\r"===e||"\n"===e}static findLeadingNonWhitespace(e,t){e:for(let n=0;n<e.length;n++)switch(e.charAt(n)){case" ":case"	":continue;case t:i:for(let t=n+1;t<e.length;t++)switch(e.charAt(t)){case" ":case"	":continue;case"\r":n=t+1;continue e;case"\n":n=t;continue e;default:break i}return -1;default:return n}return -1}static isInsideRange(e,t){return t.start.line===t.end.line?t.start.line===e.line&&t.start.character<=e.character&&e.character<=t.end.character:t.start.line===e.line?t.start.character<=e.character:t.end.line===e.line?e.character<=t.end.character:t.start.line<e.line&&e.line<t.end.line}static parseHeredocName(e){if("-"===(e=e.substring(2)).charAt(0)&&(e=e.substring(1)),'"'===e.charAt(0)){if('"'!==e.charAt(e.length-1))return null;e=e.substring(1,e.length-1)}if("'"===e.charAt(0)){if("'"!==e.charAt(e.length-1))return null;e=e.substring(1,e.length-1)}return"<"===e.charAt(0)?null:e}}t.Util=n},90:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Variable=void 0;class n{constructor(e,t,n,r,a,i,s,o,l,u){this.name=e,this.nameRange=t,this.range=n,this.modifier=r,this.modifierRange=a,this.substitutionParameter=i,this.substitutionRange=s,this.defined=o,this.buildVariable=l,this.stringValue=u}toString(){return this.stringValue}getName(){return this.name}getNameRange(){return this.nameRange}getRange(){return this.range}getModifier(){return this.modifier}getModifierRange(){return this.modifierRange}getSubstitutionParameter(){return this.substitutionParameter}getSubstitutionRange(){return this.substitutionRange}isDefined(){return this.defined}isBuildVariable(){return!0===this.buildVariable}isEnvironmentVariable(){return!1===this.buildVariable}}t.Variable=n},3278:(e,t,n)=>{"use strict";e.exports=n(517)},3023:function(e,t,n){var r;e=n.nmd(e),(function(){"use strict";var a={function:!0,object:!0},i=a[typeof window]&&window||this,s=a[typeof t]&&t,o=a.object&&e&&!e.nodeType&&e,l=s&&o&&"object"==typeof global&&global;l&&(l.global===l||l.window===l||l.self===l)&&(i=l);var u=/\bOpera/,c=Object.prototype,d=c.hasOwnProperty,p=c.toString;function m(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function h(e){return e=v(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:m(e)}function f(e,t){for(var n in e)d.call(e,n)&&t(e[n],n,e)}function g(e){return null==e?m(e):p.call(e).slice(8,-1)}function y(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var n=null;return function(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r&&r>-1&&r<=9007199254740991)for(;++n<r;)t(e[n],n,e);else f(e,t)}(e,function(r,a){n=t(n,r,a,e)}),n}function v(e){return String(e).replace(/^ +| +$/g,"")}var w=function e(t){var n,r,a,s,o,l=i,c=t&&"object"==typeof t&&"String"!=g(t);c&&(l=t,t=null);var d=l.navigator||{},m=d.userAgent||"";t||(t=m);var w=c?!!d.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(p.toString()),_="Object",E=c&&l.java?"JavaPackage":g(l.java),T=/\bJava/.test(E)&&l.java,A=T&&g(l.environment)==(c?_:"Environment"),I=l.document||{},x=l.operamini||l.opera,S=u.test(S=c&&x?x["[[Class]]"]:g(x))?S:x=null,N=t,k=[],R=null,O=t==m,C=O&&x&&"function"==typeof x.version&&x.version(),P=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)}),D=b(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],function(e,n){return e||RegExp("\\b"+(n.pattern||y(n))+"\\b","i").exec(t)&&(n.label||n)}),M=V([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),j=b({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}},function(e,n,r){return e||(n[M]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(M)]||RegExp("\\b"+y(r)+"(?:\\b|\\w*\\d)","i").exec(t))&&r}),F=b(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],function(e,n){var r,a,i,s=n.pattern||y(n);return!e&&(e=RegExp("\\b"+s+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(r=e,a=n.label||n,i={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},s&&a&&/^Win/i.test(r)&&!/^Windows Phone /i.test(r)&&(i=i[/[\d.]+$/.exec(r)])&&(r="Windows "+i),r=String(r),s&&a&&(r=r.replace(RegExp(s,"i"),a)),e=r=h(r.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])),e});function V(e){return b(e,function(e,n){var r=n.pattern||y(n);return!e&&(e=RegExp("\\b"+r+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+r+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+r+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(r,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=h(e[0].replace(RegExp(r,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function U(e){return b(e,function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})}if(P&&(P=[P]),/\bAndroid\b/.test(F)&&!M&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(M=v(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),j&&!M?M=V([j]):j&&M&&(M=M.replace(RegExp("^("+y(j)+")[-_.\\s]","i"),j+" ").replace(RegExp("^("+y(j)+")[-_.]?(\\w)","i"),j+" $2")),(s=/\bGoogle TV\b/.exec(M))&&(M=s[0]),/\bSimulator\b/i.test(t)&&(M=(M?M+" ":"")+"Simulator"),"Opera Mini"==D&&/\bOPiOS\b/.test(t)&&k.push("running in Turbo/Uncompressed mode"),"IE"==D&&/\blike iPhone OS\b/.test(t)?(j=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,M=s.product):/^iP/.test(M)?(D||(D="Safari"),F="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==D&&/^Linux\b/i.test(F)?F="Kubuntu":j&&"Google"!=j&&(/Chrome/.test(D)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(M))||/\bAndroid\b/.test(F)&&/^Chrome/.test(D)&&/\bVersion\//i.test(t)?(D="Android Browser",F=/\bAndroid\b/.test(F)?F:"Android"):"Silk"==D?(/\bMobi/i.test(t)||(F="Android",k.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&k.unshift("accelerated")):"UC Browser"==D&&/\bUCWEB\b/.test(t)?k.push("speed mode"):"PaleMoon"==D&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?k.push("identifying as Firefox "+s[1]):"Firefox"==D&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(F||(F="Firefox OS"),M||(M=s[1])):!D||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(D))?(D&&!M&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(D=null),(s=M||j||F)&&(M||j||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(F))&&(D=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(F)?F:s)+" Browser")):"Electron"==D&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&k.push("Chromium "+s),C||(C=U(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",y(D),"(?:Firefox|Minefield|NetFront)"])),(s="iCab"==P&&parseFloat(C)>3&&"WebKit"||/\bOpera\b/.test(D)&&(/\bOPR\b/.test(t)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(P)&&"WebKit"||!P&&/\bMSIE\b/i.test(t)&&("Mac OS"==F?"Tasman":"Trident")||"WebKit"==P&&/\bPlayStation\b(?! Vita\b)/i.test(D)&&"NetFront")&&(P=[s]),"IE"==D&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(D+=" Mobile",F="Windows Phone "+(/\+$/.test(s)?s:s+".x"),k.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(D="IE Mobile",F="Windows Phone 8.x",k.unshift("desktop mode"),C||(C=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=D&&"Trident"==P&&(s=/\brv:([\d.]+)/.exec(t))&&(D&&k.push("identifying as "+D+(C?" "+C:"")),D="IE",C=s[1]),O){if(r="global",a=null!=(n=l)?typeof n[r]:"number",/^(?:boolean|number|string|undefined)$/.test(a)||"object"==a&&!n[r])g(s=l.runtime)==(c?_:"ScriptBridgingProxyObject")?(D="Adobe AIR",F=s.flash.system.Capabilities.os):g(s=l.phantom)==(c?_:"RuntimeObject")?(D="PhantomJS",C=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof I.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(C=[C,I.documentMode],(s=+s[1]+4)!=C[1]&&(k.push("IE "+C[1]+" mode"),P&&(P[1]=""),C[1]=s),C="IE"==D?String(C[1].toFixed(1)):C[0]):"number"==typeof I.documentMode&&/^(?:Chrome|Firefox)\b/.test(D)&&(k.push("masking as "+D+" "+C),D="IE",C="11.0",P=["Trident"],F="Windows");else if(T&&(N=(s=T.lang.System).getProperty("os.arch"),F=F||s.getProperty("os.name")+" "+s.getProperty("os.version")),A){try{C=l.require("ringo/engine").version.join("."),D="RingoJS"}catch(e){(s=l.system)&&s.global.system==l.system&&(D="Narwhal",F||(F=s[0].os||null))}D||(D="Rhino")}else"object"==typeof l.process&&!l.process.browser&&(s=l.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(k.push("Node "+s.versions.node),D="Electron",C=s.versions.electron):"string"==typeof s.versions.nw&&(k.push("Chromium "+C,"Node "+s.versions.node),D="NW.js",C=s.versions.nw)),D||(D="Node.js",N=s.arch,F=s.platform,C=(C=/[\d.]+/.exec(s.version))?C[0]:null));F=F&&h(F)}if(C&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(C)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(O&&d.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(R=/b/i.test(s)?"beta":"alpha",C=C.replace(RegExp(s+"\\+?$"),"")+("beta"==R?T?"b":"":T?"a":"")+(/\d+\+?/.exec(s)||"")),"Fennec"==D||"Firefox"==D&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(F))D="Firefox Mobile";else if("Maxthon"==D&&C)C=C.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(M))"Xbox 360"==M&&(F=null),"Xbox 360"==M&&/\bIEMobile\b/.test(t)&&k.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(D)||D&&!M&&!/Browser|Mobi/.test(D))&&("Windows CE"==F||/Mobi/i.test(t)))D+=" Mobile";else if("IE"==D&&O)try{null===l.external&&k.unshift("platform preview")}catch(e){k.unshift("embedded")}else(/\bBlackBerry\b/.test(M)||/\bBB10\b/.test(t))&&(s=(RegExp(M.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||C)?(F=((s=[s,/BB10/.test(t)])[1]?(M=null,j="BlackBerry"):"Device Software")+" "+s[0],C=null):this!=f&&"Wii"!=M&&(O&&x||/Opera/.test(D)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==D&&/\bOS X (?:\d+\.){2,}/.test(F)||"IE"==D&&(F&&!/^Win/.test(F)&&C>5.5||/\bWindows XP\b/.test(F)&&C>8||8==C&&!/\bTrident\b/.test(t)))&&!u.test(s=e.call(f,t.replace(u,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),u.test(D)?(/\bIE\b/.test(s)&&"Mac OS"==F&&(F=null),s="identify"+s):(s="mask"+s,D=S?h(S.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(F=null),O||(C=null)),P=["Presto"],k.push(s));(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==D&&"+"==s[1].slice(-1)?(D="WebKit Nightly",R="alpha",C=s[1].slice(0,-1)):(C==s[1]||C==(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1]))&&(C=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==P&&(P=["Blink"]),O&&(w||s[1])?(P&&(P[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=P?"27":"28")):(P&&(P[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),P&&(P[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==D&&(!C||parseInt(C)>45)?C=s:"Chrome"==D&&/\bHeadlessChrome/i.test(t)&&k.unshift("headless")),"Opera"==D&&(s=/\bzbov|zvav$/.exec(F))?(D+=" ",k.unshift("desktop mode"),"zvav"==s?(D+="Mini",C=null):D+="Mobile",F=F.replace(RegExp(" *"+s+"$"),"")):"Safari"==D&&/\bChrome\b/.exec(P&&P[1])?(k.unshift("desktop mode"),D="Chrome Mobile",C=null,/\bOS X\b/.test(F)?(j="Apple",F="iOS 4.3+"):F=null):/\bSRWare Iron\b/.test(D)&&!C&&(C=U("Chrome")),C&&0==C.indexOf(s=/[\d.]+$/.exec(F))&&t.indexOf("/"+s+"-")>-1&&(F=v(F.replace(s,""))),F&&-1!=F.indexOf(D)&&!RegExp(D+" OS").test(F)&&(F=F.replace(RegExp(" *"+y(D)+" *"),"")),P&&!/\b(?:Avant|Nook)\b/.test(D)&&(/Browser|Lunascape|Maxthon/.test(D)||"Safari"!=D&&/^iOS/.test(F)&&/\bSafari\b/.test(P[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(D)&&P[1])&&(s=P[P.length-1])&&k.push(s),k.length&&(k=["("+k.join("; ")+")"]),j&&M&&0>M.indexOf(j)&&k.push("on "+j),M&&k.push((/^on /.test(k[k.length-1])?"":"on ")+M),F&&(o=(s=/ ([\d.+]+)$/.exec(F))&&"/"==F.charAt(F.length-s[0].length-1),F={architecture:32,family:s&&!o?F.replace(s[0],""):F,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!o?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(N))&&!/\bi686\b/i.test(N)?(F&&(F.architecture=64,F.family=F.family.replace(RegExp(" *"+s),"")),D&&(/\bWOW64\b/i.test(t)||O&&/\w(?:86|32)$/.test(d.cpuClass||d.platform)&&!/\bWin64; x64\b/i.test(t))&&k.unshift("32-bit")):F&&/^OS X/.test(F.family)&&"Chrome"==D&&parseFloat(C)>=39&&(F.architecture=64),t||(t=null);var L={};return L.description=t,L.layout=P&&P[0],L.manufacturer=j,L.name=D,L.prerelease=R,L.product=M,L.ua=t,L.version=D&&C,L.os=F||{architecture:null,family:null,version:null,toString:function(){return"null"}},L.parse=e,L.toString=function(){return this.description||""},L.version&&k.unshift(C),L.name&&k.unshift(D),F&&D&&!(F==String(F).split(" ")[0]&&(F==D.split(" ")[0]||M))&&k.push(M?"("+F+")":"on "+F),k.length&&(L.description=k.join(" ")),L}();i.platform=w,void 0!==(r=(function(){return w}).call(t,n,t,e))&&(e.exports=r)}).call(this)},9145:e=>{"use strict";let t="undefined"!=typeof Buffer,n=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,r=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function a(e,a,s){null==s&&null!==a&&"object"==typeof a&&(s=a,a=void 0),t&&Buffer.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let o=JSON.parse(e,a);if(null===o||"object"!=typeof o)return o;let l=s&&s.protoAction||"error",u=s&&s.constructorAction||"error";if("ignore"===l&&"ignore"===u)return o;if("ignore"!==l&&"ignore"!==u){if(!1===n.test(e)&&!1===r.test(e))return o}else if("ignore"!==l&&"ignore"===u){if(!1===n.test(e))return o}else if(!1===r.test(e))return o;return i(o,{protoAction:l,constructorAction:u,safe:s&&s.safe})}function i(e,{protoAction:t="error",constructorAction:n="error",safe:r}={}){let a=[e];for(;a.length;){let e=a;for(let i of(a=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(i,"__proto__")){if(!0===r)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete i.__proto__}if("ignore"!==n&&Object.prototype.hasOwnProperty.call(i,"constructor")&&Object.prototype.hasOwnProperty.call(i.constructor,"prototype")){if(!0===r)return null;if("error"===n)throw SyntaxError("Object contains forbidden prototype property");delete i.constructor}for(let e in i){let t=i[e];t&&"object"==typeof t&&a.push(t)}}}return e}function s(e,t,n){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return a(e,t,n)}finally{Error.stackTraceLimit=r}}e.exports=s,e.exports.default=s,e.exports.parse=s,e.exports.safeParse=function(e,t){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return a(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=n}},e.exports.scan=i},5993:(e,t,n)=>{var r,a,i;!function(s){if("object"==typeof e.exports){var o=s(n(556),t);void 0!==o&&(e.exports=o)}else a=[n,t],void 0!==(i="function"==typeof(r=s)?r.apply(t,a):r)&&(e.exports=i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=t.EOL=t.WorkspaceFolder=t.InlineCompletionContext=t.SelectedCompletionInfo=t.InlineCompletionTriggerKind=t.InlineCompletionList=t.InlineCompletionItem=t.StringValue=t.InlayHint=t.InlayHintLabelPart=t.InlayHintKind=t.InlineValueContext=t.InlineValueEvaluatableExpression=t.InlineValueVariableLookup=t.InlineValueText=t.SemanticTokens=t.SemanticTokenModifiers=t.SemanticTokenTypes=t.SelectionRange=t.DocumentLink=t.FormattingOptions=t.CodeLens=t.CodeAction=t.CodeActionContext=t.CodeActionTriggerKind=t.CodeActionKind=t.DocumentSymbol=t.WorkspaceSymbol=t.SymbolInformation=t.SymbolTag=t.SymbolKind=t.DocumentHighlight=t.DocumentHighlightKind=t.SignatureInformation=t.ParameterInformation=t.Hover=t.MarkedString=t.CompletionList=t.CompletionItem=t.CompletionItemLabelDetails=t.InsertTextMode=t.InsertReplaceEdit=t.CompletionItemTag=t.InsertTextFormat=t.CompletionItemKind=t.MarkupContent=t.MarkupKind=t.TextDocumentItem=t.OptionalVersionedTextDocumentIdentifier=t.VersionedTextDocumentIdentifier=t.TextDocumentIdentifier=t.WorkspaceChange=t.WorkspaceEdit=t.DeleteFile=t.RenameFile=t.CreateFile=t.TextDocumentEdit=t.AnnotatedTextEdit=t.ChangeAnnotationIdentifier=t.ChangeAnnotation=t.TextEdit=t.Command=t.Diagnostic=t.CodeDescription=t.DiagnosticTag=t.DiagnosticSeverity=t.DiagnosticRelatedInformation=t.FoldingRange=t.FoldingRangeKind=t.ColorPresentation=t.ColorInformation=t.Color=t.LocationLink=t.Location=t.Range=t.Position=t.uinteger=t.integer=t.URI=t.DocumentUri=void 0,(ei||(t.DocumentUri=ei={})).is=function(e){return"string"==typeof e},(es||(t.URI=es={})).is=function(e){return"string"==typeof e},(j=eo||(t.integer=eo={})).MIN_VALUE=-2147483648,j.MAX_VALUE=2147483647,j.is=function(e){return"number"==typeof e&&j.MIN_VALUE<=e&&e<=j.MAX_VALUE},(F=el||(t.uinteger=el={})).MIN_VALUE=0,F.MAX_VALUE=2147483647,F.is=function(e){return"number"==typeof e&&F.MIN_VALUE<=e&&e<=F.MAX_VALUE},(V=eu||(t.Position=eu={})).create=function(e,t){return e===Number.MAX_VALUE&&(e=el.MAX_VALUE),t===Number.MAX_VALUE&&(t=el.MAX_VALUE),{line:e,character:t}},V.is=function(e){return tw.objectLiteral(e)&&tw.uinteger(e.line)&&tw.uinteger(e.character)},(U=ec||(t.Range=ec={})).create=function(e,t,n,r){if(tw.uinteger(e)&&tw.uinteger(t)&&tw.uinteger(n)&&tw.uinteger(r))return{start:eu.create(e,t),end:eu.create(n,r)};if(eu.is(e)&&eu.is(t))return{start:e,end:t};throw Error("Range#create called with invalid arguments[".concat(e,", ").concat(t,", ").concat(n,", ").concat(r,"]"))},U.is=function(e){return tw.objectLiteral(e)&&eu.is(e.start)&&eu.is(e.end)},(L=ed||(t.Location=ed={})).create=function(e,t){return{uri:e,range:t}},L.is=function(e){return tw.objectLiteral(e)&&ec.is(e.range)&&(tw.string(e.uri)||tw.undefined(e.uri))},($=ep||(t.LocationLink=ep={})).create=function(e,t,n,r){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:r}},$.is=function(e){return tw.objectLiteral(e)&&ec.is(e.targetRange)&&tw.string(e.targetUri)&&ec.is(e.targetSelectionRange)&&(ec.is(e.originSelectionRange)||tw.undefined(e.originSelectionRange))},(B=em||(t.Color=em={})).create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},B.is=function(e){return tw.objectLiteral(e)&&tw.numberRange(e.red,0,1)&&tw.numberRange(e.green,0,1)&&tw.numberRange(e.blue,0,1)&&tw.numberRange(e.alpha,0,1)},(Z=eh||(t.ColorInformation=eh={})).create=function(e,t){return{range:e,color:t}},Z.is=function(e){return tw.objectLiteral(e)&&ec.is(e.range)&&em.is(e.color)},(G=ef||(t.ColorPresentation=ef={})).create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},G.is=function(e){return tw.objectLiteral(e)&&tw.string(e.label)&&(tw.undefined(e.textEdit)||eA.is(e))&&(tw.undefined(e.additionalTextEdits)||tw.typedArray(e.additionalTextEdits,eA.is))},(W=eg||(t.FoldingRangeKind=eg={})).Comment="comment",W.Imports="imports",W.Region="region",(K=ey||(t.FoldingRange=ey={})).create=function(e,t,n,r,a,i){var s={startLine:e,endLine:t};return tw.defined(n)&&(s.startCharacter=n),tw.defined(r)&&(s.endCharacter=r),tw.defined(a)&&(s.kind=a),tw.defined(i)&&(s.collapsedText=i),s},K.is=function(e){return tw.objectLiteral(e)&&tw.uinteger(e.startLine)&&tw.uinteger(e.startLine)&&(tw.undefined(e.startCharacter)||tw.uinteger(e.startCharacter))&&(tw.undefined(e.endCharacter)||tw.uinteger(e.endCharacter))&&(tw.undefined(e.kind)||tw.string(e.kind))},(Y=eb||(t.DiagnosticRelatedInformation=eb={})).create=function(e,t){return{location:e,message:t}},Y.is=function(e){return tw.defined(e)&&ed.is(e.location)&&tw.string(e.message)},(X=ev||(t.DiagnosticSeverity=ev={})).Error=1,X.Warning=2,X.Information=3,X.Hint=4,(J=ew||(t.DiagnosticTag=ew={})).Unnecessary=1,J.Deprecated=2,(e_||(t.CodeDescription=e_={})).is=function(e){return tw.objectLiteral(e)&&tw.string(e.href)},(z=eE||(t.Diagnostic=eE={})).create=function(e,t,n,r,a,i){var s={range:e,message:t};return tw.defined(n)&&(s.severity=n),tw.defined(r)&&(s.code=r),tw.defined(a)&&(s.source=a),tw.defined(i)&&(s.relatedInformation=i),s},z.is=function(e){var t;return tw.defined(e)&&ec.is(e.range)&&tw.string(e.message)&&(tw.number(e.severity)||tw.undefined(e.severity))&&(tw.integer(e.code)||tw.string(e.code)||tw.undefined(e.code))&&(tw.undefined(e.codeDescription)||tw.string(null===(t=e.codeDescription)||void 0===t?void 0:t.href))&&(tw.string(e.source)||tw.undefined(e.source))&&(tw.undefined(e.relatedInformation)||tw.typedArray(e.relatedInformation,eb.is))},(q=eT||(t.Command=eT={})).create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a={title:e,command:t};return tw.defined(n)&&n.length>0&&(a.arguments=n),a},q.is=function(e){return tw.defined(e)&&tw.string(e.title)&&tw.string(e.command)},(H=eA||(t.TextEdit=eA={})).replace=function(e,t){return{range:e,newText:t}},H.insert=function(e,t){return{range:{start:e,end:e},newText:t}},H.del=function(e){return{range:e,newText:""}},H.is=function(e){return tw.objectLiteral(e)&&tw.string(e.newText)&&ec.is(e.range)},(Q=eI||(t.ChangeAnnotation=eI={})).create=function(e,t,n){var r={label:e};return void 0!==t&&(r.needsConfirmation=t),void 0!==n&&(r.description=n),r},Q.is=function(e){return tw.objectLiteral(e)&&tw.string(e.label)&&(tw.boolean(e.needsConfirmation)||void 0===e.needsConfirmation)&&(tw.string(e.description)||void 0===e.description)},(ex||(t.ChangeAnnotationIdentifier=ex={})).is=function(e){return tw.string(e)},(ee=eS||(t.AnnotatedTextEdit=eS={})).replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},ee.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},ee.del=function(e,t){return{range:e,newText:"",annotationId:t}},ee.is=function(e){return eA.is(e)&&(eI.is(e.annotationId)||ex.is(e.annotationId))},(et=eN||(t.TextDocumentEdit=eN={})).create=function(e,t){return{textDocument:e,edits:t}},et.is=function(e){return tw.defined(e)&&eM.is(e.textDocument)&&Array.isArray(e.edits)},(en=ek||(t.CreateFile=ek={})).create=function(e,t,n){var r={kind:"create",uri:e};return void 0!==t&&(void 0!==t.overwrite||void 0!==t.ignoreIfExists)&&(r.options=t),void 0!==n&&(r.annotationId=n),r},en.is=function(e){return e&&"create"===e.kind&&tw.string(e.uri)&&(void 0===e.options||(void 0===e.options.overwrite||tw.boolean(e.options.overwrite))&&(void 0===e.options.ignoreIfExists||tw.boolean(e.options.ignoreIfExists)))&&(void 0===e.annotationId||ex.is(e.annotationId))},(er=eR||(t.RenameFile=eR={})).create=function(e,t,n,r){var a={kind:"rename",oldUri:e,newUri:t};return void 0!==n&&(void 0!==n.overwrite||void 0!==n.ignoreIfExists)&&(a.options=n),void 0!==r&&(a.annotationId=r),a},er.is=function(e){return e&&"rename"===e.kind&&tw.string(e.oldUri)&&tw.string(e.newUri)&&(void 0===e.options||(void 0===e.options.overwrite||tw.boolean(e.options.overwrite))&&(void 0===e.options.ignoreIfExists||tw.boolean(e.options.ignoreIfExists)))&&(void 0===e.annotationId||ex.is(e.annotationId))},(ea=eO||(t.DeleteFile=eO={})).create=function(e,t,n){var r={kind:"delete",uri:e};return void 0!==t&&(void 0!==t.recursive||void 0!==t.ignoreIfNotExists)&&(r.options=t),void 0!==n&&(r.annotationId=n),r},ea.is=function(e){return e&&"delete"===e.kind&&tw.string(e.uri)&&(void 0===e.options||(void 0===e.options.recursive||tw.boolean(e.options.recursive))&&(void 0===e.options.ignoreIfNotExists||tw.boolean(e.options.ignoreIfNotExists)))&&(void 0===e.annotationId||ex.is(e.annotationId))},(eC||(t.WorkspaceEdit=eC={})).is=function(e){return e&&(void 0!==e.changes||void 0!==e.documentChanges)&&(void 0===e.documentChanges||e.documentChanges.every(function(e){return tw.string(e.kind)?ek.is(e)||eR.is(e)||eO.is(e):eN.is(e)}))};var n,r,a,i,s,o,l,u,c,d,p,m,h,f,g,y,b,v,w,_,E,T,A,I,x,S,N,k,R,O,C,P,D,M,j,F,V,U,L,$,B,Z,G,W,K,Y,X,J,z,q,H,Q,ee,et,en,er,ea,ei,es,eo,el,eu,ec,ed,ep,em,eh,ef,eg,ey,eb,ev,ew,e_,eE,eT,eA,eI,ex,eS,eN,ek,eR,eO,eC,eP,eD,eM,ej,eF,eV,eU,eL,e$,eB,eZ,eG,eW,eK,eY,eX,eJ,ez,eq,eH,eQ,e0,e1,e2,e3,e9,e4,e5,e6,e8,e7,te,tt,tn,tr,ta,ti,ts,to,tl,tu,tc,td,tp,tm,th,tf,tg,ty,tb,tv,tw,t_=function(){function e(e,t){this.edits=e,this.changeAnnotations=t}return e.prototype.insert=function(e,t,n){var r,a;if(void 0===n?r=eA.insert(e,t):ex.is(n)?(a=n,r=eS.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),a=this.changeAnnotations.manage(n),r=eS.insert(e,t,a)),this.edits.push(r),void 0!==a)return a},e.prototype.replace=function(e,t,n){var r,a;if(void 0===n?r=eA.replace(e,t):ex.is(n)?(a=n,r=eS.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),a=this.changeAnnotations.manage(n),r=eS.replace(e,t,a)),this.edits.push(r),void 0!==a)return a},e.prototype.delete=function(e,t){var n,r;if(void 0===t?n=eA.del(e):ex.is(t)?(r=t,n=eS.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(t),n=eS.del(e,r)),this.edits.push(n),void 0!==r)return r},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e.prototype.assertChangeAnnotations=function(e){if(void 0===e)throw Error("Text edit change is not configured to manage change annotations.")},e}(),tE=function(){function e(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}return e.prototype.all=function(){return this._annotations},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.manage=function(e,t){var n;if(ex.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw Error("Id ".concat(n," is already in use."));if(void 0===t)throw Error("No annotation provided for id ".concat(n));return this._annotations[n]=t,this._size++,n},e.prototype.nextId=function(){return this._counter++,this._counter.toString()},e}(),tT=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new tE(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(e){if(eN.is(e)){var n=new t_(e.edits,t._changeAnnotations);t._textEditChanges[e.textDocument.uri]=n}})):e.changes&&Object.keys(e.changes).forEach(function(n){var r=new t_(e.changes[n]);t._textEditChanges[n]=r})):this._workspaceEdit={}}return Object.defineProperty(e.prototype,"edit",{get:function(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),e.prototype.getTextEditChange=function(e){if(eM.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw Error("Workspace edit is not configured for document changes.");var t={uri:e.uri,version:e.version},n=this._textEditChanges[t.uri];if(!n){var r=[],a={textDocument:t,edits:r};this._workspaceEdit.documentChanges.push(a),n=new t_(r,this._changeAnnotations),this._textEditChanges[t.uri]=n}return n}if(this.initChanges(),void 0===this._workspaceEdit.changes)throw Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[e];if(!n){var r=[];this._workspaceEdit.changes[e]=r,n=new t_(r),this._textEditChanges[e]=n}return n},e.prototype.initDocumentChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new tE,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},e.prototype.initChanges=function(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))},e.prototype.createFile=function(e,t,n){var r,a,i;if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw Error("Workspace edit is not configured for document changes.");if(eI.is(t)||ex.is(t)?r=t:n=t,void 0===r?a=ek.create(e,n):(i=ex.is(r)?r:this._changeAnnotations.manage(r),a=ek.create(e,n,i)),this._workspaceEdit.documentChanges.push(a),void 0!==i)return i},e.prototype.renameFile=function(e,t,n,r){var a,i,s;if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw Error("Workspace edit is not configured for document changes.");if(eI.is(n)||ex.is(n)?a=n:r=n,void 0===a?i=eR.create(e,t,r):(s=ex.is(a)?a:this._changeAnnotations.manage(a),i=eR.create(e,t,r,s)),this._workspaceEdit.documentChanges.push(i),void 0!==s)return s},e.prototype.deleteFile=function(e,t,n){var r,a,i;if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw Error("Workspace edit is not configured for document changes.");if(eI.is(t)||ex.is(t)?r=t:n=t,void 0===r?a=eO.create(e,n):(i=ex.is(r)?r:this._changeAnnotations.manage(r),a=eO.create(e,n,i)),this._workspaceEdit.documentChanges.push(a),void 0!==i)return i},e}();t.WorkspaceChange=tT,(n=eP||(t.TextDocumentIdentifier=eP={})).create=function(e){return{uri:e}},n.is=function(e){return tw.defined(e)&&tw.string(e.uri)},(r=eD||(t.VersionedTextDocumentIdentifier=eD={})).create=function(e,t){return{uri:e,version:t}},r.is=function(e){return tw.defined(e)&&tw.string(e.uri)&&tw.integer(e.version)},(a=eM||(t.OptionalVersionedTextDocumentIdentifier=eM={})).create=function(e,t){return{uri:e,version:t}},a.is=function(e){return tw.defined(e)&&tw.string(e.uri)&&(null===e.version||tw.integer(e.version))},(i=ej||(t.TextDocumentItem=ej={})).create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},i.is=function(e){return tw.defined(e)&&tw.string(e.uri)&&tw.string(e.languageId)&&tw.integer(e.version)&&tw.string(e.text)},(s=eF||(t.MarkupKind=eF={})).PlainText="plaintext",s.Markdown="markdown",s.is=function(e){return e===s.PlainText||e===s.Markdown},(eV||(t.MarkupContent=eV={})).is=function(e){return tw.objectLiteral(e)&&eF.is(e.kind)&&tw.string(e.value)},(o=eU||(t.CompletionItemKind=eU={})).Text=1,o.Method=2,o.Function=3,o.Constructor=4,o.Field=5,o.Variable=6,o.Class=7,o.Interface=8,o.Module=9,o.Property=10,o.Unit=11,o.Value=12,o.Enum=13,o.Keyword=14,o.Snippet=15,o.Color=16,o.File=17,o.Reference=18,o.Folder=19,o.EnumMember=20,o.Constant=21,o.Struct=22,o.Event=23,o.Operator=24,o.TypeParameter=25,(l=eL||(t.InsertTextFormat=eL={})).PlainText=1,l.Snippet=2,(e$||(t.CompletionItemTag=e$={})).Deprecated=1,(u=eB||(t.InsertReplaceEdit=eB={})).create=function(e,t,n){return{newText:e,insert:t,replace:n}},u.is=function(e){return e&&tw.string(e.newText)&&ec.is(e.insert)&&ec.is(e.replace)},(c=eZ||(t.InsertTextMode=eZ={})).asIs=1,c.adjustIndentation=2,(eG||(t.CompletionItemLabelDetails=eG={})).is=function(e){return e&&(tw.string(e.detail)||void 0===e.detail)&&(tw.string(e.description)||void 0===e.description)},(eW||(t.CompletionItem=eW={})).create=function(e){return{label:e}},(eK||(t.CompletionList=eK={})).create=function(e,t){return{items:e||[],isIncomplete:!!t}},(d=eY||(t.MarkedString=eY={})).fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},d.is=function(e){return tw.string(e)||tw.objectLiteral(e)&&tw.string(e.language)&&tw.string(e.value)},(eX||(t.Hover=eX={})).is=function(e){return!!e&&tw.objectLiteral(e)&&(eV.is(e.contents)||eY.is(e.contents)||tw.typedArray(e.contents,eY.is))&&(void 0===e.range||ec.is(e.range))},(eJ||(t.ParameterInformation=eJ={})).create=function(e,t){return t?{label:e,documentation:t}:{label:e}},(ez||(t.SignatureInformation=ez={})).create=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var a={label:e};return tw.defined(t)&&(a.documentation=t),tw.defined(n)?a.parameters=n:a.parameters=[],a},(p=eq||(t.DocumentHighlightKind=eq={})).Text=1,p.Read=2,p.Write=3,(eH||(t.DocumentHighlight=eH={})).create=function(e,t){var n={range:e};return tw.number(t)&&(n.kind=t),n},(m=eQ||(t.SymbolKind=eQ={})).File=1,m.Module=2,m.Namespace=3,m.Package=4,m.Class=5,m.Method=6,m.Property=7,m.Field=8,m.Constructor=9,m.Enum=10,m.Interface=11,m.Function=12,m.Variable=13,m.Constant=14,m.String=15,m.Number=16,m.Boolean=17,m.Array=18,m.Object=19,m.Key=20,m.Null=21,m.EnumMember=22,m.Struct=23,m.Event=24,m.Operator=25,m.TypeParameter=26,(e0||(t.SymbolTag=e0={})).Deprecated=1,(e1||(t.SymbolInformation=e1={})).create=function(e,t,n,r,a){var i={name:e,kind:t,location:{uri:r,range:n}};return a&&(i.containerName=a),i},(e2||(t.WorkspaceSymbol=e2={})).create=function(e,t,n,r){return void 0!==r?{name:e,kind:t,location:{uri:n,range:r}}:{name:e,kind:t,location:{uri:n}}},(h=e3||(t.DocumentSymbol=e3={})).create=function(e,t,n,r,a,i){var s={name:e,detail:t,kind:n,range:r,selectionRange:a};return void 0!==i&&(s.children=i),s},h.is=function(e){return e&&tw.string(e.name)&&tw.number(e.kind)&&ec.is(e.range)&&ec.is(e.selectionRange)&&(void 0===e.detail||tw.string(e.detail))&&(void 0===e.deprecated||tw.boolean(e.deprecated))&&(void 0===e.children||Array.isArray(e.children))&&(void 0===e.tags||Array.isArray(e.tags))},(f=e9||(t.CodeActionKind=e9={})).Empty="",f.QuickFix="quickfix",f.Refactor="refactor",f.RefactorExtract="refactor.extract",f.RefactorInline="refactor.inline",f.RefactorRewrite="refactor.rewrite",f.Source="source",f.SourceOrganizeImports="source.organizeImports",f.SourceFixAll="source.fixAll",(g=e4||(t.CodeActionTriggerKind=e4={})).Invoked=1,g.Automatic=2,(y=e5||(t.CodeActionContext=e5={})).create=function(e,t,n){var r={diagnostics:e};return null!=t&&(r.only=t),null!=n&&(r.triggerKind=n),r},y.is=function(e){return tw.defined(e)&&tw.typedArray(e.diagnostics,eE.is)&&(void 0===e.only||tw.typedArray(e.only,tw.string))&&(void 0===e.triggerKind||e.triggerKind===e4.Invoked||e.triggerKind===e4.Automatic)},(b=e6||(t.CodeAction=e6={})).create=function(e,t,n){var r={title:e},a=!0;return"string"==typeof t?(a=!1,r.kind=t):eT.is(t)?r.command=t:r.edit=t,a&&void 0!==n&&(r.kind=n),r},b.is=function(e){return e&&tw.string(e.title)&&(void 0===e.diagnostics||tw.typedArray(e.diagnostics,eE.is))&&(void 0===e.kind||tw.string(e.kind))&&(void 0!==e.edit||void 0!==e.command)&&(void 0===e.command||eT.is(e.command))&&(void 0===e.isPreferred||tw.boolean(e.isPreferred))&&(void 0===e.edit||eC.is(e.edit))},(v=e8||(t.CodeLens=e8={})).create=function(e,t){var n={range:e};return tw.defined(t)&&(n.data=t),n},v.is=function(e){return tw.defined(e)&&ec.is(e.range)&&(tw.undefined(e.command)||eT.is(e.command))},(w=e7||(t.FormattingOptions=e7={})).create=function(e,t){return{tabSize:e,insertSpaces:t}},w.is=function(e){return tw.defined(e)&&tw.uinteger(e.tabSize)&&tw.boolean(e.insertSpaces)},(_=te||(t.DocumentLink=te={})).create=function(e,t,n){return{range:e,target:t,data:n}},_.is=function(e){return tw.defined(e)&&ec.is(e.range)&&(tw.undefined(e.target)||tw.string(e.target))},(E=tt||(t.SelectionRange=tt={})).create=function(e,t){return{range:e,parent:t}},E.is=function(e){return tw.objectLiteral(e)&&ec.is(e.range)&&(void 0===e.parent||E.is(e.parent))},(T=tn||(t.SemanticTokenTypes=tn={})).namespace="namespace",T.type="type",T.class="class",T.enum="enum",T.interface="interface",T.struct="struct",T.typeParameter="typeParameter",T.parameter="parameter",T.variable="variable",T.property="property",T.enumMember="enumMember",T.event="event",T.function="function",T.method="method",T.macro="macro",T.keyword="keyword",T.modifier="modifier",T.comment="comment",T.string="string",T.number="number",T.regexp="regexp",T.operator="operator",T.decorator="decorator",(A=tr||(t.SemanticTokenModifiers=tr={})).declaration="declaration",A.definition="definition",A.readonly="readonly",A.static="static",A.deprecated="deprecated",A.abstract="abstract",A.async="async",A.modification="modification",A.documentation="documentation",A.defaultLibrary="defaultLibrary",(ta||(t.SemanticTokens=ta={})).is=function(e){return tw.objectLiteral(e)&&(void 0===e.resultId||"string"==typeof e.resultId)&&Array.isArray(e.data)&&(0===e.data.length||"number"==typeof e.data[0])},(I=ti||(t.InlineValueText=ti={})).create=function(e,t){return{range:e,text:t}},I.is=function(e){return null!=e&&ec.is(e.range)&&tw.string(e.text)},(x=ts||(t.InlineValueVariableLookup=ts={})).create=function(e,t,n){return{range:e,variableName:t,caseSensitiveLookup:n}},x.is=function(e){return null!=e&&ec.is(e.range)&&tw.boolean(e.caseSensitiveLookup)&&(tw.string(e.variableName)||void 0===e.variableName)},(S=to||(t.InlineValueEvaluatableExpression=to={})).create=function(e,t){return{range:e,expression:t}},S.is=function(e){return null!=e&&ec.is(e.range)&&(tw.string(e.expression)||void 0===e.expression)},(N=tl||(t.InlineValueContext=tl={})).create=function(e,t){return{frameId:e,stoppedLocation:t}},N.is=function(e){return tw.defined(e)&&ec.is(e.stoppedLocation)},(k=tu||(t.InlayHintKind=tu={})).Type=1,k.Parameter=2,k.is=function(e){return 1===e||2===e},(R=tc||(t.InlayHintLabelPart=tc={})).create=function(e){return{value:e}},R.is=function(e){return tw.objectLiteral(e)&&(void 0===e.tooltip||tw.string(e.tooltip)||eV.is(e.tooltip))&&(void 0===e.location||ed.is(e.location))&&(void 0===e.command||eT.is(e.command))},(O=td||(t.InlayHint=td={})).create=function(e,t,n){var r={position:e,label:t};return void 0!==n&&(r.kind=n),r},O.is=function(e){return tw.objectLiteral(e)&&eu.is(e.position)&&(tw.string(e.label)||tw.typedArray(e.label,tc.is))&&(void 0===e.kind||tu.is(e.kind))&&void 0===e.textEdits||tw.typedArray(e.textEdits,eA.is)&&(void 0===e.tooltip||tw.string(e.tooltip)||eV.is(e.tooltip))&&(void 0===e.paddingLeft||tw.boolean(e.paddingLeft))&&(void 0===e.paddingRight||tw.boolean(e.paddingRight))},(tp||(t.StringValue=tp={})).createSnippet=function(e){return{kind:"snippet",value:e}},(tm||(t.InlineCompletionItem=tm={})).create=function(e,t,n,r){return{insertText:e,filterText:t,range:n,command:r}},(th||(t.InlineCompletionList=th={})).create=function(e){return{items:e}},(C=tf||(t.InlineCompletionTriggerKind=tf={})).Invoked=0,C.Automatic=1,(tg||(t.SelectedCompletionInfo=tg={})).create=function(e,t){return{range:e,text:t}},(ty||(t.InlineCompletionContext=ty={})).create=function(e,t){return{triggerKind:e,selectedCompletionInfo:t}},(tb||(t.WorkspaceFolder=tb={})).is=function(e){return tw.objectLiteral(e)&&es.is(e.uri)&&tw.string(e.name)},t.EOL=["\n","\r\n","\r"],(P=tv||(t.TextDocument=tv={})).create=function(e,t,n,r){return new tA(e,t,n,r)},P.is=function(e){return!!(tw.defined(e)&&tw.string(e.uri)&&(tw.undefined(e.languageId)||tw.string(e.languageId))&&tw.uinteger(e.lineCount)&&tw.func(e.getText)&&tw.func(e.positionAt)&&tw.func(e.offsetAt))},P.applyEdits=function(e,t){for(var n=e.getText(),r=function e(t,n){if(t.length<=1)return t;var r=t.length/2|0,a=t.slice(0,r),i=t.slice(r);e(a,n),e(i,n);for(var s=0,o=0,l=0;s<a.length&&o<i.length;)0>=n(a[s],i[o])?t[l++]=a[s++]:t[l++]=i[o++];for(;s<a.length;)t[l++]=a[s++];for(;o<i.length;)t[l++]=i[o++];return t}(t,function(e,t){var n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n}),a=n.length,i=r.length-1;i>=0;i--){var s=r[i],o=e.offsetAt(s.range.start),l=e.offsetAt(s.range.end);if(l<=a)n=n.substring(0,o)+s.newText+n.substring(l,n.length);else throw Error("Overlapping edit");a=o}return n};var tA=function(){function e(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,n=!0,r=0;r<t.length;r++){n&&(e.push(r),n=!1);var a=t.charAt(r);n="\r"===a||"\n"===a,"\r"===a&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return eu.create(0,e);for(;n<r;){var a=Math.floor((n+r)/2);t[a]>e?r=a:n=a+1}var i=n-1;return eu.create(i,e-t[i])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),e}();D=tw||(tw={}),M=Object.prototype.toString,D.defined=function(e){return void 0!==e},D.undefined=function(e){return void 0===e},D.boolean=function(e){return!0===e||!1===e},D.string=function(e){return"[object String]"===M.call(e)},D.number=function(e){return"[object Number]"===M.call(e)},D.numberRange=function(e,t,n){return"[object Number]"===M.call(e)&&t<=e&&e<=n},D.integer=function(e){return"[object Number]"===M.call(e)&&-2147483648<=e&&e<=2147483647},D.uinteger=function(e){return"[object Number]"===M.call(e)&&0<=e&&e<=2147483647},D.func=function(e){return"[object Function]"===M.call(e)},D.objectLiteral=function(e){return null!==e&&"object"==typeof e},D.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}})},7665:(e,t,n)=>{"use strict";var r;n.r(t),n.d(t,{TextDocument:()=>r});class a{constructor(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}update(e,t){for(let t of e)if(a.isIncremental(t)){let e=o(t.range),n=this.offsetAt(e.start),r=this.offsetAt(e.end);this._content=this._content.substring(0,n)+t.text+this._content.substring(r,this._content.length);let a=Math.max(e.start.line,0),s=Math.max(e.end.line,0),l=this._lineOffsets,u=i(t.text,!1,n);if(s-a===u.length)for(let e=0,t=u.length;e<t;e++)l[e+a+1]=u[e];else u.length<1e4?l.splice(a+1,s-a,...u):this._lineOffsets=l=l.slice(0,a+1).concat(u,l.slice(s+1));let c=t.text.length-(r-n);if(0!==c)for(let e=a+1+u.length,t=l.length;e<t;e++)l[e]=l[e]+c}else if(a.isFull(t))this._content=t.text,this._lineOffsets=void 0;else throw Error("Unknown change event received");this._version=t}getLineOffsets(){return void 0===this._lineOffsets&&(this._lineOffsets=i(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return{line:0,character:e};for(;n<r;){let a=Math.floor((n+r)/2);t[a]>e?r=a:n=a+1}let a=n-1;return e=this.ensureBeforeEOL(e,t[a]),{line:a,character:e-t[a]}}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let n=t[e.line];if(e.character<=0)return n;let r=e.line+1<t.length?t[e.line+1]:this._content.length,a=Math.min(n+e.character,r);return this.ensureBeforeEOL(a,n)}ensureBeforeEOL(e,t){for(;e>t&&s(this._content.charCodeAt(e-1));)e--;return e}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){return null!=e&&"string"==typeof e.text&&void 0!==e.range&&(void 0===e.rangeLength||"number"==typeof e.rangeLength)}static isFull(e){return null!=e&&"string"==typeof e.text&&void 0===e.range&&void 0===e.rangeLength}}function i(e,t,n=0){let r=t?[n]:[];for(let t=0;t<e.length;t++){let a=e.charCodeAt(t);s(a)&&(13===a&&t+1<e.length&&10===e.charCodeAt(t+1)&&t++,r.push(n+t+1))}return r}function s(e){return 13===e||10===e}function o(e){let t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function l(e){let t=o(e.range);return t!==e.range?{newText:e.newText,range:t}:e}!function(e){e.create=function(e,t,n,r){return new a(e,t,n,r)},e.update=function(e,t,n){if(e instanceof a)return e.update(t,n),e;throw Error("TextDocument.update: document must be created by TextDocument.create")},e.applyEdits=function(e,t){let n=e.getText(),r=function e(t,n){if(t.length<=1)return t;let r=t.length/2|0,a=t.slice(0,r),i=t.slice(r);e(a,n),e(i,n);let s=0,o=0,l=0;for(;s<a.length&&o<i.length;)0>=n(a[s],i[o])?t[l++]=a[s++]:t[l++]=i[o++];for(;s<a.length;)t[l++]=a[s++];for(;o<i.length;)t[l++]=i[o++];return t}(t.map(l),(e,t)=>{let n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n}),a=0,i=[];for(let t of r){let r=e.offsetAt(t.range.start);if(r<a)throw Error("Overlapping edit");r>a&&i.push(n.substring(a,r)),t.newText.length&&i.push(t.newText),a=e.offsetAt(t.range.end)}return i.push(n.substr(a)),i.join("")}}(r||(r={}))}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[379],()=>n(6035));module.exports=r})();